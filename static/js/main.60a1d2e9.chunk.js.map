{"version":3,"sources":["vendor/Blob.js","vendor/canvas-toBlob.js","components/ThemeProvider/theme.js","utils/memorize.js","components/ThemeProvider/global-styles.js","components/ThemeProvider/index.js","utils/hookWithLocalStorage.js","components/utils/injectProps.js","components/utils/isToAs.js","components/Box.js","components/utils/asForward.js","components/Flex.js","components/Text.js","components/Input.js","contexts/msal/context.js","contexts/msal/Provider.js","components/Container.js","components/utils/getColor.js","components/Button.js","components/Dropdown.js","components/Pagination.js","containers/SheetDataTable.js","components/BackgroundImage.js","utils/dom2canvas.js","components/Circle.js","containers/RenderTable/helpers.js","containers/RenderTable/timeline.js","containers/RenderTable/index.js","containers/HomePage.js","contexts/msal/useMsal.js","App.js","index.js"],"names":["global","window","self","this","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","URL","webkitURL","href","a","document","createElement","origBlob","Blob","createObjectURL","revokeObjectURL","strTag","Symbol","toStringTag","blobSupported","blobSupportsArrayBufferView","arrayBufferSupported","ArrayBuffer","blobBuilderSupported","prototype","append","getBlob","size","Uint8Array","e","mapArrayBufferViews","ary","map","chunk","buffer","buf","byteLength","copy","set","byteOffset","BlobBuilderConstructor","options","bb","forEach","part","type","BlobConstructor","textEncode","TextEncoder","encode","bind","string","pos","len","length","Arr","Array","at","tlen","Math","max","target","value","charCodeAt","extra","update","slice","textDecode","TextDecoder","decode","end","res","i","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","push","str","String","fromCharCode","apply","fixFileAndXHR","isIE","ActiveXObject","documentElement","style","_send","XMLHttpRequest","send","data","setRequestHeader","call","File","klass","Function","b","d","c","blob","t","lastModified","Date","name","replace","lastModifiedDate","toString","bufferClone","view","array","array2base64","input","byteToCharMap","output","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","join","create","Object","viewClasses","isArrayBufferView","isView","obj","indexOf","chunks","opts","_buffer","isPrototypeOf","DataView","offset","l","concatTypedarrays","concat","test","toLowerCase","arrayBuffer","Promise","resolve","text","start","constructor","setPrototypeOf","__proto__","FileReader","TypeError","delegate","createDocumentFragment","addEventListener","dispatchEvent","evt","local","removeEventListener","_read","fr","kind","result","setTimeout","readyState","LOADING","Event","EMPTY","DONE","error","onabort","onerror","onload","onloadend","onloadstart","onprogress","readAsDataURL","readAsText","readAsArrayBuffer","abort","url","FakeBlobBuilder","stream","promisify","reject","Error","ReadableStream","position","autoAllocateChunkSize","pull","controller","v","byobRequest","then","uint8array","bytesRead","respond","close","enqueue","Response","body","getReader","read","base64_ranks","HTMLCanvasElement","canvas_proto","is_base64_regex","to_data_url","decode_base64","base64","rank","code","outptr","last","state","save","undef","toBlob","toBlobHD","callback","mozGetAsFile","msToBlob","args","arguments","dataURI","header_end","substring","is_base64","fake","encoding","decodeURIComponent","toDataURLHD","content","emToPx","em","breakpoints","containerWidth","responsiveIndex","responsiveMap","_","id","findIndex","responsive","fun","cache","key","JSON","stringify","hit","parse","memorize","argsLen","get","colors","white","black","primary","gray","red","blue","darkGray","orange","cyan","steelBlue","pink","powderBlue","lightSeaGreen","availColors","font","fontSize","zOrder","range","createGlobalStyle","theme","children","initialVal","devOnly","hook","useLocalStorage","item","setItem","val","setVal","useEffect","injectProps","merge","prop","cssProperty","getConfig","SubComp","forwardRef","ref","is","props","console","as","Box","isToAs","styled","div","withConfig","shouldForwardProp","space","layout","typography","color","zIndex","border","flex","borderRadius","opacity","onClick","displayName","Inline","display","verticalAlign","Absolute","FullAbsolute","top","left","right","bottom","Relative","forwardedAs","Flex","flexbox","defaultProps","asForward","Text","p","Bold","fontWeight","Thin","TextInput","themeGet","textAlign","Input","label","labelWidth","placeholder","disabled","onChange","onBlur","onKeyUp","min","step","alignItems","mr","w","align","mt","createContext","msalConfig","auth","clientId","authority","redirectUri","cacheLocation","storeAuthStateInCookie","graphConfig","sheetName","loginRequest","scopes","myMSALObj","Msal","callMSGraph","endpoint","token","headers","Headers","bearer","method","log","fetch","response","json","catch","getTokenPopup","request","acquireTokenSilent","acquireTokenPopup","tokenResponse","Provider","useState","getAccount","account","setAccount","loading","setLoading","hookWithLocalStorage","workbookUrl","setWorkbookUrl","sheets","setSheets","useImmer","sheetData","setSheetData","workbookId","useMemo","URLSearchParams","search","signIn","useCallback","loginPopup","loginResponse","signOut","logout","loadSheets","accessToken","loadSheetData","draft","WorkBookIdInput","keyCode","context","Container","mx","px","width","maxWidth","customColor","active","css","ButtonBase","button","InButtonSpan","Button","leftIcon","rightIcon","iconSpacing","iconsSize","ml","borderColor","bg","hoverColor","hoverBg","hoverBorder","py","Danger","Secondary","Outline","Transparent","SingleSelect","formattedOptions","opt","defaultValue","isClearable","isDisabled","Wrapper","Pagination","pageCount","pageRangeDisplayed","marginPagesDisplayed","onPageChange","initialPage","forcePage","disableInitialCallback","ReactPaginate","containerClassName","StyledTable","table","StyledInput","IndeterminateCheckbox","indeterminate","rest","defaultRef","useRef","resolvedRef","current","defaultColumn","Filter","column","filterValue","preFilteredRows","setFilter","count","undefined","canFilter","SheetDataTable","headerRow","onSelectRow","columns","Header","isObject","assign","accessor","tableInstance","useTable","initialState","selectedRowIds","reduce","sels","r","useFilters","useRowSelect","hooks","visibleColumns","getToggleAllRowsSelectedProps","Cell","row","getToggleRowSelectedProps","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","overflowX","headerGroup","getHeaderGroupProps","getHeaderProps","render","getRowProps","cells","cell","getCellProps","BackgroundImage","background","src","height","ratio","propTypes","PropTypes","backgroundSize","backgroundPosition","PIXEL_RATIO","ctx","getContext","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","Dom2Canvas","dom","h","init","clientWidth","clientHeight","canvas","can","setTransform","setHiDPICanvas","_addNamespace","injectedStyle","outerHTML","setAttribute","toCanvas","cb","moreSVG","all","loadSVG","svg","encodeURIComponent","image","Image","drawImage","Circle","pt","transform","lineHeight","alldPttn","nmPttn","yearPttn","toYearFormat","y","q","checkPttn","crossPttn","noPttn","iconStyle","margin","parseCell","my","parenthesisPttn","xmlns","Timeline","bounds","n","addGuide","x","thick","line","createElementNS","setAttributeNS","appendChild","add","fill","timeline","addLabel","idText","inPranthesis","exec","textContent","smallText","getSVG","secWidth","middle","clearChildren","innerHTML","CanvasContainer","headerBar","TableStyle","rotateStyle","writingMode","textOrientation","DecoLine","borderGap","startYear","getFullYear","timelinePttn","timelineStartPttn","timelineEndPttn","ddrPattn","yearsHeader","colorGen","RenderTable","allData","updatedMark","page","gen","shuffle","k","tableRef","container","techIndex","col","groupStart","parsedData","colorIndex","rowCount","mapped","parseYear","timelineContainerRef","timelineStartRef","timelineEndRef","timlineRefs","createRef","notes","note","orginizedHeader","placeHolders","header","j","placeholderOf","rowSpan","colSpan","totalVisibleHeaderCount","useOrginizedHeader","headerChildrenIndex","ci","groups","hid","originalId","ids","useHeaderChildrenIndex","orginizedRows","allRows","thisRow","updated","parentIndex","findLastIndex","useOriginizedRows","handleDownload","querySelector","saveAs","sanitize","containerBox","getBoundingClientRect","timelineStartBox","timelineEndBox","timelineBounds","round","labelPos","tl","refs","startRect","endRect","node","XMLSerializer","serializeToString","xml","overflow","className","hgLength","isYear","backgroundImage","whiteSpace","depth","parent","isFirst","isLast","composeRefs","added","borderWidth","borderStyle","fontFamily","HomePage","useContext","AuthButton","useMsal","selectedSheet","setSheet","compareSheet","setCompareSheet","selectedRow","setSelectedRow","setPage","compareSheetData","doubleHeader","some","colLength","groupMemo","reverse","tableData","starts","pages","pageStart","sel","compareData","indexedData","renderValues","entries","filter","Boolean","compareMark","toCompare","Dropdown","selected","sheet","App","ReactDOM","ThemeProvider","getElementById"],"mappings":"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","file":"static/js/main.60a1d2e9.chunk.js","sourcesContent":["/* eslint-disable */\r\n/* Blob.js\r\n * A Blob, File, FileReader & URL implementation.\r\n * 2019-04-19\r\n *\r\n * By Eli Grey, http://eligrey.com\r\n * By Jimmy Wärting, https://github.com/jimmywarting\r\n * License: MIT\r\n *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md\r\n */\r\n\r\n;(function () {\r\n  var global = typeof window === 'object'\r\n      ? window : typeof self === 'object'\r\n      ? self : this\r\n\r\n  var BlobBuilder = global.BlobBuilder\r\n    || global.WebKitBlobBuilder\r\n    || global.MSBlobBuilder\r\n    || global.MozBlobBuilder\r\n\r\n  global.URL = global.URL || global.webkitURL || function (href, a) {\r\n  \ta = document.createElement('a')\r\n  \ta.href = href\r\n  \treturn a\r\n  }\r\n\r\n  var origBlob = global.Blob\r\n  var createObjectURL = URL.createObjectURL\r\n  var revokeObjectURL = URL.revokeObjectURL\r\n  var strTag = global.Symbol && global.Symbol.toStringTag\r\n  var blobSupported = false\r\n  var blobSupportsArrayBufferView = false\r\n  var arrayBufferSupported = !!global.ArrayBuffer\r\n  var blobBuilderSupported = BlobBuilder\r\n    && BlobBuilder.prototype.append\r\n    && BlobBuilder.prototype.getBlob\r\n\r\n  try {\r\n    // Check if Blob constructor is supported\r\n    blobSupported = new Blob(['ä']).size === 2\r\n\r\n    // Check if Blob constructor supports ArrayBufferViews\r\n    // Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n    blobSupportsArrayBufferView = new Blob([new Uint8Array([1, 2])]).size === 2\r\n  } catch (e) {}\r\n\r\n  /**\r\n   * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n   * Used by BlobBuilder constructor and old browsers that didn't\r\n   * support it in the Blob constructor.\r\n   */\r\n  function mapArrayBufferViews (ary) {\r\n    return ary.map(function (chunk) {\r\n      if (chunk.buffer instanceof ArrayBuffer) {\r\n        var buf = chunk.buffer\r\n\r\n        // if this is a subarray, make a copy so we only\r\n        // include the subarray region from the underlying buffer\r\n        if (chunk.byteLength !== buf.byteLength) {\r\n          var copy = new Uint8Array(chunk.byteLength)\r\n          copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength))\r\n          buf = copy.buffer\r\n        }\r\n\r\n        return buf\r\n      }\r\n\r\n      return chunk\r\n    })\r\n  }\r\n\r\n  function BlobBuilderConstructor (ary, options) {\r\n    options = options || {}\r\n\r\n    var bb = new BlobBuilder()\r\n    mapArrayBufferViews(ary).forEach(function (part) {\r\n      bb.append(part)\r\n    })\r\n\r\n    return options.type ? bb.getBlob(options.type) : bb.getBlob()\r\n  }\r\n\r\n  function BlobConstructor (ary, options) {\r\n    return new origBlob(mapArrayBufferViews(ary), options || {})\r\n  }\r\n\r\n  if (global.Blob) {\r\n    BlobBuilderConstructor.prototype = Blob.prototype\r\n    BlobConstructor.prototype = Blob.prototype\r\n  }\r\n\r\n\r\n\r\n  /********************************************************/\r\n  /*               String Encoder fallback                */\r\n  /********************************************************/\r\n  function stringEncode (string) {\r\n    var pos = 0\r\n    var len = string.length\r\n    var Arr = global.Uint8Array || Array // Use byte array when possible\r\n\r\n    var at = 0  // output position\r\n    var tlen = Math.max(32, len + (len >> 1) + 7)  // 1.5x size\r\n    var target = new Arr((tlen >> 3) << 3)  // ... but at 8 byte offset\r\n\r\n    while (pos < len) {\r\n      var value = string.charCodeAt(pos++)\r\n      if (value >= 0xd800 && value <= 0xdbff) {\r\n        // high surrogate\r\n        if (pos < len) {\r\n          var extra = string.charCodeAt(pos)\r\n          if ((extra & 0xfc00) === 0xdc00) {\r\n            ++pos\r\n            value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000\r\n          }\r\n        }\r\n        if (value >= 0xd800 && value <= 0xdbff) {\r\n          continue  // drop lone surrogate\r\n        }\r\n      }\r\n\r\n      // expand the buffer if we couldn't write 4 bytes\r\n      if (at + 4 > target.length) {\r\n        tlen += 8  // minimum extra\r\n        tlen *= (1.0 + (pos / string.length) * 2)  // take 2x the remaining\r\n        tlen = (tlen >> 3) << 3  // 8 byte offset\r\n\r\n        var update = new Uint8Array(tlen)\r\n        update.set(target)\r\n        target = update\r\n      }\r\n\r\n      if ((value & 0xffffff80) === 0) {  // 1-byte\r\n        target[at++] = value  // ASCII\r\n        continue\r\n      } else if ((value & 0xfffff800) === 0) {  // 2-byte\r\n        target[at++] = ((value >> 6) & 0x1f) | 0xc0\r\n      } else if ((value & 0xffff0000) === 0) {  // 3-byte\r\n        target[at++] = ((value >> 12) & 0x0f) | 0xe0\r\n        target[at++] = ((value >> 6) & 0x3f) | 0x80\r\n      } else if ((value & 0xffe00000) === 0) {  // 4-byte\r\n        target[at++] = ((value >> 18) & 0x07) | 0xf0\r\n        target[at++] = ((value >> 12) & 0x3f) | 0x80\r\n        target[at++] = ((value >> 6) & 0x3f) | 0x80\r\n      } else {\r\n        // FIXME: do we care\r\n        continue\r\n      }\r\n\r\n      target[at++] = (value & 0x3f) | 0x80\r\n    }\r\n\r\n    return target.slice(0, at)\r\n  }\r\n\r\n  /********************************************************/\r\n  /*               String Decoder fallback                */\r\n  /********************************************************/\r\n  function stringDecode (buf) {\r\n    var end = buf.length\r\n    var res = []\r\n\r\n    var i = 0\r\n    while (i < end) {\r\n      var firstByte = buf[i]\r\n      var codePoint = null\r\n      var bytesPerSequence = (firstByte > 0xEF) ? 4\r\n        : (firstByte > 0xDF) ? 3\r\n          : (firstByte > 0xBF) ? 2\r\n            : 1\r\n\r\n      if (i + bytesPerSequence <= end) {\r\n        var secondByte, thirdByte, fourthByte, tempCodePoint\r\n\r\n        switch (bytesPerSequence) {\r\n          case 1:\r\n            if (firstByte < 0x80) {\r\n              codePoint = firstByte\r\n            }\r\n            break\r\n          case 2:\r\n            secondByte = buf[i + 1]\r\n            if ((secondByte & 0xC0) === 0x80) {\r\n              tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\r\n              if (tempCodePoint > 0x7F) {\r\n                codePoint = tempCodePoint\r\n              }\r\n            }\r\n            break\r\n          case 3:\r\n            secondByte = buf[i + 1]\r\n            thirdByte = buf[i + 2]\r\n            if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\r\n              tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\r\n              if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\r\n                codePoint = tempCodePoint\r\n              }\r\n            }\r\n            break\r\n          case 4:\r\n            secondByte = buf[i + 1]\r\n            thirdByte = buf[i + 2]\r\n            fourthByte = buf[i + 3]\r\n            if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\r\n              tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\r\n              if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\r\n                codePoint = tempCodePoint\r\n              }\r\n            }\r\n        }\r\n      }\r\n\r\n      if (codePoint === null) {\r\n        // we did not generate a valid codePoint so insert a\r\n        // replacement char (U+FFFD) and advance only 1 byte\r\n        codePoint = 0xFFFD\r\n        bytesPerSequence = 1\r\n      } else if (codePoint > 0xFFFF) {\r\n        // encode to utf16 (surrogate pair dance)\r\n        codePoint -= 0x10000\r\n        res.push(codePoint >>> 10 & 0x3FF | 0xD800)\r\n        codePoint = 0xDC00 | codePoint & 0x3FF\r\n      }\r\n\r\n      res.push(codePoint)\r\n      i += bytesPerSequence\r\n    }\r\n\r\n    var len = res.length\r\n    var str = ''\r\n    var i = 0\r\n\r\n    while (i < len) {\r\n      str += String.fromCharCode.apply(String, res.slice(i, i += 0x1000))\r\n    }\r\n\r\n    return str\r\n  }\r\n\r\n  // string -> buffer\r\n  var textEncode = typeof TextEncoder === 'function'\r\n    ? TextEncoder.prototype.encode.bind(new TextEncoder())\r\n    : stringEncode\r\n\r\n  // buffer -> string\r\n  var textDecode = typeof TextDecoder === 'function'\r\n    ? TextDecoder.prototype.decode.bind(new TextDecoder())\r\n    : stringDecode\r\n\r\n  function FakeBlobBuilder () {\r\n    function isDataView (obj) {\r\n      return obj && DataView.prototype.isPrototypeOf(obj)\r\n    }\r\n    function bufferClone (buf) {\r\n      var view = new Array(buf.byteLength)\r\n      var array = new Uint8Array(buf)\r\n      var i = view.length\r\n      while (i--) {\r\n        view[i] = array[i]\r\n      }\r\n      return view\r\n    }\r\n    function array2base64 (input) {\r\n      var byteToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\r\n\r\n      var output = []\r\n\r\n      for (var i = 0; i < input.length; i += 3) {\r\n        var byte1 = input[i]\r\n        var haveByte2 = i + 1 < input.length\r\n        var byte2 = haveByte2 ? input[i + 1] : 0\r\n        var haveByte3 = i + 2 < input.length\r\n        var byte3 = haveByte3 ? input[i + 2] : 0\r\n\r\n        var outByte1 = byte1 >> 2\r\n        var outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4)\r\n        var outByte3 = ((byte2 & 0x0F) << 2) | (byte3 >> 6)\r\n        var outByte4 = byte3 & 0x3F\r\n\r\n        if (!haveByte3) {\r\n          outByte4 = 64\r\n\r\n          if (!haveByte2) {\r\n            outByte3 = 64\r\n          }\r\n        }\r\n\r\n        output.push(\r\n          byteToCharMap[outByte1], byteToCharMap[outByte2],\r\n          byteToCharMap[outByte3], byteToCharMap[outByte4]\r\n        )\r\n      }\r\n\r\n      return output.join('')\r\n    }\r\n\r\n    var create = Object.create || function (a) {\r\n      function c () {}\r\n      c.prototype = a\r\n      return new c()\r\n    }\r\n\r\n    if (arrayBufferSupported) {\r\n      var viewClasses = [\r\n        '[object Int8Array]',\r\n        '[object Uint8Array]',\r\n        '[object Uint8ClampedArray]',\r\n        '[object Int16Array]',\r\n        '[object Uint16Array]',\r\n        '[object Int32Array]',\r\n        '[object Uint32Array]',\r\n        '[object Float32Array]',\r\n        '[object Float64Array]'\r\n      ]\r\n\r\n      var isArrayBufferView = ArrayBuffer.isView || function (obj) {\r\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\r\n      }\r\n    }\r\n\r\n    function concatTypedarrays (chunks) {\r\n      var size = 0\r\n      var i = chunks.length\r\n      while (i--) { size += chunks[i].length }\r\n      var b = new Uint8Array(size)\r\n      var offset = 0\r\n      for (i = 0, l = chunks.length; i < l; i++) {\r\n        var chunk = chunks[i]\r\n        b.set(chunk, offset)\r\n        offset += chunk.byteLength || chunk.length\r\n      }\r\n\r\n      return b\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                   Blob constructor                   */\r\n    /********************************************************/\r\n    function Blob (chunks, opts) {\r\n      chunks = chunks || []\r\n      opts = opts == null ? {} : opts\r\n      for (var i = 0, len = chunks.length; i < len; i++) {\r\n        var chunk = chunks[i]\r\n        if (chunk instanceof Blob) {\r\n          chunks[i] = chunk._buffer\r\n        } else if (typeof chunk === 'string') {\r\n          chunks[i] = textEncode(chunk)\r\n        } else if (arrayBufferSupported && (ArrayBuffer.prototype.isPrototypeOf(chunk) || isArrayBufferView(chunk))) {\r\n          chunks[i] = bufferClone(chunk)\r\n        } else if (arrayBufferSupported && isDataView(chunk)) {\r\n          chunks[i] = bufferClone(chunk.buffer)\r\n        } else {\r\n          chunks[i] = textEncode(String(chunk))\r\n        }\r\n      }\r\n\r\n      this._buffer = global.Uint8Array\r\n        ? concatTypedarrays(chunks)\r\n        : [].concat.apply([], chunks)\r\n      this.size = this._buffer.length\r\n\r\n      this.type = opts.type || ''\r\n      if (/[^\\u0020-\\u007E]/.test(this.type)) {\r\n        this.type = ''\r\n      } else {\r\n        this.type = this.type.toLowerCase()\r\n      }\r\n    }\r\n\r\n    Blob.prototype.arrayBuffer = function () {\r\n      return Promise.resolve(this._buffer)\r\n    }\r\n\r\n    Blob.prototype.text = function () {\r\n      return Promise.resolve(textDecode(this._buffer))\r\n    }\r\n\r\n    Blob.prototype.slice = function (start, end, type) {\r\n      var slice = this._buffer.slice(start || 0, end || this._buffer.length)\r\n      return new Blob([slice], {type: type})\r\n    }\r\n\r\n    Blob.prototype.toString = function () {\r\n      return '[object Blob]'\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                   File constructor                   */\r\n    /********************************************************/\r\n    function File (chunks, name, opts) {\r\n      opts = opts || {}\r\n      var a = Blob.call(this, chunks, opts) || this\r\n      a.name = name.replace(/\\//g, ':')\r\n      a.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date()\r\n      a.lastModified = +a.lastModifiedDate\r\n\r\n      return a\r\n    }\r\n\r\n    File.prototype = create(Blob.prototype)\r\n    File.prototype.constructor = File\r\n\r\n    if (Object.setPrototypeOf) {\r\n      Object.setPrototypeOf(File, Blob)\r\n    } else {\r\n      try { File.__proto__ = Blob } catch (e) {}\r\n    }\r\n\r\n    File.prototype.toString = function () {\r\n      return '[object File]'\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                FileReader constructor                */\r\n    /********************************************************/\r\n    function FileReader () {\r\n    \tif (!(this instanceof FileReader)) {\r\n        throw new TypeError(\"Failed to construct 'FileReader': Please use the 'new' operator, this DOM object constructor cannot be called as a function.\")\r\n      }\r\n\r\n    \tvar delegate = document.createDocumentFragment()\r\n    \tthis.addEventListener = delegate.addEventListener\r\n    \tthis.dispatchEvent = function (evt) {\r\n    \t\tvar local = this['on' + evt.type]\r\n    \t\tif (typeof local === 'function') local(evt)\r\n    \t\tdelegate.dispatchEvent(evt)\r\n    \t}\r\n    \tthis.removeEventListener = delegate.removeEventListener\r\n    }\r\n\r\n    function _read (fr, blob, kind) {\r\n    \tif (!(blob instanceof Blob)) {\r\n        throw new TypeError(\"Failed to execute '\" + kind + \"' on 'FileReader': parameter 1 is not of type 'Blob'.\")\r\n      }\r\n\r\n    \tfr.result = ''\r\n\r\n    \tsetTimeout(function () {\r\n    \t\tthis.readyState = FileReader.LOADING\r\n    \t\tfr.dispatchEvent(new Event('load'))\r\n    \t\tfr.dispatchEvent(new Event('loadend'))\r\n    \t})\r\n    }\r\n\r\n    FileReader.EMPTY = 0\r\n    FileReader.LOADING = 1\r\n    FileReader.DONE = 2\r\n    FileReader.prototype.error = null\r\n    FileReader.prototype.onabort = null\r\n    FileReader.prototype.onerror = null\r\n    FileReader.prototype.onload = null\r\n    FileReader.prototype.onloadend = null\r\n    FileReader.prototype.onloadstart = null\r\n    FileReader.prototype.onprogress = null\r\n\r\n    FileReader.prototype.readAsDataURL = function (blob) {\r\n    \t_read(this, blob, 'readAsDataURL')\r\n    \tthis.result = 'data:' + blob.type + ';base64,' + array2base64(blob._buffer)\r\n    }\r\n\r\n    FileReader.prototype.readAsText = function (blob) {\r\n    \t_read(this, blob, 'readAsText')\r\n    \tthis.result = textDecode(blob._buffer)\r\n    }\r\n\r\n    FileReader.prototype.readAsArrayBuffer = function (blob) {\r\n      _read(this, blob, 'readAsText')\r\n       // return ArrayBuffer when possible\r\n      this.result = (blob._buffer.buffer || blob._buffer).slice()\r\n    }\r\n\r\n    FileReader.prototype.abort = function () {}\r\n\r\n    /********************************************************/\r\n    /*                         URL                          */\r\n    /********************************************************/\r\n    URL.createObjectURL = function (blob) {\r\n      return blob instanceof Blob\r\n        ? 'data:' + blob.type + ';base64,' + array2base64(blob._buffer)\r\n        : createObjectURL.call(URL, blob)\r\n    }\r\n\r\n    URL.revokeObjectURL = function (url) {\r\n      revokeObjectURL && revokeObjectURL.call(URL, url)\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                         XHR                          */\r\n    /********************************************************/\r\n    var _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send\r\n    if (_send) {\r\n      XMLHttpRequest.prototype.send = function (data) {\r\n        if (data instanceof Blob) {\r\n          this.setRequestHeader('Content-Type', data.type)\r\n          _send.call(this, textDecode(data._buffer))\r\n        } else {\r\n          _send.call(this, data)\r\n        }\r\n      }\r\n    }\r\n\r\n    global.FileReader = FileReader\r\n    global.File = File\r\n    global.Blob = Blob\r\n  }\r\n\r\n  function fixFileAndXHR () {\r\n    var isIE = !!global.ActiveXObject || (\r\n      '-ms-scroll-limit' in document.documentElement.style &&\r\n      '-ms-ime-align' in document.documentElement.style\r\n    )\r\n\r\n    // Monkey patched\r\n    // IE don't set Content-Type header on XHR whose body is a typed Blob\r\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/6047383\r\n    var _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send\r\n    if (isIE && _send) {\r\n      XMLHttpRequest.prototype.send = function (data) {\r\n        if (data instanceof Blob) {\r\n          this.setRequestHeader('Content-Type', data.type)\r\n          _send.call(this, data)\r\n        } else {\r\n          _send.call(this, data)\r\n        }\r\n      }\r\n    }\r\n\r\n    try {\r\n      new File([], '')\r\n    } catch (e) {\r\n      try {\r\n        var klass = new Function('class File extends Blob {' +\r\n          'constructor(chunks, name, opts) {' +\r\n            'opts = opts || {};' +\r\n            'super(chunks, opts || {});' +\r\n            'this.name = name.replace(/\\//g, \":\");' +\r\n            'this.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();' +\r\n            'this.lastModified = +this.lastModifiedDate;' +\r\n          '}};' +\r\n          'return new File([], \"\"), File'\r\n        )()\r\n        global.File = klass\r\n      } catch (e) {\r\n        var klass = function (b, d, c) {\r\n          var blob = new Blob(b, c)\r\n          var t = c && void 0 !== c.lastModified ? new Date(c.lastModified) : new Date()\r\n\r\n          blob.name = d.replace(/\\//g, ':')\r\n          blob.lastModifiedDate = t\r\n          blob.lastModified = +t\r\n          blob.toString = function () {\r\n            return '[object File]'\r\n          }\r\n\r\n          if (strTag) {\r\n            blob[strTag] = 'File'\r\n          }\r\n\r\n          return blob\r\n        }\r\n        global.File = klass\r\n      }\r\n    }\r\n  }\r\n\r\n  if (blobSupported) {\r\n    fixFileAndXHR()\r\n    global.Blob = blobSupportsArrayBufferView ? global.Blob : BlobConstructor\r\n  } else if (blobBuilderSupported) {\r\n    fixFileAndXHR()\r\n    global.Blob = BlobBuilderConstructor\r\n  } else {\r\n    FakeBlobBuilder()\r\n  }\r\n\r\n  if (strTag) {\r\n    File.prototype[strTag] = 'File'\r\n    Blob.prototype[strTag] = 'Blob'\r\n    FileReader.prototype[strTag] = 'FileReader'\r\n  }\r\n\r\n  var blob = global.Blob.prototype\r\n  var stream\r\n\r\n  function promisify(obj) {\r\n    return new Promise(function(resolve, reject) {\r\n      obj.onload =\r\n      obj.onerror = function(evt) {\r\n        obj.onload =\r\n        obj.onerror = null\r\n\r\n        evt.type === 'load'\r\n          ? resolve(obj.result || obj)\r\n          : reject(new Error('Failed to read the blob/file'))\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  try {\r\n    new ReadableStream({ type: 'bytes' })\r\n    stream = function stream() {\r\n      var position = 0\r\n      var blob = this\r\n\r\n      return new ReadableStream({\r\n        type: 'bytes',\r\n        autoAllocateChunkSize: 524288,\r\n\r\n        pull: function (controller) {\r\n          var v = controller.byobRequest.view\r\n          var chunk = blob.slice(position, position + v.byteLength)\r\n          return chunk.arrayBuffer()\r\n          .then(function (buffer) {\r\n            var uint8array = new Uint8Array(buffer)\r\n            var bytesRead = uint8array.byteLength\r\n\r\n            position += bytesRead\r\n            v.set(uint8array)\r\n              controller.byobRequest.respond(bytesRead)\r\n\r\n            if(position >= blob.size)\r\n              controller.close()\r\n          })\r\n        }\r\n      })\r\n    }\r\n  } catch (e) {\r\n    try {\r\n      new ReadableStream({})\r\n      stream = function stream(blob){\r\n        var position = 0\r\n        var blob = this\r\n\r\n        return new ReadableStream({\r\n          pull: function (controller) {\r\n            var chunk = blob.slice(position, position + 524288)\r\n\r\n            return chunk.arrayBuffer().then(function (buffer) {\r\n              position += buffer.byteLength\r\n              var uint8array = new Uint8Array(buffer)\r\n              controller.enqueue(uint8array)\r\n\r\n              if (position == blob.size)\r\n                controller.close()\r\n            })\r\n          }\r\n        })\r\n      }\r\n    } catch (e) {\r\n      try {\r\n        new Response('').body.getReader().read()\r\n        stream = function stream() {\r\n          return (new Response(this)).body\r\n        }\r\n      } catch (e) {\r\n        stream = function stream() {\r\n          throw new Error('Include https://github.com/MattiasBuelens/web-streams-polyfill')\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  if (!blob.arrayBuffer) {\r\n    blob.arrayBuffer = function arrayBuffer() {\r\n      var fr = new FileReader()\r\n      fr.readAsArrayBuffer(this)\r\n      return promisify(fr)\r\n    }\r\n  }\r\n\r\n  if (!blob.text) {\r\n    blob.text = function text() {\r\n      var fr = new FileReader()\r\n      fr.readAsText(this)\r\n      return promisify(fr)\r\n    }\r\n  }\r\n\r\n  if (!blob.stream) {\r\n    blob.stream = stream\r\n  }\r\n})()\r\n","/* eslint-disable */\r\n/* canvas-toBlob.js\r\n * A canvas.toBlob() implementation.\r\n * 2016-05-26\r\n *\r\n * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr\r\n * License: MIT\r\n *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md\r\n */\r\n\r\n/*global self */\r\n/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\r\n  plusplus: true */\r\n\r\n/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */\r\n\r\n(function(view) {\r\n\"use strict\";\r\nvar\r\n\t  Uint8Array = view.Uint8Array\r\n\t, HTMLCanvasElement = view.HTMLCanvasElement\r\n\t, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype\r\n\t, is_base64_regex = /\\s*;\\s*base64\\s*(?:;|$)/i\r\n\t, to_data_url = \"toDataURL\"\r\n\t, base64_ranks\r\n\t, decode_base64 = function(base64) {\r\n\t\tvar\r\n\t\t\t  len = base64.length\r\n\t\t\t, buffer = new Uint8Array(len / 4 * 3 | 0)\r\n\t\t\t, i = 0\r\n\t\t\t, outptr = 0\r\n\t\t\t, last = [0, 0]\r\n\t\t\t, state = 0\r\n\t\t\t, save = 0\r\n\t\t\t, rank\r\n\t\t\t, code\r\n\t\t\t, undef\r\n\t\t;\r\n\t\twhile (len--) {\r\n\t\t\tcode = base64.charCodeAt(i++);\r\n\t\t\trank = base64_ranks[code-43];\r\n\t\t\tif (rank !== 255 && rank !== undef) {\r\n\t\t\t\tlast[1] = last[0];\r\n\t\t\t\tlast[0] = code;\r\n\t\t\t\tsave = (save << 6) | rank;\r\n\t\t\t\tstate++;\r\n\t\t\t\tif (state === 4) {\r\n\t\t\t\t\tbuffer[outptr++] = save >>> 16;\r\n\t\t\t\t\tif (last[1] !== 61 /* padding character */) {\r\n\t\t\t\t\t\tbuffer[outptr++] = save >>> 8;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (last[0] !== 61 /* padding character */) {\r\n\t\t\t\t\t\tbuffer[outptr++] = save;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 2/3 chance there's going to be some null bytes at the end, but that\r\n\t\t// doesn't really matter with most image formats.\r\n\t\t// If it somehow matters for you, truncate the buffer up outptr.\r\n\t\treturn buffer;\r\n\t}\r\n;\r\nif (Uint8Array) {\r\n\tbase64_ranks = new Uint8Array([\r\n\t\t  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1\r\n\t\t, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9\r\n\t\t, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25\r\n\t\t, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35\r\n\t\t, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51\r\n\t]);\r\n}\r\nif (HTMLCanvasElement && (!canvas_proto.toBlob || !canvas_proto.toBlobHD)) {\r\n\tif (!canvas_proto.toBlob)\r\n\tcanvas_proto.toBlob = function(callback, type /*, ...args*/) {\r\n\t\t  if (!type) {\r\n\t\t\ttype = \"image/png\";\r\n\t\t} if (this.mozGetAsFile) {\r\n\t\t\tcallback(this.mozGetAsFile(\"canvas\", type));\r\n\t\t\treturn;\r\n\t\t} if (this.msToBlob && /^\\s*image\\/png\\s*(?:$|;)/i.test(type)) {\r\n\t\t\tcallback(this.msToBlob());\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar\r\n\t\t\t  args = Array.prototype.slice.call(arguments, 1)\r\n\t\t\t, dataURI = this[to_data_url].apply(this, args)\r\n\t\t\t, header_end = dataURI.indexOf(\",\")\r\n\t\t\t, data = dataURI.substring(header_end + 1)\r\n\t\t\t, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))\r\n\t\t\t, blob\r\n\t\t;\r\n\t\tif (Blob.fake) {\r\n\t\t\t// no reason to decode a data: URI that's just going to become a data URI again\r\n\t\t\tblob = new Blob\r\n\t\t\tif (is_base64) {\r\n\t\t\t\tblob.encoding = \"base64\";\r\n\t\t\t} else {\r\n\t\t\t\tblob.encoding = \"URI\";\r\n\t\t\t}\r\n\t\t\tblob.data = data;\r\n\t\t\tblob.size = data.length;\r\n\t\t} else if (Uint8Array) {\r\n\t\t\tif (is_base64) {\r\n\t\t\t\tblob = new Blob([decode_base64(data)], {type: type});\r\n\t\t\t} else {\r\n\t\t\t\tblob = new Blob([decodeURIComponent(data)], {type: type});\r\n\t\t\t}\r\n\t\t}\r\n\t\tcallback(blob);\r\n\t};\r\n\r\n\tif (!canvas_proto.toBlobHD && canvas_proto.toDataURLHD) {\r\n\t\tcanvas_proto.toBlobHD = function() {\r\n\t\t\tto_data_url = \"toDataURLHD\";\r\n\t\t\tvar blob = this.toBlob();\r\n\t\t\tto_data_url = \"toDataURL\";\r\n\t\t\treturn blob;\r\n\t\t}\r\n\t} else {\r\n\t\tcanvas_proto.toBlobHD = canvas_proto.toBlob;\r\n\t}\r\n}\r\n}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this));\r\n","import range from 'lodash/range';\nimport get from 'lodash/get';\n\nimport memorize from '../../utils/memorize'\n\nconst baseFontSize = 16\nconst emToPx = (em) => `${em * baseFontSize}px`;\n\nexport const breakpoints = [22, 36, 48, 62, 90, 120].map(emToPx);\nexport const containerWidth = [22, 36, 46, 58, 86].map(emToPx);\nexport const responsiveIndex = [\n  [3, 'mobile'],\n  [4, 'tablet'],\n]\n\nconst responsiveMap = breakpoints.map((_, i) => {\n  const id = responsiveIndex.findIndex(([ri]) => ri > i)\n  return id >= 0 ? id : responsiveIndex.length\n})\n\nexport const responsive = memorize((...args) => {\n  const argsLen = args.length\n  if (argsLen <= 1) return args[0]\n  return breakpoints.map((_, i) => get(args, [responsiveMap[i]], null))\n});\n\nexport const mobileOrDesktop = responsive\n\nconst font = 'Verdana, Arial, \"PingFang TC\", \"HeiTi TC\", \"Microsoft JhengHei\", sans-serif';\n\nconst white = '#fff';\nconst black = '#000';\nconst red = '#D6262F'\nconst gray = '#F0F0F0'\nconst darkGray = '#595959'\nconst blue = '#0E4E6E'\nconst orange = '#F78D23'\nconst cyan = '#19D1C3'\nconst steelBlue = '#93B0C2'\nconst pink = '#FAC2C1'\nconst powderBlue = '#4DACC2'\nconst lightSeaGreen = '#A1C6CA'\nconst primary = blue\n\nexport default {\n  colors: {\n    white,\n    black,\n    text: black,\n    primary,\n    gray,\n    red,\n    blue,\n    darkGray,\n    orange,\n    cyan,\n    steelBlue,\n    pink,\n    powderBlue,\n    lightSeaGreen,\n  },\n  availColors: [\n    'cyan',\n    'steelBlue',\n    'pink',\n    'powderBlue',\n    'lightSeaGreen',\n  ],\n  breakpoints,\n  containerWidth,\n  font,\n  fontSize: `${baseFontSize}px`,\n  responsive,\n  zOrder: range(4).map((i) => 10 ** i),\n};\n","// memorization for performance; don't use this for mutable function\r\nexport default function(fun) {\r\n  const cache = {};\r\n\r\n  return function(...args){\r\n    const key = JSON.stringify(args);\r\n\r\n    // fetch\r\n    let hit = cache[key];\r\n    if (typeof hit !== 'undefined') {\r\n      return typeof hit === 'object' && hit !== null\r\n        ? JSON.parse(JSON.stringify(hit))\r\n        : hit\r\n    }\r\n\r\n    // put\r\n    let result = fun.apply(this, args);\r\n    cache[key] = result;\r\n    setTimeout(() => { delete cache[key]; }, 60 * 60 * 1000); // ttl is 1 hour\r\n\r\n    return typeof result === 'object' && result !== null\r\n      ? JSON.parse(JSON.stringify(result))\r\n      : result\r\n  }\r\n}\r\n","import { createGlobalStyle } from 'styled-components';\r\n\r\nimport theme from './theme';\r\n\r\nexport default createGlobalStyle`\r\n  body {\r\n    font-family: ${theme.font};\r\n    font-size: ${theme.fontSize};\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n  }\r\n`;\r\n","import React, { Fragment } from 'react';\r\nimport { ThemeProvider } from 'styled-components';\r\nimport 'sanitize.css';\r\n\r\nimport GlobalStyles from './global-styles';\r\n\r\nimport theme from './theme';\r\n\r\nexport default ({ children }) => (\r\n  <ThemeProvider theme={theme}>\r\n    <Fragment>\r\n      {children}\r\n      <GlobalStyles />\r\n    </Fragment>\r\n  </ThemeProvider>\r\n);\r\n","import { useEffect } from 'react'\r\nimport useLocalStorage from 'react-use-localstorage';\r\n\r\nexport default (name, initialVal, devOnly) => hook => {\r\n  if (devOnly && process.env.NODE_ENV !== 'development') {\r\n    return hook(initialVal)\r\n  }\r\n  const [item, setItem] = useLocalStorage(name, JSON.stringify(initialVal));\r\n  const [val, setVal] = hook(item && JSON.parse(item))\r\n\r\n  useEffect(() => {\r\n    setItem(JSON.stringify(val))\r\n  }, [val])\r\n\r\n  return [val, setVal]\r\n}\r\n","import merge from 'lodash/merge';\r\nimport { style } from 'styled-system';\r\n\r\nconst getConfig = (key, options) => merge({\r\n  prop: key,\r\n  cssProperty: key,\r\n}, options);\r\n\r\nconst injectProps = (key, options) => style(getConfig(key, options));\r\n\r\nexport default injectProps;\r\n","import React, { forwardRef } from 'react'\r\n\r\nexport default SubComp => forwardRef(({ is, ...props }, ref) => {\r\n  if (is) {\r\n    console.error('\"is\" is no longer supported, us \"as\" instead')\r\n  }\r\n  return <SubComp as={is} ref={ref} {...props} />\r\n})\r\n","import React, { forwardRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport shouldForwardProp from '@styled-system/should-forward-prop'\r\nimport {\r\n  space,\r\n  layout,\r\n  typography,\r\n  position,\r\n  color,\r\n  borderRadius,\r\n  zIndex,\r\n  border,\r\n  flex,\r\n  opacity,\r\n  style,\r\n} from 'styled-system';\r\n\r\nimport injectProps from './utils/injectProps';\r\nimport isToAs from './utils/isToAs'\r\n\r\nconst Box = isToAs(styled.div.withConfig({ shouldForwardProp })`\r\n  ${space}\r\n  ${layout}\r\n  ${position}\r\n  ${typography}\r\n  ${color}\r\n  ${position}\r\n  ${zIndex}\r\n  ${border}\r\n  ${flex}\r\n  ${borderRadius}\r\n  ${opacity}\r\n  ${injectProps('whiteSpace')}\r\n  ${injectProps('overflow')}\r\n  ${injectProps('transform')}\r\n  ${injectProps('transition')}\r\n  ${style({\r\n    prop: 'zOrder',\r\n    cssProperty: 'zIndex',\r\n    key: 'zOrder',\r\n  })}\r\n  ${({ onClick }) => onClick && 'cursor: pointer;'}\r\n`);\r\n\r\nBox.displayName = 'Box';\r\n\r\nBox.Inline = forwardRef((props, ref) => <Box ref={ref} as=\"span\" display=\"inline-block\" verticalAlign=\"middle\" {...props} />);\r\nBox.Absolute = forwardRef((props, ref) => <Box ref={ref} position=\"absolute\" {...props} />);\r\nBox.FullAbsolute = forwardRef((props, ref) => <Box.Absolute ref={ref} top=\"0\" left=\"0\" right=\"0\" bottom=\"0\" {...props} />);\r\nBox.Relative = forwardRef((props, ref) => <Box ref={ref} position=\"relative\" {...props} />);\r\n\r\nexport default Box;\r\n","import React from 'react'\r\n\r\nexport default SubComp => ({ as, ...props }) => {\r\n  return <SubComp forwardedAs={as} {...props} />\r\n}\r\n","import { flexbox } from 'styled-system';\r\nimport styled from 'styled-components';\r\n\r\nimport Box from './Box';\r\n\r\nimport asForward from './utils/asForward'\r\n\r\nconst Flex = styled(Box)`\r\n  ${flexbox}\r\n`;\r\n\r\nFlex.defaultProps = {\r\n  display: 'flex',\r\n};\r\n\r\nFlex.displayName = 'Flex';\r\n\r\nexport default asForward(Flex);\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport range from 'lodash/range';\r\nimport {\r\n  typography,\r\n  space,\r\n  color,\r\n  display,\r\n  position,\r\n} from 'styled-system';\r\nimport shouldForwardProp from '@styled-system/should-forward-prop'\r\n\r\nimport injectProps from './utils/injectProps';\r\nimport isToAs from './utils/isToAs'\r\n\r\nconst Text = isToAs(styled.p.withConfig({ shouldForwardProp })`\r\n  margin-top: 0;\r\n  margin-bottom: 0;\r\n  ${typography}\r\n  ${display}\r\n  ${space}\r\n  ${color}\r\n  ${position}\r\n  ${injectProps('textTransform')}\r\n`);\r\n\r\nText.defaultProps = {\r\n  fontSize: '1em',\r\n  // lineHeight: 1.5,\r\n};\r\n\r\nText.Inline = (props) => <Text as=\"span\" {...props} />;\r\nText.Bold = (props) => <Text fontWeight=\"bold\" {...props} />;\r\nText.Thin = (props) => <Text fontWeight=\"200\" {...props} />;\r\n\r\nrange(1, 7).forEach((key) => {\r\n  Text[`H${key}`] = (props) => (\r\n    <Text\r\n      as={`h${key}`}\r\n      fontSize={`${1 + ((6 - key) * 0.125)}em`}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n\r\nText.displayName = 'Text';\r\n\r\nexport default Text;\r\n","import React, { createElement } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport styled from 'styled-components';\r\nimport { textAlign } from 'styled-system';\r\nimport themeGet from '@styled-system/theme-get';\r\n\r\nimport Flex from './Flex';\r\nimport Box from './Box';\r\nimport Text from './Text';\r\n\r\nconst TextInput = styled.input`\r\n  font-family: inherit;\r\n  width: 100%;\r\n  padding: 0.25em;\r\n  border: 1px solid ${themeGet('colors.gray')};\r\n  border-radius: 0;\r\n  font-size: 1em;\r\n  ${textAlign}\r\n  &::placeholder {\r\n    color: ${themeGet('colors.gray')};\r\n  }\r\n`;\r\n\r\nconst Input = ({\r\n  label,\r\n  labelWidth,\r\n  name,\r\n  placeholder,\r\n  disabled,\r\n  value,\r\n  onChange,\r\n  onBlur,\r\n  onKeyUp,\r\n  error,\r\n  type,\r\n  min,\r\n  max,\r\n  textAlign,\r\n  step,\r\n  ...props\r\n}) => (\r\n  <Flex as=\"label\" alignItems=\"center\" {...props}>\r\n    {label && (\r\n      <Box mr=\"1em\" w={labelWidth}>\r\n        <Text fontWeight=\"bold\">{label}</Text>\r\n      </Box>\r\n    )}\r\n    <Box flex=\"1\">\r\n      {createElement(TextInput, {\r\n        name,\r\n        placeholder,\r\n        disabled,\r\n        value,\r\n        onChange,\r\n        onBlur,\r\n        onKeyUp,\r\n        type,\r\n        min,\r\n        max,\r\n        textAlign,\r\n        step,\r\n      })}\r\n      {error && (\r\n        <Text fontSize=\"0.8em\" align=\"left\" color=\"red\" mt=\"0.25rem\">{error}</Text>\r\n      )}\r\n    </Box>\r\n  </Flex>\r\n);\r\n\r\nInput.propTypes = {\r\n  label: PropTypes.string,\r\n  labelWidth: PropTypes.string,\r\n  name: PropTypes.string,\r\n  error: PropTypes.oneOfType([\r\n    PropTypes.bool,\r\n    PropTypes.string,\r\n  ]),\r\n  placeholder: PropTypes.string,\r\n  disabled: PropTypes.bool,\r\n  value: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.number,\r\n  ]),\r\n  onChange: PropTypes.func,\r\n  onKeyUp: PropTypes.func,\r\n  onBlur: PropTypes.func,\r\n};\r\n\r\nInput.displayName = 'Input';\r\n\r\nexport default Input;\r\n","import { createContext } from 'react'\r\n\r\nexport default createContext({})\r\n","import React, { useCallback, useState, useMemo } from 'react';\r\nimport * as Msal from 'msal'\r\nimport { useImmer } from 'use-immer'\r\n\r\nimport hookWithLocalStorage from '../../utils/hookWithLocalStorage'\r\nimport Input from '../../components/Input'\r\n\r\nimport context from './context'\r\n\r\n// Config object to be passed to Msal on creation.\r\n// For a full list of msal.js configuration parameters,\r\n// visit https://azuread.github.io/microsoft-authentication-library-for-js/docs/msal/modules/_authenticationparameters_.html\r\nconst msalConfig = {\r\n  auth: {\r\n    clientId: '5ed0f7c5-cd47-4779-bfd3-53f5b0445c94',\r\n    authority: 'https://login.microsoftonline.com/common',\r\n    redirectUri: process.env.NODE_ENV === 'development' ? 'http://localhost:3000/' : 'https://relabcc.github.io/winbond-excel-roadmap/',\r\n  },\r\n  cache: {\r\n    cacheLocation: 'sessionStorage', // This configures where your cache will be stored\r\n    storeAuthStateInCookie: false, // Set this to 'true' if you are having issues on IE11 or Edge\r\n  },\r\n};\r\n\r\nconst graphConfig = {\r\n  getReadSheetEndPoint: id => `https://graph.microsoft.com/v1.0/me/drive/items/${id}/workbook/worksheets`,\r\n  getReadSheetDataEndPoint: (id, sheetName) => `https://graph.microsoft.com/v1.0/me/drive/items/${id}/workbook/worksheets/${sheetName}/usedRange`,\r\n}\r\n\r\n// Add here scopes for id token to be used at MS Identity Platform endpoints.\r\nconst loginRequest = {\r\n  scopes: ['openid', 'profile', 'User.Read', 'Files.Read']\r\n};\r\n\r\nconst myMSALObj = new Msal.UserAgentApplication(msalConfig);\r\n\r\nfunction callMSGraph(endpoint, token) {\r\n  const headers = new Headers();\r\n  const bearer = `Bearer ${token}`;\r\n\r\n  headers.append(\"Authorization\", bearer);\r\n\r\n  const options = {\r\n      method: \"GET\",\r\n      headers: headers\r\n  };\r\n\r\n  console.log('request made to Graph API at: ' + new Date().toString());\r\n\r\n  return fetch(endpoint, options)\r\n    .then(response => response.json())\r\n    .catch(error => console.log(error))\r\n}\r\n\r\nfunction getTokenPopup(request) {\r\n  return myMSALObj.acquireTokenSilent(request)\r\n    .catch(error => {\r\n      console.log(error);\r\n      console.log(\"silent token acquisition fails. acquiring token using popup\");\r\n\r\n      // fallback to interaction when silent call fails\r\n        return myMSALObj.acquireTokenPopup(request)\r\n          .then(tokenResponse => {\r\n            return tokenResponse;\r\n          }).catch(error => {\r\n            console.log(error);\r\n          });\r\n    });\r\n}\r\n\r\n// https://onedrive.live.com/edit.aspx?cid=0c338d6b32e0967e&page=view&resid=C338D6B32E0967E!107&parId=C338D6B32E0967E!101&app=Excel\r\n\r\nconst Provider = ({ children }) => {\r\n  const [account, setAccount] = useState(myMSALObj.getAccount())\r\n  const [loading, setLoading] = useState()\r\n  const [workbookUrl, setWorkbookUrl] = hookWithLocalStorage('WORKBOOK_URL')(useState)\r\n  const [sheets, setSheets] = hookWithLocalStorage('WORKSHEETS')(useState)\r\n  const [sheetData, setSheetData] = hookWithLocalStorage('SHEET_DATA', {})(useImmer)\r\n  const workbookId = useMemo(() => {\r\n    try {\r\n      const url = new URL(workbookUrl);\r\n      const params = new URLSearchParams(url.search);\r\n      return params.get('resid')\r\n    } catch (e) {\r\n      return ''\r\n    }\r\n  }, [workbookUrl])\r\n  const signIn = useCallback(() => {\r\n    myMSALObj.loginPopup(loginRequest)\r\n      .then(loginResponse => {\r\n        console.log('id_token acquired at: ' + new Date().toString());\r\n        console.log(loginResponse);\r\n\r\n        if (myMSALObj.getAccount()) {\r\n          setAccount(myMSALObj.getAccount())\r\n        }\r\n      }).catch(error => {\r\n        console.log(error);\r\n      });\r\n  }, [setAccount])\r\n\r\n  const signOut = useCallback(() => {\r\n    if (account) {\r\n      myMSALObj.logout();\r\n      setAccount(null)\r\n    }\r\n  }, [setAccount, account])\r\n\r\n  const loadSheets = () => {\r\n    if (account && !loading && workbookId) {\r\n      console.log('start load sheet')\r\n      setLoading(true)\r\n      getTokenPopup(loginRequest)\r\n        .then(response => {\r\n          callMSGraph(graphConfig.getReadSheetEndPoint(workbookId), response.accessToken)\r\n            .then(data => {\r\n              if (data.value) {\r\n                setSheets(data.value)\r\n              }\r\n              setLoading(false)\r\n            });\r\n        }).catch(error => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const loadSheetData = useCallback((sheetName) => {\r\n    if (account && !loading && workbookId && !sheetData[sheetName]) {\r\n      console.log('start load sheet data')\r\n      setLoading(true)\r\n      getTokenPopup(loginRequest)\r\n        .then(response => {\r\n          callMSGraph(graphConfig.getReadSheetDataEndPoint(workbookId, sheetName), response.accessToken)\r\n            .then(data => {\r\n              console.log(data)\r\n              if (data) {\r\n                setSheetData(draft => {\r\n                  draft[sheetName] = data\r\n                })\r\n              }\r\n              setLoading(false)\r\n            });\r\n        }).catch(error => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }, [loading, account, sheetData, workbookId])\r\n\r\n  const WorkBookIdInput = useCallback((p) => (\r\n    <Input\r\n      label=\"貼上Excel連結\"\r\n      value={workbookUrl}\r\n      onChange={e => setWorkbookUrl(e.target.value)}\r\n      onKeyUp={e => e.keyCode === 13 && loadSheets()}\r\n      {...p}\r\n    />\r\n  ), [workbookUrl])\r\n\r\n  return (\r\n    <context.Provider\r\n      value={{\r\n        account,\r\n        signIn,\r\n        signOut,\r\n        loadSheets,\r\n        loadSheetData,\r\n        loading,\r\n        sheets,\r\n        sheetData,\r\n        WorkBookIdInput,\r\n      }}\r\n    >\r\n      {children}\r\n    </context.Provider>\r\n  );\r\n};\r\n\r\nexport default Provider;\r\n","import React from 'react';\r\n\r\nimport Box from './Box';\r\nimport { containerWidth } from './ThemeProvider/theme';\r\n\r\nconst Container = (props) => <Box {...props} />;\r\n\r\nContainer.defaultProps = {\r\n  mx: 'auto',\r\n  px: ['1em', null, '2em'],\r\n  width: 1,\r\n  maxWidth: containerWidth,\r\n};\r\n\r\nContainer.displayName = 'Container';\r\n\r\nexport default Container;\r\n","import { style } from 'styled-system';\r\n\r\nexport const customColor = (prop, cssProperty = 'color') => style ({\r\n  prop,\r\n  cssProperty,\r\n  key: 'colors',\r\n});\r\n","import React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport {\r\n  typography,\r\n  space,\r\n  color,\r\n  layout,\r\n  border,\r\n  borderRadius,\r\n  position,\r\n} from 'styled-system';\r\nimport themeGet from '@styled-system/theme-get';\r\nimport shouldForwardProp from '@styled-system/should-forward-prop'\r\n\r\nimport Box from './Box';\r\n\r\nimport { customColor } from './utils/getColor';\r\nimport isToAs from './utils/isToAs'\r\n\r\nconst active = css`\r\n  ${customColor('hoverColor')};\r\n  ${customColor('hoverBg', 'backgroundColor')};\r\n  ${customColor('hoverBorder', 'borderColor')};\r\n`;\r\n\r\nconst ButtonBase = styled.button.withConfig({ shouldForwardProp })`\r\n  padding: 0;\r\n  border: none;\r\n  font-family: inherit;\r\n  line-height: 1;\r\n  text-decoration: none;\r\n  ${typography}\r\n  ${layout}\r\n  ${position}\r\n  ${space}\r\n  ${color}\r\n  ${border}\r\n  ${borderRadius}\r\n  appearance: none;\r\n  transition: all ${themeGet('duration', 250)}ms;\r\n  cursor: pointer;\r\n  &:hover,\r\n  &:focus {\r\n    ${props => !props.disabled && active}\r\n    outline: none;\r\n  }\r\n  ${props => props.active && !props.disabled && active}\r\n  ${props =>\r\n    props.disabled &&\r\n    `\r\n    cursor: not-allowed;\r\n    opacity: 0.5;\r\n  `}\r\n`;\r\n\r\nconst InButtonSpan = props => <Box as=\"span\" {...props} />;\r\n\r\nconst Button = isToAs(({\r\n  leftIcon,\r\n  rightIcon,\r\n  iconSpacing,\r\n  iconsSize,\r\n  children,\r\n  verticalAlign,\r\n  ...props\r\n}) => (\r\n  <ButtonBase {...props}>\r\n    {leftIcon ? (\r\n      <Box as={leftIcon} mr={iconSpacing} verticalAlign={verticalAlign} fontSize={iconsSize} />\r\n    ) : null}\r\n    <InButtonSpan verticalAlign={verticalAlign}>{children}</InButtonSpan>\r\n    {rightIcon ? (\r\n      <Box as={rightIcon} ml={iconSpacing} verticalAlign={verticalAlign} fontSize={iconsSize} />\r\n    ) : null}\r\n  </ButtonBase>\r\n));\r\n\r\nButton.defaultProps = {\r\n  border: '2px solid',\r\n  borderColor: 'primary',\r\n  bg: 'primary',\r\n  color: 'white',\r\n  hoverColor: 'white',\r\n  hoverBg: 'primaryHover',\r\n  hoverBorder: 'primaryHover',\r\n  px: '1.5em',\r\n  py: '0.75em',\r\n  fontWeight: 'bold',\r\n  iconSpacing: '0.25em',\r\n  borderRadius: '0.25em',\r\n  display: 'inline-block',\r\n  verticalAlign: 'middle',\r\n  iconsSize: '1.25em',\r\n};\r\n\r\nButton.displayName = 'Button';\r\n\r\nButton.Danger = props => (\r\n  <Button\r\n    bg=\"danger\"\r\n    borderColor=\"danger\"\r\n    hoverBg=\"dangerHover\"\r\n    hoverBorder=\"dangerHover\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Secondary = props => (\r\n  <Button\r\n    bg=\"secondary\"\r\n    border=\"2px solid\"\r\n    borderColor=\"secondary\"\r\n    hoverBg=\"secondaryHover\"\r\n    hoverBorder=\"secondaryHover\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Outline = props => (\r\n  <Button\r\n    border=\"2px solid\"\r\n    borderColor=\"primary\"\r\n    bg=\"transparent\"\r\n    color=\"primary\"\r\n    hoverColor=\"white\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Outline.Danger = props => (\r\n  <Button.Danger\r\n    border=\"2px solid\"\r\n    borderColor=\"danger\"\r\n    bg=\"transparent\"\r\n    color=\"danger\"\r\n    hoverColor=\"white\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Transparent = props => (\r\n  <Button\r\n    border=\"1px solid transparent\"\r\n    bg=\"transparent\"\r\n    color=\"text\"\r\n    hoverBorder=\"primary\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nexport default Button;\r\n","import React, { useMemo } from 'react';\r\n\r\nimport Select from 'react-select';\r\n\r\nimport Flex from './Flex'\r\nimport Box from './Box'\r\nimport Text from './Text'\r\n\r\nconst SingleSelect = ({ options, name, onChange, value, label, disabled, ...props }) => {\r\n  const formattedOptions = useMemo(() => {\r\n    if (!options || !options.length) return []\r\n    return options.map(opt => {\r\n      if (typeof opt === 'string') {\r\n        return { label: opt, value: opt }\r\n      }\r\n      return opt\r\n    })\r\n  }, [options])\r\n  return (\r\n    <Flex alignItems=\"center\" {...props}>\r\n      <Text mr=\"0.5em\" disabled={disabled}>{label}</Text>\r\n      <Box width=\"12em\">\r\n        <Select\r\n          defaultValue={value}\r\n          isClearable\r\n          name={name}\r\n          options={formattedOptions}\r\n          onChange={onChange}\r\n          isDisabled={disabled}\r\n        />\r\n      </Box>\r\n    </Flex>\r\n  )\r\n}\r\n\r\nexport default SingleSelect\r\n","import React, { createElement } from 'react';\r\nimport ReactPaginate from 'react-paginate';\r\nimport styled from 'styled-components'\r\nimport themeGet from '@styled-system/theme-get'\r\n\r\nimport Box from './Box'\r\n\r\nconst Wrapper = styled(Box)`\r\n.pagination {\r\n  display: flex;\r\n  list-style-type: none;\r\n  margin-left: -0.5em;\r\n  margin-right: -0.5em;\r\n  padding: 0;\r\n  justify-content: center;\r\n  & > li > a {\r\n    padding: 0.5em;\r\n  }\r\n  & > li:not(.disabled) > a,\r\n  & > li:not(.selected) > a {\r\n    cursor: pointer;\r\n  }\r\n\r\n  & > li.selected > a {\r\n    font-weight: bold;\r\n    color: ${themeGet('colors.primary')};\r\n  }\r\n}\r\n`\r\n\r\nconst Pagination = ({\r\n  pageCount,\r\n  pageRangeDisplayed,\r\n  marginPagesDisplayed,\r\n  onPageChange,\r\n  initialPage,\r\n  forcePage,\r\n  disableInitialCallback,\r\n  ...props\r\n}) => {\r\n  return (\r\n    <Wrapper {...props}>\r\n      {createElement(ReactPaginate, {\r\n        pageCount,\r\n        pageRangeDisplayed,\r\n        marginPagesDisplayed,\r\n        onPageChange,\r\n        initialPage,\r\n        forcePage,\r\n        disableInitialCallback,\r\n        containerClassName: 'pagination',\r\n      })}\r\n    </Wrapper>\r\n  );\r\n};\r\n\r\nexport default Pagination;\r\n","import React, { useMemo, forwardRef, useRef, useEffect } from 'react';\r\nimport { useTable, useFilters, useRowSelect } from 'react-table'\r\nimport styled from 'styled-components'\r\nimport isObject from 'lodash/isObject'\r\n\r\nimport Box from '../components/Box'\r\n\r\nconst StyledTable = styled.table`\r\nwidth: max-content;\r\nth,\r\ntd {\r\n  white-space: pre-wrap;\r\n  padding: 0.5em;\r\n}\r\n`\r\n\r\nconst StyledInput = styled.input`\r\n  width: 100%;\r\n`\r\n\r\nconst IndeterminateCheckbox = forwardRef(\r\n  ({ indeterminate, ...rest }, ref) => {\r\n    const defaultRef = useRef()\r\n    const resolvedRef = ref || defaultRef\r\n\r\n    useEffect(() => {\r\n      resolvedRef.current.indeterminate = indeterminate\r\n    }, [resolvedRef, indeterminate])\r\n\r\n    return (\r\n      <>\r\n        <input type=\"checkbox\" ref={resolvedRef} {...rest} />\r\n      </>\r\n    )\r\n  }\r\n)\r\n\r\n// Define a default UI for filtering\r\nfunction DefaultColumnFilter({\r\n  column: { filterValue, preFilteredRows, setFilter },\r\n}) {\r\n  const count = preFilteredRows.length\r\n\r\n  return (\r\n    <StyledInput\r\n      value={filterValue || ''}\r\n      onChange={e => {\r\n        setFilter(e.target.value || undefined) // Set undefined to remove the filter entirely\r\n      }}\r\n      placeholder={`Search ${count} records...`}\r\n    />\r\n  )\r\n}\r\n\r\nconst defaultColumn = {\r\n  Filter: DefaultColumnFilter,\r\n  canFilter: false,\r\n}\r\n\r\nconst SheetDataTable = ({ data, headerRow, onSelectRow }) => {\r\n  const columns = useMemo(() => {\r\n    const cols = headerRow.map((Header, i) => {\r\n      const col = isObject(Header) ? Object.assign({}, Header) : { Header, accessor: d => d[i], id: i }\r\n      return col\r\n    })\r\n    return cols\r\n  }, [headerRow])\r\n  const tableInstance = useTable({\r\n    columns,\r\n    data,\r\n    defaultColumn,\r\n    // filterTypes,\r\n    initialState: {\r\n      selectedRowIds: data.reduce((sels, r, id) => {\r\n        sels[id] = true\r\n        return sels\r\n      }, {}),\r\n    },\r\n  },\r\n  useFilters,\r\n  useRowSelect,\r\n  hooks => {\r\n    hooks.visibleColumns.push(columns => [\r\n      // Let's make a column for selection\r\n      {\r\n        id: 'selection',\r\n        // The header can use the table's getToggleAllRowsSelectedProps method\r\n        // to render a checkbox\r\n        Header: ({ getToggleAllRowsSelectedProps }) => (\r\n          <div>\r\n            <IndeterminateCheckbox {...getToggleAllRowsSelectedProps()} />\r\n          </div>\r\n        ),\r\n        // The cell can use the individual row's getToggleRowSelectedProps method\r\n        // to the render a checkbox\r\n        Cell: ({ row }) => (\r\n          <div>\r\n            <IndeterminateCheckbox {...row.getToggleRowSelectedProps()} />\r\n          </div>\r\n        ),\r\n      },\r\n      ...columns,\r\n    ])\r\n  })\r\n\r\n  const {\r\n    getTableProps,\r\n    getTableBodyProps,\r\n    headerGroups,\r\n    rows,\r\n    prepareRow,\r\n    state: { selectedRowIds },\r\n  } = tableInstance\r\n\r\n  useEffect(() => {\r\n    onSelectRow(selectedRowIds)\r\n  }, [onSelectRow, selectedRowIds])\r\n\r\n  return (\r\n    <Box overflowX=\"auto\">\r\n      <StyledTable {...getTableProps()}>\r\n        <thead>\r\n          {// Loop over the header rows\r\n          headerGroups.map(headerGroup => (\r\n            // Apply the header row props\r\n            <tr {...headerGroup.getHeaderGroupProps()}>\r\n              {// Loop over the headers in each row\r\n              headerGroup.headers.map((column, i) => (\r\n                // Apply the header cell props\r\n                <th {...column.getHeaderProps()}>\r\n                  {// Render the header\r\n                  column.render('Header')}\r\n                  <div>{column.canFilter && i === 1 ? column.render('Filter') : null}</div>\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          ))}\r\n        </thead>\r\n        {/* Apply the table body props */}\r\n        <tbody {...getTableBodyProps()}>\r\n          {// Loop over the table rows\r\n          rows.map(row => {\r\n            // Prepare the row for display\r\n            prepareRow(row)\r\n            return (\r\n              // Apply the row props\r\n              <tr {...row.getRowProps()}>\r\n                {// Loop over the rows cells\r\n                row.cells.map(cell => {\r\n                  // Apply the cell props\r\n                  return (\r\n                    <td {...cell.getCellProps()}>\r\n                      {// Render the cell contents\r\n                      cell.render('Cell')}\r\n                    </td>\r\n                  )\r\n                })}\r\n              </tr>\r\n            )\r\n          })}\r\n        </tbody>\r\n      </StyledTable>\r\n    </Box>\r\n  )\r\n};\r\n\r\nSheetDataTable.defaultProps = {\r\n  onSelectRow: () => {},\r\n}\r\n\r\nexport default SheetDataTable;\r\n","import PropTypes from 'prop-types';\r\nimport styled from 'styled-components';\r\nimport { background } from 'styled-system';\r\n\r\nimport Box from './Box';\r\nimport asForward from './utils/asForward'\r\n\r\nconst BackgroundImage = styled(Box)`\r\n  ${background}\r\n  background-image: url(${({ src }) => src});\r\n  background-repeat: no-repeat;\r\n  ${(props) => props.height ? '' : `padding-top: ${props.ratio * 100}%;`}\r\n`;\r\n\r\nBackgroundImage.propTypes = {\r\n  src: PropTypes.string,\r\n  backgroundSize: PropTypes.string,\r\n  backgroundPosition: PropTypes.string,\r\n};\r\n\r\nBackgroundImage.defaultProps = {\r\n  position: 'relative',\r\n  ratio: 1,\r\n  backgroundSize: 'cover',\r\n  backgroundPosition: '50% 50%',\r\n};\r\n\r\nBackgroundImage.displayName = 'BackgroundImage';\r\n\r\nexport default asForward(BackgroundImage);\r\n","const PIXEL_RATIO = (function () {\r\n  const ctx = document.createElement('canvas').getContext('2d'),\r\n      dpr = window.devicePixelRatio || 1,\r\n      bsr = ctx.webkitBackingStorePixelRatio ||\r\n            ctx.mozBackingStorePixelRatio ||\r\n            ctx.msBackingStorePixelRatio ||\r\n            ctx.oBackingStorePixelRatio ||\r\n            ctx.backingStorePixelRatio || 1;\r\n\r\n  return dpr / bsr;\r\n})();\r\n\r\nconst setHiDPICanvas = function(canvas, w, h, ratio) {\r\n  if (!ratio) { ratio = PIXEL_RATIO; }\r\n  const can = canvas;\r\n  can.width = w * ratio;\r\n  can.height = h * ratio;\r\n  can.style.width = w + 'px';\r\n  can.style.height = h + 'px';\r\n  can.getContext('2d').setTransform(ratio, 0, 0, ratio, 0, 0);\r\n}\r\n\r\nclass Dom2Canvas {\r\n  constructor(dom, w, h, style) {\r\n    this.dom = dom;\r\n    this.canvas = null;\r\n    this.ctx = null;\r\n    this.width = w\r\n    this.height = h;\r\n    this.data = null;\r\n    this.injectedStyle = style;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init = () => {\r\n    if (!this.width) this.width = this.dom.clientWidth;\r\n    if (!this.height) this.height = this.dom.clientHeight;\r\n\r\n    // 初始化canvas\r\n    this.canvas = document.createElement('canvas');\r\n    setHiDPICanvas(this.canvas, this.width, this.height)\r\n    this.ctx = this.canvas.getContext('2d');\r\n    // 添加一个默认的矩形, 防止导出时, canvas的透明的.\r\n    // this._addBackgroundRect();\r\n\r\n    // 添加xmlns, 按照XHTML标准渲染，实现了SVG和XHTML的混合使用\r\n    this._addNamespace();\r\n\r\n    this.data = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.width}\" height=\"${this.height}\">\r\n      ${this.injectedStyle ? `<defs><style>${this.injectedStyle}</style></defs>` : ''}\r\n      <foreignObject width=\"100%\" height=\"100%\">${this.dom.outerHTML}</foreignObject>\r\n    </svg>`;\r\n  };\r\n\r\n  _addNamespace = () => {\r\n    this.dom.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');\r\n  }\r\n\r\n  toCanvas = (cb, ...moreSVG) => {\r\n    Promise.all([this.data, ...moreSVG].map(this.loadSVG)).then(() => {\r\n      if (cb) {\r\n        cb(this.canvas);\r\n      }\r\n    })\r\n  };\r\n\r\n  loadSVG = (svg) => {\r\n    if (!svg) return null\r\n    // hack: instead of a blobURL, if we use a dataURL, chrome seems happy...\r\n    const url = 'data:image/svg+xml; charset=utf8, ' + encodeURIComponent(svg);\r\n    const image = new Image();\r\n\r\n    return new Promise((res) => {\r\n      image.onload = () => {\r\n        this.ctx.drawImage(image, 0, 0);\r\n        URL.revokeObjectURL(url);\r\n        res()\r\n      }\r\n      image.src = url;\r\n    })\r\n  }\r\n}\r\n\r\nexport default Dom2Canvas\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport Box from './Box';\r\n\r\nconst Circle = ({ children, border, borderColor, bg, as, ...props }) => (\r\n  <Box {...props}>\r\n    <Box position=\"relative\" pt=\"100%\">\r\n      <Box\r\n        position=\"absolute\"\r\n        top=\"0\"\r\n        left=\"0\"\r\n        right=\"0\"\r\n        bottom=\"0\"\r\n        width={1}\r\n        borderRadius=\"50%\"\r\n        border={border}\r\n        borderColor={borderColor}\r\n        bg={bg}\r\n        as={as}\r\n      >\r\n        <Box\r\n          top=\"50%\"\r\n          left=\"50%\"\r\n          transform=\"translate(-50%, -50%)\"\r\n          position=\"absolute\"\r\n          lineHeight=\"0\"\r\n        >\r\n          {children}\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  </Box>\r\n);\r\n\r\nCircle.propTypes = {\r\n  children: PropTypes.node,\r\n  border: PropTypes.string,\r\n  borderColor: PropTypes.string,\r\n  bg: PropTypes.string,\r\n  as: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.func,\r\n  ]),\r\n};\r\n\r\nCircle.displayName = 'Circle';\r\n\r\nexport default Circle;\r\n","import React, { useMemo } from 'react'\nimport findLastIndex from 'lodash/findLastIndex'\nimport get from 'lodash/get'\nimport { FaCheckCircle } from 'react-icons/fa'\nimport { MdRemove, MdClear } from 'react-icons/md'\n\nimport Circle from '../../components/Circle'\n\nexport const useOrginizedHeader = headerGroups => useMemo(() => {\n  const placeHolders = {}\n  return headerGroups.reduce((headers, headerGroup, i) => {\n    headers[i] = headerGroup.headers.map((header, j) => {\n      if (header.placeholderOf) {\n        placeHolders[header.placeholderOf.id] = [i, j]\n        return {}\n      } else if (placeHolders[header.id]) {\n        const [x, y] = placeHolders[header.id]\n        headers[x][y] = { rowSpan: i - x + 1, children: header.render('Header') }\n        return {}\n      } else {\n        return { colSpan: header.totalVisibleHeaderCount, children: header.render('Header') }\n      }\n    })\n    return headers\n  }, [])\n}, [headerGroups])\n\nexport const useHeaderChildrenIndex = headerGroups => useMemo(() => headerGroups.reduce((ci, groups) => {\n  groups.headers.forEach(header => {\n    if (header.columns) {\n      const hid = header.originalId || header.id\n      ci[hid] = header.columns.reduce((ids, col, i) => {\n        const colId = col.originalId || col.id\n        ids[colId] = i\n        return ids\n      }, {})\n    }\n  });\n  return ci\n}, {}), [headerGroups])\n\nconst alldPttn = /^\\d+$/\nconst nmPttn = /\\d+\"\\w\"/\nconst yearPttn = /([1-4]Q)(\\d{2})|(\\d{2})(Q[1-4])/i\n\nexport const parseValue = value => {\n  if (yearPttn.test(value)) {\n    return value.replace(yearPttn, '$1\\n$2')\n  }\n  if (nmPttn.test(value)) {\n    return value.replace(/\\d+/, '$&\\n')\n  }\n  return value.replace(/\\//g, '$&\\n')\n}\n\nconst toYearFormat = (y, q) => [2000 + y * 1, q.replace(/\\D+/, '') * 1]\n\nexport const parseYear = value => {\n  if (alldPttn.test(value)) {\n    return [2000 + value * 1, 4]\n  }\n  if (yearPttn.test(value)) {\n    const a = value.substring(0, 2)\n    const b = value.substring(2)\n    if (alldPttn.test(a)) {\n      return toYearFormat(a, b)\n    }\n    return toYearFormat(b, a)\n  }\n  return value\n}\n\nconst checkPttn = /y|(yes)|(now)/i\nconst crossPttn = /n\\/?a/i\nconst noPttn = /^n|(no)$/i\n\nconst iconStyle = { size: '1.25em', style: { margin: '0.5em 0' } }\n\nconst parseCell = cell => {\n  if (!cell.value) return null\n  if (cell.value === '-') {\n    return <MdRemove {...iconStyle} />\n  }\n\n  if (checkPttn.test(cell.value)) {\n    return <FaCheckCircle {...iconStyle} />\n  }\n  if (crossPttn.test(cell.value.replace('\\n', ''))) {\n    return <MdClear {...iconStyle} />\n  }\n  if (noPttn.test(cell.value)) {\n    return <Circle width=\"1.25em\" my=\"0.5rem\" bg=\"darkGray\" opacity=\"0.3\" />\n  }\n  return cell.render('Cell')\n}\n\nexport const useOriginizedRows = ({\n  rows,\n  prepareRow,\n  allData,\n  updatedMark,\n}) => useMemo(() => {\n  return rows.reduce((allRows, row, i) => {\n    prepareRow(row)\n    const thisRow = row.cells.map((cell, j) => {\n      if (cell.value) {\n        return {\n          children: parseCell(cell),\n          rowSpan: 1,\n          updated: get(updatedMark, [i, j + 1]),\n        }\n      } else if (i === 0) {\n        const parentIndex = allData.findIndex(r => r[j + 1])\n        return {\n          children: get(allData, [parentIndex, j + 1]),\n          rowSpan: 1,\n          updated: get(updatedMark, [parentIndex, j + 1]),\n        }\n      } else {\n        const parentIndex = findLastIndex(allRows, r => r[j].rowSpan)\n        if (parentIndex > -1) allRows[parentIndex][j].rowSpan += 1\n        return {}\n      }\n    })\n    return allRows.concat([thisRow])\n  }, [])\n}, [rows, prepareRow, allData, updatedMark])\n","import range from 'lodash/range'\nimport theme from '../../components/ThemeProvider/theme'\n\nconst parenthesisPttn = /\\([^)]+\\)/\n\nconst xmlns = 'http://www.w3.org/2000/svg';\n\nclass Timeline {\n  constructor(w, h, bounds, n = 7) {\n    this.svg = document.createElementNS(xmlns, 'svg');\n    this.svg.style.position = 'absolute'\n    this.svg.style.top = 0\n    this.svg.style.left = 0\n    this.svg.setAttribute('width', w)\n    this.svg.setAttribute('height', h)\n    this.bounds = bounds\n    const secWidth = bounds.width / 7\n    range(n).forEach(i => {\n      const middle = bounds.left + secWidth * (i + 0.5)\n      this.addGuide(middle)\n      const right = middle + secWidth / 2\n      this.addGuide(right, true)\n    })\n  }\n\n  addGuide = (x, thick) => {\n    const line = document.createElementNS(xmlns, 'line');\n    line.setAttributeNS(null, 'x1', x)\n    line.setAttributeNS(null, 'y1', this.bounds.top)\n    line.setAttributeNS(null, 'x2', x)\n    line.setAttributeNS(null, 'y2', this.bounds.height + this.bounds.top)\n    if (thick) {\n      line.setAttributeNS(null, 'stroke', theme.colors.primary)\n      line.setAttributeNS(null, 'opacity', 0.33)\n      line.setAttributeNS(null, 'stroke-width', 2)\n    } else {\n      line.setAttributeNS(null, 'stroke', '#B5B5B5')\n      line.setAttributeNS(null, 'stroke-width', 1)\n      line.setAttributeNS(null, 'stroke-dasharray', 2)\n    }\n    this.svg.appendChild(line)\n  }\n\n  add = (x, y, w, h, fill) => {\n    const timeline = document.createElementNS(xmlns, 'rect');\n    timeline.setAttributeNS(null, 'x', x)\n    timeline.setAttributeNS(null, 'y', y)\n    timeline.setAttributeNS(null, 'width', w)\n    timeline.setAttributeNS(null, 'height', h)\n    timeline.setAttributeNS(null, 'fill', fill)\n    this.svg.appendChild(timeline)\n  }\n\n  addLabel = (x, y, id) => {\n    const idText = document.createElementNS(xmlns, 'text');\n    idText.setAttributeNS(null, 'text-anchor', 'middle')\n    idText.setAttributeNS(null, 'x', x)\n    idText.setAttributeNS(null, 'y', y)\n    idText.setAttributeNS(null, 'fill', 'black')\n    idText.setAttributeNS(null, 'font-size', '32px')\n    idText.setAttributeNS(null, 'font-family', theme.font)\n    idText.setAttributeNS(null, 'font-weight', 'bold')\n    const inPranthesis = parenthesisPttn.exec(id)\n    if (inPranthesis) {\n      idText.textContent = id.replace(inPranthesis[0], '')\n      const smallText = document.createElementNS(xmlns, 'tspan');\n      smallText.setAttributeNS(null, 'font-size', '22px')\n      smallText.textContent = inPranthesis[0]\n      idText.appendChild(smallText)\n    } else {\n      idText.textContent = id\n    }\n    this.svg.appendChild(idText)\n  }\n\n  getSVG = () => this.svg\n}\n\nexport default Timeline\n","import React, { useMemo, useRef, useEffect, useCallback, createRef } from 'react';\nimport { useTable } from 'react-table'\nimport styled, { createGlobalStyle, css } from 'styled-components'\nimport last from 'lodash/last'\nimport shuffle from 'lodash/shuffle'\nimport isObject from 'lodash/isObject'\nimport range from 'lodash/range'\nimport get from 'lodash/get'\nimport { saveAs } from 'file-saver'\nimport composeRefs from '@seznam/compose-react-refs'\n\nimport '../../vendor/Blob'\nimport '../../vendor/canvas-toBlob'\n\nimport Box from '../../components/Box'\nimport Flex from '../../components/Flex'\nimport BackgroundImage from '../../components/BackgroundImage'\nimport Button from '../../components/Button'\nimport theme from '../../components/ThemeProvider/theme'\n\nimport Dom2Canvas from '../../utils/dom2canvas'\nimport {\n  useOrginizedHeader,\n  useHeaderChildrenIndex,\n  useOriginizedRows,\n  parseValue,\n  parseYear,\n} from './helpers'\nimport Timeline from './timeline'\n\nconst clearChildren = dom => {\n  dom.innerHTML = ''\n}\n\nconst CanvasContainer = styled(Box.FullAbsolute)`\n  canvas {\n    width: 100%;\n    height: auto;\n  }\n`\n\nconst headerBar = css`\n  content: \"\";\n  display: block;\n  position: absolute;\n  left: 0;\n  right: 0;\n  height: 8px;\n  background: ${theme.colors.primary};\n`\n\nconst TableStyle = createGlobalStyle`\n  table.render-table {\n    line-height: 1.375;\n    font-family: ${theme.font};\n    tr:last-child > th {\n      position: relative;\n      &::before {\n        ${headerBar}\n        top: 0;\n      }\n      &::after {\n        ${headerBar}\n        bottom: 2px;\n      }\n    }\n    tr > th,\n    tr > td {\n      min-width: 50px;\n    }\n  }\n`\n\nconst WIDTH = 1920\nconst HEIGHT = 1080\nconst borderGap = 9\nconst borderLine = 3\nconst timelinePadding = 6\nconst timelineOffsetX = 6\nconst timelineOffsetY = 12\n\nconst rotateStyle = {\n  writingMode: 'vertical-rl',\n  textOrientation: 'mixed',\n  transform: 'rotate(180deg)',\n}\n\nfunction xml2string(node) {\n  if (typeof(XMLSerializer) !== 'undefined') {\n     const serializer = new XMLSerializer();\n     return serializer.serializeToString(node);\n  } else if (node.xml) {\n     return node.xml;\n  }\n}\n\nconst DecoLine = styled.div`\n  position:absolute;\n  right: -${borderGap / 2 + 1}px;\n  top: 16px;\n  bottom: 16px;\n  width: 2px;\n  background: ${theme.colors.primary};\n`\n\nconst startYear = new Date().getFullYear()\n\nconst timelinePttn = /^\\[tl/;\nconst timelineStartPttn = /^\\[tl start/;\nconst timelineEndPttn = /^\\[tl end/;\nconst ddrPattn = /^DDR/\n\nconst yearsHeader = {\n  Header: 'T',\n  columns: range(7).map(i => {\n    const y = i + startYear\n    return {\n      Header: y,\n      id: y,\n      accessor: (d) => {\n        const { length } = d\n        const start = d[length - 3]\n        const end = d[length - 2]\n        if (y === start[0]) {\n          return '[tl start]'\n        } else if (y === end[0]) {\n          return '[tl end]'\n        } else if (y > start[0] && (y < end[0] || !end)) {\n          return '[tl]'\n        }\n        return '[tl]'\n      },\n    }\n  }),\n}\n\nconst colorGen = []\n\nconst RenderTable = ({ data, headerRow, allData, updatedMark, page }) => {\n  const colors = useMemo(() => {\n    if (colorGen[page]) return colorGen[page]\n    const gen = shuffle(theme.availColors).map(k => theme.colors[k])\n    colorGen[page] = gen\n    return gen\n  }, [page])\n  const tableRef = useRef()\n  const container = useRef()\n  const columns = useMemo(() => {\n    const cols = headerRow.slice(1, headerRow.length - 1)\n      .map((Header, i) => isObject(Header) ? Object.assign({}, Header) : { Header, accessor: d => d[i], id: i })\n      .concat(yearsHeader)\n\n    return cols\n  }, [headerRow])\n  const techIndex = useMemo(() => columns.findIndex(col => /^Technology/.test(col.Header)), [columns])\n  const groupStart = useMemo(() => columns.findIndex(col => col.columns), [columns])\n  const parsedData = useMemo(() => {\n    let colorIndex = 0\n    return data.map(row => {\n      const rowCount = row.length\n      if (row[techIndex + 2]) colorIndex += 1\n      const mapped = row.map((v, i) => {\n        if (i >= rowCount - 3 && i < rowCount - 1) return parseYear(v)\n        return parseValue(v)\n      })\n      mapped.colorIndex = colorIndex\n\n      return mapped\n    })\n  }, [data, techIndex])\n  const timelineContainerRef = useRef()\n  const timelineStartRef = useRef()\n  const timelineEndRef = useRef()\n  const timlineRefs = useMemo(() => range(parsedData.length).map(() => ({\n    start: { ref: createRef() },\n    end: { ref: createRef() },\n  })), [parsedData])\n\n  const notes = useMemo(() => data.reduce((all, row) => {\n    const note = last(row)\n    if (note) all.push(note)\n    return all\n  }, []), [data])\n\n  const tableInstance = useTable({\n    columns,\n    data: parsedData,\n  })\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = tableInstance\n\n  const orginizedHeader = useOrginizedHeader(headerGroups)\n  const headerChildrenIndex = useHeaderChildrenIndex(headerGroups)\n  const orginizedRows = useOriginizedRows({\n    rows,\n    prepareRow,\n    allData,\n    updatedMark,\n  })\n\n  const handleDownload = useCallback(() => {\n    container.current.querySelector('canvas').toBlob((blob) => {\n      saveAs(blob, `page-${page + 1}.png`);\n    });\n  }, [container, page])\n\n  useEffect(() => {\n    const sanitize = document.querySelector('style')\n    const style = document.querySelector('style[data-styled=\"active\"]')\n    const { length } = parsedData[0]\n    const containerBox = tableRef.current.getBoundingClientRect()\n    const timelineStartBox = timelineStartRef.current.getBoundingClientRect()\n    const timelineEndBox = timelineEndRef.current.getBoundingClientRect()\n    const timelineBounds = {\n      left: Math.round(timelineStartBox.left - containerBox.left) + timelineOffsetX,\n      top: Math.round(timelineStartBox.top - containerBox.top + timelinePadding) - timelineOffsetY,\n      width: Math.round(timelineEndBox.right - timelineStartBox.left),\n      height: Math.round(timelineEndBox.bottom - timelineStartBox.top - timelinePadding) + timelineOffsetY,\n    }\n    clearChildren(timelineContainerRef.current)\n    const labelPos = timelineBounds.left + timelineBounds.width / 2\n    const tl = new Timeline(WIDTH, HEIGHT, timelineBounds)\n    timlineRefs.forEach((refs, i) => {\n      const start = parsedData[i][length - 3]\n      const end = parsedData[i][length - 2]\n      const startRect = refs.start.ref.current.getBoundingClientRect()\n      const endRect = refs.end.ref.current.getBoundingClientRect()\n      const x = Math.round(startRect.left + startRect.width * (start[1] ? (start[1] - 1) / 4 : 0) - containerBox.left + timelinePadding)\n      const y = Math.round(startRect.top - containerBox.top + timelinePadding)\n      tl.add(\n        x,\n        y,\n        Math.round(endRect.left - containerBox.left - x + endRect.width * (end[1] ? end[1] / 4 : 0)) + 9,\n        Math.round(endRect.bottom - containerBox.top - y),\n        colors[parsedData[i].colorIndex],\n      )\n      tl.addLabel(\n        labelPos,\n        y + 42,\n        parsedData[i][1],\n      )\n    })\n    const svg = tl.getSVG()\n    timelineContainerRef.current.appendChild(svg)\n    const ins = new Dom2Canvas(tableRef.current, WIDTH, HEIGHT, sanitize.textContent + style.textContent)\n    ins.toCanvas((canvas) => {\n      // presentational style\n      canvas.style.width = '100%'\n      canvas.style.height = 'auto'\n      if (container.current) {\n        clearChildren(container.current)\n        container.current.appendChild(canvas)\n      }\n    }, xml2string(svg))\n    const dom = container.current\n    return function cleanup() {\n      clearChildren(dom)\n    }\n  }, [parsedData, updatedMark, timlineRefs, colors, timelineStartRef, timelineEndRef])\n\n  return (\n    <Box.Relative my=\"2em\">\n      <TableStyle />\n      <BackgroundImage ratio={9 / 16} src=\"/bg.png\">\n        <CanvasContainer ref={container} />\n      </BackgroundImage>\n      <Button my=\"0.5em\" onClick={handleDownload}>下載圖檔</Button>\n      <Box.Absolute\n        opacity={0}\n        height={0}\n        overflow=\"hidden\"\n      >\n        <Box.Relative width={WIDTH} height={HEIGHT} lineHeight=\"1.5\" ref={tableRef}>\n          <table\n            className=\"render-table\"\n            style={{\n              position: 'absolute',\n              top: 60 * 2,\n              left: 32 * 2,\n              right: 48 * 2,\n            }}\n            {...getTableProps()}\n          >\n            <thead>\n              {headerGroups.map((headerGroup, i) => {\n                const hgLength = headerGroup.headers.length\n                return (\n                  <tr {...headerGroup.getHeaderGroupProps()}>\n                    {// Loop over the headers in each row\n                    headerGroup.headers.map((column, j) => {\n                      const { children, colSpan, ...rest } = orginizedHeader[i][j]\n                      if (children === 'T') {\n                        return (\n                          <Box\n                            as=\"th\"\n                            {...column.getHeaderProps()}\n                            colSpan={colSpan}\n                            fontSize=\"16px\"\n                            color=\"primary\"\n                            fontWeight=\"400\"\n                            textAlign=\"left\"\n                            px=\"1em\"\n                          >\n                            Product schedules are subject to change, please contact Winbond sales representative for latest updates.\n                          </Box>\n                        )\n                      }\n                      const isYear = get(column, ['parent', 'Header']) === 'T'\n\n                      return children ? (\n                        <Box\n                          as=\"th\"\n                          {...column.getHeaderProps()}\n                          {...rest}\n                          colSpan={colSpan}\n                          style={{\n                            backgroundImage: i < 1 && `linear-gradient(${theme.colors.primary} ${colSpan > 1 ? 90 : 70}%, rgba(14,78,110,0.5) 95%, transparent 100%)`,\n                          }}\n                          color={i < 1 ? 'white' : 'primary'}\n                          py=\"1em\"\n                          px={i < 1 ? '0.25em' : 0}\n                          fontWeight=\"bold\"\n                          fontSize=\"24px\"\n                          border={`${borderGap}px solid white`}\n                          width={isYear && 64}\n                        >\n                          <Box.Inline\n                            whiteSpace=\"pre\"\n                            style={colSpan > 1 ? {} : rotateStyle}\n                          >\n                            {children}\n                          </Box.Inline>\n                          {j < hgLength - 1\n                            && (\n                              isYear\n                              || (column.depth > 0 && get(headerChildrenIndex, [column.parent.id, column.id]) % 2 === 0)\n                            )\n                            && <DecoLine />}\n                        </Box>\n                      ) : null\n                    })}\n                  </tr>\n                )\n              })}\n            </thead>\n            {/* Apply the table body props */}\n            <tbody {...getTableBodyProps()}>\n              {// Loop over the table rows\n              rows.map((row, i) => {\n                return (\n                  // Apply the row props\n                  <tr {...row.getRowProps()}>\n                    {// Loop over the rows cells\n                    row.cells.map((cell, j) => {\n                      // Apply the cell props\n                      const { children, updated, ...rest } = orginizedRows[i][j]\n                      if (timelinePttn.test(cell.value)) {\n                        let ref\n                        const isFirst = headerChildrenIndex[cell.column.parent.id][cell.column.id] === 0\n                        const isLast = j === row.cells.length - 1\n                        if (timelineStartPttn.test(cell.value)) {\n                          ref = timlineRefs[i].start.ref\n                        } else if (isFirst) {\n                          ref = timlineRefs[i].start.ref\n                        }\n                        if (timelineEndPttn.test(cell.value)) {\n                          ref = ref ? composeRefs(ref, timlineRefs[i].end.ref) : timlineRefs[i].end.ref\n                          timlineRefs[i].end.added = true\n                        }\n                        if (isLast && !timlineRefs[i].end.added) {\n                          ref = timlineRefs[i].end.ref\n                        }\n                        if (i === 0 && isFirst) {\n                          ref = ref ? composeRefs(ref, timelineStartRef) : timelineStartRef\n                        }\n                        if (i === rows.length - 1 && isLast) {\n                          ref = ref ? composeRefs(ref, timelineEndRef) : timelineEndRef\n                        }\n                        return <td {...cell.getCellProps()} {...rest} ref={ref} />\n                      }\n                      return children ? (\n                        <Box\n                          as=\"td\"\n                          {...cell.getCellProps()}\n                          {...rest}\n                          fontSize={j >= groupStart ? '18px' : '20px'}\n                          py={j < groupStart ? '0.5em' : '0.25em'}\n                          whiteSpace=\"pre\"\n                          textAlign=\"center\"\n                          bg=\"gray\"\n                          color={updated ? 'orange' : 'black'}\n                          borderWidth={`${borderLine}px ${borderGap}px`}\n                          borderStyle=\"solid\"\n                          borderColor=\"white\"\n                          lineHeight=\"1.125\"\n                        >\n                          <Box.Inline style={ddrPattn.test(cell.value) ? rotateStyle : null}>\n                            {children}\n                          </Box.Inline>\n                        </Box>\n                      ) : null\n                    })}\n                  </tr>\n                )\n              })}\n            </tbody>\n          </table>\n          <Box\n            position=\"absolute\"\n            top={60}\n            left={64}\n            transform=\"translateY(-50%)\"\n            fontSize=\"54px\"\n            color=\"darkGray\"\n            fontFamily={theme.font}\n            fontWeight=\"bold\"\n          >\n            {parsedData[0][0]}\n          </Box>\n          {notes && notes.length > 0 && (\n            <Flex\n              fontFamily={theme.font}\n              position=\"absolute\"\n              left={64}\n              bottom={24}\n            >\n              <Box\n                bg=\"red\"\n                p=\"1em\"\n                borderRadius=\"0.5em\"\n                mr=\"0.5em\"\n                color=\"white\"\n                fontSize=\"26px\"\n                fontWeight=\"bold\"\n              >NOTE</Box>\n              <Box as=\"ul\" color=\"red\" fontSize=\"20px\" lineHeight=\"1.25\">\n                {notes.map((note, i) => <li key={i}>{note}</li>)}\n              </Box>\n            </Flex>\n          )}\n        </Box.Relative>\n        <div ref={timelineContainerRef} />\n      </Box.Absolute>\n    </Box.Relative>\n  )\n};\n\nexport default RenderTable;\n","import React, { useState, useMemo, useEffect } from 'react'\r\nimport size from 'lodash/size'\r\n\r\nimport Container from '../components/Container'\r\nimport Box from '../components/Box'\r\nimport Flex from '../components/Flex'\r\nimport Text from '../components/Text'\r\nimport Button from '../components/Button'\r\nimport Dropdown from '../components/Dropdown'\r\nimport Pagination from '../components/Pagination'\r\nimport { responsive } from '../components/ThemeProvider/theme';\r\n\r\nimport SheetDataTable from './SheetDataTable'\r\nimport RenderTable from './RenderTable';\r\nimport hookWithLocalStorage from '../utils/hookWithLocalStorage'\r\nimport useMsal from '../contexts/msal/useMsal'\r\n\r\nconst HomePage = () => {\r\n  const {\r\n    account,\r\n    loadSheets,\r\n    loading,\r\n    sheets,\r\n    AuthButton,\r\n    loadSheetData,\r\n    sheetData,\r\n    WorkBookIdInput,\r\n  } = useMsal()\r\n  const [selectedSheet, setSheet] = hookWithLocalStorage('SELECTED_SHEET')(useState)\r\n  const [compareSheet, setCompareSheet] = useState()\r\n  const [selectedRow, setSelectedRow] = useState({})\r\n  const [page, setPage] = useState(0)\r\n  const data = sheetData[selectedSheet]\r\n  const compareSheetData = compareSheet && sheetData[compareSheet]\r\n  const doubleHeader = useMemo(() => data && data.text && data.text[0].some(h => !h), [data])\r\n  const headerRow = useMemo(() => {\r\n    if (!data || !data.text) return []\r\n    if (doubleHeader) {\r\n      const colLength = data.text[0].length\r\n      let groupMemo = []\r\n      // 空白代表要group ['a', 'b', '', 'c']\r\n      // b後面的空白要跟b group一起，所以先反轉陣列，從後面檢查回來，只要是空白，就等到下一個值出現然後把他們group起來\r\n      return data.text[0].slice(0).reverse().reduce((all, h, i) => {\r\n        // 檢查有沒有值\r\n        if (h) {\r\n          // 檢查有沒有之前先標記要變成group的\r\n          if (groupMemo.length) {\r\n            // if true 把現在這一格也加入group\r\n            groupMemo.push(i)\r\n            all.push({\r\n              Header: h,\r\n              columns: groupMemo.slice().reverse().map(j => ({\r\n                Header: data.text[1][colLength - j - 1],\r\n                accessor: d => d[colLength - j - 1],\r\n                id: `${i}-${j}`,\r\n              })),\r\n            })\r\n            // 清空group的標記\r\n            groupMemo = []\r\n          } else {\r\n            // if false 就是一般的header\r\n            all.push({ Header: h, accessor: d => d[colLength - i - 1], id: i })\r\n          }\r\n        } else {\r\n          // 沒有值，之後要跟別人group，先暫存起來\r\n          groupMemo.push(i)\r\n        }\r\n        return all\r\n      }, [])\r\n      .reverse() // 最後記得再反轉回來\r\n      .slice(1) // 然後去掉Title\r\n    }\r\n    return data.text[0].slice(1) // 同樣去掉Title\r\n  }, [data, doubleHeader])\r\n\r\n  const tableData = useMemo(() => (data && data.text) ? data.text.slice(doubleHeader ? 2 : 1) : [], [data, doubleHeader])\r\n  const [pages, pageStart] = useMemo(() => {\r\n    return tableData.reduce(([all, starts], row) => {\r\n      let i = all.length - 1\r\n      if (row[0]) {\r\n        i = all.push([]) - 1\r\n        if (i) {\r\n          starts[i] = all[i - 1].length\r\n        }\r\n      }\r\n      all[i].push(row)\r\n      return [all, starts]\r\n    }, [[], [0]])\r\n  }, [tableData])\r\n\r\n  useEffect(() => {\r\n    if (pages && pages[page]) {\r\n      setSelectedRow(pages[page].reduce((sel, row, id) => {\r\n        sel[id] = true;\r\n        return sel\r\n      }, {}))\r\n    }\r\n  }, [pages, page])\r\n\r\n  const compareData = useMemo(() => (compareSheetData && compareSheetData.text) ? compareSheetData.text.slice(doubleHeader ? 2 : 1) : [], [compareSheetData, doubleHeader])\r\n  const indexedData = useMemo(() => (data && data.text) ? data.text.reduce((all, d, i) => {\r\n    const offset = doubleHeader ? 2 : 1\r\n    if (i >= offset) all[i - offset] = d\r\n    return all\r\n  }, {}) : {}, [data, doubleHeader])\r\n\r\n  const renderValues = useMemo(() => {\r\n    if (!size(selectedRow)) return []\r\n    return Object.entries(selectedRow).map(([i, selected]) => {\r\n      return selected ? indexedData[i * 1 + pageStart[page]] : null\r\n    }).filter(Boolean)\r\n  }, [selectedRow, indexedData, page, pageStart])\r\n\r\n  const updatedMark = useMemo(() => {\r\n    if (!size(compareData)) return null\r\n    const compareMark = compareData.reduce((all, row) => {\r\n      all[row[0]] = row\r\n      return all\r\n    }, {})\r\n    return renderValues.map((row) => {\r\n      const toCompare = compareMark[row[0]]\r\n      if (toCompare) {\r\n        return row.map((r, i) => r !== toCompare[i])\r\n      } else {\r\n        return row.map(() => true)\r\n      }\r\n    })\r\n\r\n  }, [renderValues, compareData])\r\n\r\n  return (\r\n    <Container py={responsive(0, '2em')}>\r\n      {account ? (\r\n        <Box>\r\n          <Flex>\r\n            <WorkBookIdInput flex=\"1\" />\r\n            <Box ml=\"1em\">\r\n              <Button disabled={loading} my=\"1em\" onClick={loadSheets}>載入資料表</Button>\r\n            </Box>\r\n          </Flex>\r\n          {sheets && (\r\n            <>\r\n              <Flex>\r\n                <Dropdown\r\n                  width={1 / 2}\r\n                  label=\"選擇資料表\"\r\n                  onChange={(selected) => {\r\n                    if (selected) {\r\n                      setSheet(selected.value)\r\n                      loadSheetData(selected.value)\r\n                    } else {\r\n                      setSheet()\r\n                    }\r\n                  }}\r\n                  options={sheets.map(sheet => sheet.name)}\r\n                />\r\n                <Dropdown\r\n                  width={1 / 2}\r\n                  label=\"對比資料表\"\r\n                  onChange={(selected) => {\r\n                    if (selected) {\r\n                      setCompareSheet(selected.value)\r\n                      loadSheetData(selected.value)\r\n                    } else {\r\n                      setCompareSheet()\r\n                    }\r\n                  }}\r\n                  options={sheets.map(sheet => sheet.name).filter(name => name !== selectedSheet)}\r\n                  disabled={!selectedSheet}\r\n                />\r\n              </Flex>\r\n              {pages && pages[page] && (\r\n                <>\r\n                  <SheetDataTable\r\n                    data={pages[page]}\r\n                    headerRow={headerRow}\r\n                    onSelectRow={setSelectedRow}\r\n                  />\r\n                  <Pagination\r\n                    pageCount={pages.length}\r\n                    pageRangeDisplayed={5}\r\n                    marginPagesDisplayed={2}\r\n                    onPageChange={({ selected }) => setPage(selected)}\r\n                  />\r\n                  {renderValues.length ? (\r\n                    <RenderTable\r\n                      allData={tableData}\r\n                      data={renderValues}\r\n                      headerRow={headerRow.slice(0, headerRow.length - 2)}\r\n                      updatedMark={updatedMark}\r\n                      page={page}\r\n                    />\r\n                  ) : null}\r\n                </>\r\n              )}\r\n            </>\r\n          )}\r\n        </Box>\r\n      ) : (\r\n        <>\r\n          <Text>請先登入</Text>\r\n          <AuthButton />\r\n        </>\r\n      )}\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default HomePage\r\n","import React, { useContext, useCallback } from 'react'\r\n\r\nimport Button from '../../components/Button'\r\n\r\nimport context from './context'\r\n\r\nexport default () => {\r\n  const { account, signIn, signOut, ...rest } = useContext(context)\r\n  const AuthButton = useCallback(() => (\r\n    <Button onClick={account ? signOut : signIn}>{account ? 'Logout' : 'Login'}</Button>\r\n  ), [account])\r\n  return {\r\n    AuthButton,\r\n    account,\r\n    signIn,\r\n    signOut,\r\n    ...rest,\r\n  }\r\n}\r\n","import React from 'react';\n\nimport HomePage from './containers/HomePage'\n\nfunction App() {\n  return (\n    <HomePage />\n  );\n}\n\nexport default App;\n","import 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ThemeProvider from './components/ThemeProvider'\n// import MediaProvider from './contexts/mediaQuery/MediaProvider'\nimport MsalProvider from './contexts/msal/Provider'\n\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <ThemeProvider>\n    {/* <MediaProvider> */}\n      <MsalProvider>\n        <App />\n      </MsalProvider>\n    {/* </MediaProvider> */}\n  </ThemeProvider>\n, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}