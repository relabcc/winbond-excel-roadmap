{"version":3,"sources":["containers/bg.png","vendor/Blob.js","vendor/canvas-toBlob.js","components/ThemeProvider/theme.js","utils/memorize.js","components/ThemeProvider/global-styles.js","components/ThemeProvider/index.js","utils/hookWithLocalStorage.js","components/utils/injectProps.js","components/utils/isToAs.js","components/Box.js","components/Flex.js","components/utils/asForward.js","components/Text.js","components/Input.js","contexts/msal/context.js","contexts/msal/Provider.js","components/Container.js","components/utils/getColor.js","components/Button.js","components/Dropdown.js","containers/SheetDataTable.js","utils/dom2canvas.js","containers/RenderTable.js","containers/HomePage.js","contexts/msal/useMsal.js","App.js","index.js"],"names":["module","exports","global","window","self","this","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","URL","webkitURL","href","a","document","createElement","origBlob","Blob","createObjectURL","revokeObjectURL","strTag","Symbol","toStringTag","blobSupported","blobSupportsArrayBufferView","arrayBufferSupported","ArrayBuffer","blobBuilderSupported","prototype","append","getBlob","size","Uint8Array","e","mapArrayBufferViews","ary","map","chunk","buffer","buf","byteLength","copy","set","byteOffset","BlobBuilderConstructor","options","bb","forEach","part","type","BlobConstructor","textEncode","TextEncoder","encode","bind","string","pos","len","length","Arr","Array","at","tlen","Math","max","target","value","charCodeAt","extra","update","slice","textDecode","TextDecoder","decode","end","res","i","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","push","str","String","fromCharCode","apply","fixFileAndXHR","isIE","ActiveXObject","documentElement","style","_send","XMLHttpRequest","send","data","setRequestHeader","call","File","klass","Function","b","d","c","blob","t","lastModified","Date","name","replace","lastModifiedDate","toString","bufferClone","view","array","array2base64","input","byteToCharMap","output","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","join","create","Object","viewClasses","isArrayBufferView","isView","obj","indexOf","chunks","opts","_buffer","isPrototypeOf","DataView","offset","l","concatTypedarrays","concat","test","toLowerCase","arrayBuffer","Promise","resolve","text","start","constructor","setPrototypeOf","__proto__","FileReader","TypeError","delegate","createDocumentFragment","addEventListener","dispatchEvent","evt","local","removeEventListener","_read","fr","kind","result","setTimeout","readyState","LOADING","Event","EMPTY","DONE","error","onabort","onerror","onload","onloadend","onloadstart","onprogress","readAsDataURL","readAsText","readAsArrayBuffer","abort","url","FakeBlobBuilder","stream","promisify","reject","Error","ReadableStream","position","autoAllocateChunkSize","pull","controller","v","byobRequest","then","uint8array","bytesRead","respond","close","enqueue","Response","body","getReader","read","base64_ranks","HTMLCanvasElement","canvas_proto","is_base64_regex","to_data_url","decode_base64","base64","rank","code","outptr","last","state","save","undef","toBlob","toBlobHD","callback","mozGetAsFile","msToBlob","args","arguments","dataURI","header_end","substring","is_base64","fake","encoding","decodeURIComponent","toDataURLHD","content","emToPx","em","breakpoints","containerWidth","responsiveIndex","responsiveMap","_","id","findIndex","responsive","fun","cache","key","JSON","stringify","hit","parse","memorize","argsLen","get","colors","white","black","primary","gray","red","blue","font","fontSize","headerHeight","zOrder","range","createGlobalStyle","theme","children","initialVal","devOnly","hook","useLocalStorage","item","setItem","val","setVal","useEffect","injectProps","merge","prop","cssProperty","getConfig","SubComp","forwardRef","ref","is","props","console","as","Box","isToAs","styled","div","withConfig","shouldForwardProp","space","layout","typography","color","zIndex","border","flex","borderRadius","opacity","onClick","displayName","Inline","display","verticalAlign","Absolute","FullAbsolute","top","left","right","bottom","Relative","Flex","flexbox","defaultProps","asForward","forwardedAs","Text","p","Bold","fontWeight","Thin","TextInput","themeGet","textAlign","Input","label","labelWidth","placeholder","disabled","onChange","onBlur","onKeyUp","min","step","alignItems","mr","w","align","mt","createContext","msalConfig","auth","clientId","authority","redirectUri","cacheLocation","storeAuthStateInCookie","graphConfig","sheetName","loginRequest","scopes","myMSALObj","Msal","callMSGraph","endpoint","token","headers","Headers","bearer","method","log","fetch","response","json","catch","getTokenPopup","request","acquireTokenSilent","acquireTokenPopup","tokenResponse","Provider","useState","getAccount","account","setAccount","loading","setLoading","hookWithLocalStorage","workbookUrl","setWorkbookUrl","sheets","setSheets","useImmer","sheetData","setSheetData","workbookId","useMemo","URLSearchParams","search","signIn","useCallback","loginPopup","loginResponse","signOut","logout","loadSheets","accessToken","loadSheetData","draft","WorkBookIdInput","keyCode","context","Container","mx","px","width","maxWidth","customColor","active","css","ButtonBase","button","InButtonSpan","Button","leftIcon","rightIcon","iconSpacing","iconsSize","ml","borderColor","bg","hoverColor","hoverBg","hoverBorder","py","Danger","Secondary","Outline","Transparent","SingleSelect","formattedOptions","opt","defaultValue","isClearable","StyledTable","table","StyledInput","IndeterminateCheckbox","indeterminate","rest","defaultRef","useRef","resolvedRef","current","defaultColumn","Filter","column","filterValue","preFilteredRows","setFilter","count","undefined","canFilter","SheetDataTable","headerRow","onSelectRow","columns","Header","isObject","assign","accessor","tableInstance","useTable","useFilters","useRowSelect","hooks","visibleColumns","getToggleAllRowsSelectedProps","Cell","row","getToggleRowSelectedProps","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","selectedRowIds","overflowX","headerGroup","getHeaderGroupProps","getHeaderProps","render","getRowProps","cells","cell","getCellProps","PIXEL_RATIO","ctx","getContext","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","Dom2Canvas","dom","h","canvas","height","init","clientWidth","clientHeight","ratio","can","setTransform","setHiDPICanvas","backgroundColor","_addBackgroundRect","drawImage","_addNamespace","outerHTML","setAttribute","fillStyle","fillRect","restore","toCanvas","cb","encodeURIComponent","image","Image","that","src","CanvasContainer","bgImg","RenderTable","allData","updatedMark","tableRef","container","notes","reduce","all","note","orginizedHeader","placeHolders","header","j","placeholderOf","x","y","rowSpan","colSpan","totalVisibleHeaderCount","orginizedRows","allRows","thisRow","updated","parentIndex","r","findLastIndex","handleDownload","querySelector","saveAs","ins","innerHTML","appendChild","my","overflow","background","padding","fontFamily","writingMode","textOrientation","transform","whiteSpace","HomePage","useContext","AuthButton","useMsal","selectedSheet","setSheet","compareSheet","setCompareSheet","selectedRow","setSelectedRow","compareSheetData","doubleHeader","some","colLength","groupMemo","reverse","tableData","compareData","indexedData","renderValues","entries","filter","Boolean","compareMark","toCompare","fill","Dropdown","selected","sheet","App","ReactDOM","ThemeProvider","getElementById"],"mappings":"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","file":"static/js/main.6e990ce7.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/bg.df9feb4f.png\";","/* eslint-disable */\r\n/* Blob.js\r\n * A Blob, File, FileReader & URL implementation.\r\n * 2019-04-19\r\n *\r\n * By Eli Grey, http://eligrey.com\r\n * By Jimmy Wärting, https://github.com/jimmywarting\r\n * License: MIT\r\n *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md\r\n */\r\n\r\n;(function () {\r\n  var global = typeof window === 'object'\r\n      ? window : typeof self === 'object'\r\n      ? self : this\r\n\r\n  var BlobBuilder = global.BlobBuilder\r\n    || global.WebKitBlobBuilder\r\n    || global.MSBlobBuilder\r\n    || global.MozBlobBuilder\r\n\r\n  global.URL = global.URL || global.webkitURL || function (href, a) {\r\n  \ta = document.createElement('a')\r\n  \ta.href = href\r\n  \treturn a\r\n  }\r\n\r\n  var origBlob = global.Blob\r\n  var createObjectURL = URL.createObjectURL\r\n  var revokeObjectURL = URL.revokeObjectURL\r\n  var strTag = global.Symbol && global.Symbol.toStringTag\r\n  var blobSupported = false\r\n  var blobSupportsArrayBufferView = false\r\n  var arrayBufferSupported = !!global.ArrayBuffer\r\n  var blobBuilderSupported = BlobBuilder\r\n    && BlobBuilder.prototype.append\r\n    && BlobBuilder.prototype.getBlob\r\n\r\n  try {\r\n    // Check if Blob constructor is supported\r\n    blobSupported = new Blob(['ä']).size === 2\r\n\r\n    // Check if Blob constructor supports ArrayBufferViews\r\n    // Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n    blobSupportsArrayBufferView = new Blob([new Uint8Array([1, 2])]).size === 2\r\n  } catch (e) {}\r\n\r\n  /**\r\n   * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n   * Used by BlobBuilder constructor and old browsers that didn't\r\n   * support it in the Blob constructor.\r\n   */\r\n  function mapArrayBufferViews (ary) {\r\n    return ary.map(function (chunk) {\r\n      if (chunk.buffer instanceof ArrayBuffer) {\r\n        var buf = chunk.buffer\r\n\r\n        // if this is a subarray, make a copy so we only\r\n        // include the subarray region from the underlying buffer\r\n        if (chunk.byteLength !== buf.byteLength) {\r\n          var copy = new Uint8Array(chunk.byteLength)\r\n          copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength))\r\n          buf = copy.buffer\r\n        }\r\n\r\n        return buf\r\n      }\r\n\r\n      return chunk\r\n    })\r\n  }\r\n\r\n  function BlobBuilderConstructor (ary, options) {\r\n    options = options || {}\r\n\r\n    var bb = new BlobBuilder()\r\n    mapArrayBufferViews(ary).forEach(function (part) {\r\n      bb.append(part)\r\n    })\r\n\r\n    return options.type ? bb.getBlob(options.type) : bb.getBlob()\r\n  }\r\n\r\n  function BlobConstructor (ary, options) {\r\n    return new origBlob(mapArrayBufferViews(ary), options || {})\r\n  }\r\n\r\n  if (global.Blob) {\r\n    BlobBuilderConstructor.prototype = Blob.prototype\r\n    BlobConstructor.prototype = Blob.prototype\r\n  }\r\n\r\n\r\n\r\n  /********************************************************/\r\n  /*               String Encoder fallback                */\r\n  /********************************************************/\r\n  function stringEncode (string) {\r\n    var pos = 0\r\n    var len = string.length\r\n    var Arr = global.Uint8Array || Array // Use byte array when possible\r\n\r\n    var at = 0  // output position\r\n    var tlen = Math.max(32, len + (len >> 1) + 7)  // 1.5x size\r\n    var target = new Arr((tlen >> 3) << 3)  // ... but at 8 byte offset\r\n\r\n    while (pos < len) {\r\n      var value = string.charCodeAt(pos++)\r\n      if (value >= 0xd800 && value <= 0xdbff) {\r\n        // high surrogate\r\n        if (pos < len) {\r\n          var extra = string.charCodeAt(pos)\r\n          if ((extra & 0xfc00) === 0xdc00) {\r\n            ++pos\r\n            value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000\r\n          }\r\n        }\r\n        if (value >= 0xd800 && value <= 0xdbff) {\r\n          continue  // drop lone surrogate\r\n        }\r\n      }\r\n\r\n      // expand the buffer if we couldn't write 4 bytes\r\n      if (at + 4 > target.length) {\r\n        tlen += 8  // minimum extra\r\n        tlen *= (1.0 + (pos / string.length) * 2)  // take 2x the remaining\r\n        tlen = (tlen >> 3) << 3  // 8 byte offset\r\n\r\n        var update = new Uint8Array(tlen)\r\n        update.set(target)\r\n        target = update\r\n      }\r\n\r\n      if ((value & 0xffffff80) === 0) {  // 1-byte\r\n        target[at++] = value  // ASCII\r\n        continue\r\n      } else if ((value & 0xfffff800) === 0) {  // 2-byte\r\n        target[at++] = ((value >> 6) & 0x1f) | 0xc0\r\n      } else if ((value & 0xffff0000) === 0) {  // 3-byte\r\n        target[at++] = ((value >> 12) & 0x0f) | 0xe0\r\n        target[at++] = ((value >> 6) & 0x3f) | 0x80\r\n      } else if ((value & 0xffe00000) === 0) {  // 4-byte\r\n        target[at++] = ((value >> 18) & 0x07) | 0xf0\r\n        target[at++] = ((value >> 12) & 0x3f) | 0x80\r\n        target[at++] = ((value >> 6) & 0x3f) | 0x80\r\n      } else {\r\n        // FIXME: do we care\r\n        continue\r\n      }\r\n\r\n      target[at++] = (value & 0x3f) | 0x80\r\n    }\r\n\r\n    return target.slice(0, at)\r\n  }\r\n\r\n  /********************************************************/\r\n  /*               String Decoder fallback                */\r\n  /********************************************************/\r\n  function stringDecode (buf) {\r\n    var end = buf.length\r\n    var res = []\r\n\r\n    var i = 0\r\n    while (i < end) {\r\n      var firstByte = buf[i]\r\n      var codePoint = null\r\n      var bytesPerSequence = (firstByte > 0xEF) ? 4\r\n        : (firstByte > 0xDF) ? 3\r\n          : (firstByte > 0xBF) ? 2\r\n            : 1\r\n\r\n      if (i + bytesPerSequence <= end) {\r\n        var secondByte, thirdByte, fourthByte, tempCodePoint\r\n\r\n        switch (bytesPerSequence) {\r\n          case 1:\r\n            if (firstByte < 0x80) {\r\n              codePoint = firstByte\r\n            }\r\n            break\r\n          case 2:\r\n            secondByte = buf[i + 1]\r\n            if ((secondByte & 0xC0) === 0x80) {\r\n              tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\r\n              if (tempCodePoint > 0x7F) {\r\n                codePoint = tempCodePoint\r\n              }\r\n            }\r\n            break\r\n          case 3:\r\n            secondByte = buf[i + 1]\r\n            thirdByte = buf[i + 2]\r\n            if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\r\n              tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\r\n              if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\r\n                codePoint = tempCodePoint\r\n              }\r\n            }\r\n            break\r\n          case 4:\r\n            secondByte = buf[i + 1]\r\n            thirdByte = buf[i + 2]\r\n            fourthByte = buf[i + 3]\r\n            if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\r\n              tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\r\n              if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\r\n                codePoint = tempCodePoint\r\n              }\r\n            }\r\n        }\r\n      }\r\n\r\n      if (codePoint === null) {\r\n        // we did not generate a valid codePoint so insert a\r\n        // replacement char (U+FFFD) and advance only 1 byte\r\n        codePoint = 0xFFFD\r\n        bytesPerSequence = 1\r\n      } else if (codePoint > 0xFFFF) {\r\n        // encode to utf16 (surrogate pair dance)\r\n        codePoint -= 0x10000\r\n        res.push(codePoint >>> 10 & 0x3FF | 0xD800)\r\n        codePoint = 0xDC00 | codePoint & 0x3FF\r\n      }\r\n\r\n      res.push(codePoint)\r\n      i += bytesPerSequence\r\n    }\r\n\r\n    var len = res.length\r\n    var str = ''\r\n    var i = 0\r\n\r\n    while (i < len) {\r\n      str += String.fromCharCode.apply(String, res.slice(i, i += 0x1000))\r\n    }\r\n\r\n    return str\r\n  }\r\n\r\n  // string -> buffer\r\n  var textEncode = typeof TextEncoder === 'function'\r\n    ? TextEncoder.prototype.encode.bind(new TextEncoder())\r\n    : stringEncode\r\n\r\n  // buffer -> string\r\n  var textDecode = typeof TextDecoder === 'function'\r\n    ? TextDecoder.prototype.decode.bind(new TextDecoder())\r\n    : stringDecode\r\n\r\n  function FakeBlobBuilder () {\r\n    function isDataView (obj) {\r\n      return obj && DataView.prototype.isPrototypeOf(obj)\r\n    }\r\n    function bufferClone (buf) {\r\n      var view = new Array(buf.byteLength)\r\n      var array = new Uint8Array(buf)\r\n      var i = view.length\r\n      while (i--) {\r\n        view[i] = array[i]\r\n      }\r\n      return view\r\n    }\r\n    function array2base64 (input) {\r\n      var byteToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\r\n\r\n      var output = []\r\n\r\n      for (var i = 0; i < input.length; i += 3) {\r\n        var byte1 = input[i]\r\n        var haveByte2 = i + 1 < input.length\r\n        var byte2 = haveByte2 ? input[i + 1] : 0\r\n        var haveByte3 = i + 2 < input.length\r\n        var byte3 = haveByte3 ? input[i + 2] : 0\r\n\r\n        var outByte1 = byte1 >> 2\r\n        var outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4)\r\n        var outByte3 = ((byte2 & 0x0F) << 2) | (byte3 >> 6)\r\n        var outByte4 = byte3 & 0x3F\r\n\r\n        if (!haveByte3) {\r\n          outByte4 = 64\r\n\r\n          if (!haveByte2) {\r\n            outByte3 = 64\r\n          }\r\n        }\r\n\r\n        output.push(\r\n          byteToCharMap[outByte1], byteToCharMap[outByte2],\r\n          byteToCharMap[outByte3], byteToCharMap[outByte4]\r\n        )\r\n      }\r\n\r\n      return output.join('')\r\n    }\r\n\r\n    var create = Object.create || function (a) {\r\n      function c () {}\r\n      c.prototype = a\r\n      return new c()\r\n    }\r\n\r\n    if (arrayBufferSupported) {\r\n      var viewClasses = [\r\n        '[object Int8Array]',\r\n        '[object Uint8Array]',\r\n        '[object Uint8ClampedArray]',\r\n        '[object Int16Array]',\r\n        '[object Uint16Array]',\r\n        '[object Int32Array]',\r\n        '[object Uint32Array]',\r\n        '[object Float32Array]',\r\n        '[object Float64Array]'\r\n      ]\r\n\r\n      var isArrayBufferView = ArrayBuffer.isView || function (obj) {\r\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\r\n      }\r\n    }\r\n\r\n    function concatTypedarrays (chunks) {\r\n      var size = 0\r\n      var i = chunks.length\r\n      while (i--) { size += chunks[i].length }\r\n      var b = new Uint8Array(size)\r\n      var offset = 0\r\n      for (i = 0, l = chunks.length; i < l; i++) {\r\n        var chunk = chunks[i]\r\n        b.set(chunk, offset)\r\n        offset += chunk.byteLength || chunk.length\r\n      }\r\n\r\n      return b\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                   Blob constructor                   */\r\n    /********************************************************/\r\n    function Blob (chunks, opts) {\r\n      chunks = chunks || []\r\n      opts = opts == null ? {} : opts\r\n      for (var i = 0, len = chunks.length; i < len; i++) {\r\n        var chunk = chunks[i]\r\n        if (chunk instanceof Blob) {\r\n          chunks[i] = chunk._buffer\r\n        } else if (typeof chunk === 'string') {\r\n          chunks[i] = textEncode(chunk)\r\n        } else if (arrayBufferSupported && (ArrayBuffer.prototype.isPrototypeOf(chunk) || isArrayBufferView(chunk))) {\r\n          chunks[i] = bufferClone(chunk)\r\n        } else if (arrayBufferSupported && isDataView(chunk)) {\r\n          chunks[i] = bufferClone(chunk.buffer)\r\n        } else {\r\n          chunks[i] = textEncode(String(chunk))\r\n        }\r\n      }\r\n\r\n      this._buffer = global.Uint8Array\r\n        ? concatTypedarrays(chunks)\r\n        : [].concat.apply([], chunks)\r\n      this.size = this._buffer.length\r\n\r\n      this.type = opts.type || ''\r\n      if (/[^\\u0020-\\u007E]/.test(this.type)) {\r\n        this.type = ''\r\n      } else {\r\n        this.type = this.type.toLowerCase()\r\n      }\r\n    }\r\n\r\n    Blob.prototype.arrayBuffer = function () {\r\n      return Promise.resolve(this._buffer)\r\n    }\r\n\r\n    Blob.prototype.text = function () {\r\n      return Promise.resolve(textDecode(this._buffer))\r\n    }\r\n\r\n    Blob.prototype.slice = function (start, end, type) {\r\n      var slice = this._buffer.slice(start || 0, end || this._buffer.length)\r\n      return new Blob([slice], {type: type})\r\n    }\r\n\r\n    Blob.prototype.toString = function () {\r\n      return '[object Blob]'\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                   File constructor                   */\r\n    /********************************************************/\r\n    function File (chunks, name, opts) {\r\n      opts = opts || {}\r\n      var a = Blob.call(this, chunks, opts) || this\r\n      a.name = name.replace(/\\//g, ':')\r\n      a.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date()\r\n      a.lastModified = +a.lastModifiedDate\r\n\r\n      return a\r\n    }\r\n\r\n    File.prototype = create(Blob.prototype)\r\n    File.prototype.constructor = File\r\n\r\n    if (Object.setPrototypeOf) {\r\n      Object.setPrototypeOf(File, Blob)\r\n    } else {\r\n      try { File.__proto__ = Blob } catch (e) {}\r\n    }\r\n\r\n    File.prototype.toString = function () {\r\n      return '[object File]'\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                FileReader constructor                */\r\n    /********************************************************/\r\n    function FileReader () {\r\n    \tif (!(this instanceof FileReader)) {\r\n        throw new TypeError(\"Failed to construct 'FileReader': Please use the 'new' operator, this DOM object constructor cannot be called as a function.\")\r\n      }\r\n\r\n    \tvar delegate = document.createDocumentFragment()\r\n    \tthis.addEventListener = delegate.addEventListener\r\n    \tthis.dispatchEvent = function (evt) {\r\n    \t\tvar local = this['on' + evt.type]\r\n    \t\tif (typeof local === 'function') local(evt)\r\n    \t\tdelegate.dispatchEvent(evt)\r\n    \t}\r\n    \tthis.removeEventListener = delegate.removeEventListener\r\n    }\r\n\r\n    function _read (fr, blob, kind) {\r\n    \tif (!(blob instanceof Blob)) {\r\n        throw new TypeError(\"Failed to execute '\" + kind + \"' on 'FileReader': parameter 1 is not of type 'Blob'.\")\r\n      }\r\n\r\n    \tfr.result = ''\r\n\r\n    \tsetTimeout(function () {\r\n    \t\tthis.readyState = FileReader.LOADING\r\n    \t\tfr.dispatchEvent(new Event('load'))\r\n    \t\tfr.dispatchEvent(new Event('loadend'))\r\n    \t})\r\n    }\r\n\r\n    FileReader.EMPTY = 0\r\n    FileReader.LOADING = 1\r\n    FileReader.DONE = 2\r\n    FileReader.prototype.error = null\r\n    FileReader.prototype.onabort = null\r\n    FileReader.prototype.onerror = null\r\n    FileReader.prototype.onload = null\r\n    FileReader.prototype.onloadend = null\r\n    FileReader.prototype.onloadstart = null\r\n    FileReader.prototype.onprogress = null\r\n\r\n    FileReader.prototype.readAsDataURL = function (blob) {\r\n    \t_read(this, blob, 'readAsDataURL')\r\n    \tthis.result = 'data:' + blob.type + ';base64,' + array2base64(blob._buffer)\r\n    }\r\n\r\n    FileReader.prototype.readAsText = function (blob) {\r\n    \t_read(this, blob, 'readAsText')\r\n    \tthis.result = textDecode(blob._buffer)\r\n    }\r\n\r\n    FileReader.prototype.readAsArrayBuffer = function (blob) {\r\n      _read(this, blob, 'readAsText')\r\n       // return ArrayBuffer when possible\r\n      this.result = (blob._buffer.buffer || blob._buffer).slice()\r\n    }\r\n\r\n    FileReader.prototype.abort = function () {}\r\n\r\n    /********************************************************/\r\n    /*                         URL                          */\r\n    /********************************************************/\r\n    URL.createObjectURL = function (blob) {\r\n      return blob instanceof Blob\r\n        ? 'data:' + blob.type + ';base64,' + array2base64(blob._buffer)\r\n        : createObjectURL.call(URL, blob)\r\n    }\r\n\r\n    URL.revokeObjectURL = function (url) {\r\n      revokeObjectURL && revokeObjectURL.call(URL, url)\r\n    }\r\n\r\n    /********************************************************/\r\n    /*                         XHR                          */\r\n    /********************************************************/\r\n    var _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send\r\n    if (_send) {\r\n      XMLHttpRequest.prototype.send = function (data) {\r\n        if (data instanceof Blob) {\r\n          this.setRequestHeader('Content-Type', data.type)\r\n          _send.call(this, textDecode(data._buffer))\r\n        } else {\r\n          _send.call(this, data)\r\n        }\r\n      }\r\n    }\r\n\r\n    global.FileReader = FileReader\r\n    global.File = File\r\n    global.Blob = Blob\r\n  }\r\n\r\n  function fixFileAndXHR () {\r\n    var isIE = !!global.ActiveXObject || (\r\n      '-ms-scroll-limit' in document.documentElement.style &&\r\n      '-ms-ime-align' in document.documentElement.style\r\n    )\r\n\r\n    // Monkey patched\r\n    // IE don't set Content-Type header on XHR whose body is a typed Blob\r\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/6047383\r\n    var _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send\r\n    if (isIE && _send) {\r\n      XMLHttpRequest.prototype.send = function (data) {\r\n        if (data instanceof Blob) {\r\n          this.setRequestHeader('Content-Type', data.type)\r\n          _send.call(this, data)\r\n        } else {\r\n          _send.call(this, data)\r\n        }\r\n      }\r\n    }\r\n\r\n    try {\r\n      new File([], '')\r\n    } catch (e) {\r\n      try {\r\n        var klass = new Function('class File extends Blob {' +\r\n          'constructor(chunks, name, opts) {' +\r\n            'opts = opts || {};' +\r\n            'super(chunks, opts || {});' +\r\n            'this.name = name.replace(/\\//g, \":\");' +\r\n            'this.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();' +\r\n            'this.lastModified = +this.lastModifiedDate;' +\r\n          '}};' +\r\n          'return new File([], \"\"), File'\r\n        )()\r\n        global.File = klass\r\n      } catch (e) {\r\n        var klass = function (b, d, c) {\r\n          var blob = new Blob(b, c)\r\n          var t = c && void 0 !== c.lastModified ? new Date(c.lastModified) : new Date()\r\n\r\n          blob.name = d.replace(/\\//g, ':')\r\n          blob.lastModifiedDate = t\r\n          blob.lastModified = +t\r\n          blob.toString = function () {\r\n            return '[object File]'\r\n          }\r\n\r\n          if (strTag) {\r\n            blob[strTag] = 'File'\r\n          }\r\n\r\n          return blob\r\n        }\r\n        global.File = klass\r\n      }\r\n    }\r\n  }\r\n\r\n  if (blobSupported) {\r\n    fixFileAndXHR()\r\n    global.Blob = blobSupportsArrayBufferView ? global.Blob : BlobConstructor\r\n  } else if (blobBuilderSupported) {\r\n    fixFileAndXHR()\r\n    global.Blob = BlobBuilderConstructor\r\n  } else {\r\n    FakeBlobBuilder()\r\n  }\r\n\r\n  if (strTag) {\r\n    File.prototype[strTag] = 'File'\r\n    Blob.prototype[strTag] = 'Blob'\r\n    FileReader.prototype[strTag] = 'FileReader'\r\n  }\r\n\r\n  var blob = global.Blob.prototype\r\n  var stream\r\n\r\n  function promisify(obj) {\r\n    return new Promise(function(resolve, reject) {\r\n      obj.onload =\r\n      obj.onerror = function(evt) {\r\n        obj.onload =\r\n        obj.onerror = null\r\n\r\n        evt.type === 'load'\r\n          ? resolve(obj.result || obj)\r\n          : reject(new Error('Failed to read the blob/file'))\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  try {\r\n    new ReadableStream({ type: 'bytes' })\r\n    stream = function stream() {\r\n      var position = 0\r\n      var blob = this\r\n\r\n      return new ReadableStream({\r\n        type: 'bytes',\r\n        autoAllocateChunkSize: 524288,\r\n\r\n        pull: function (controller) {\r\n          var v = controller.byobRequest.view\r\n          var chunk = blob.slice(position, position + v.byteLength)\r\n          return chunk.arrayBuffer()\r\n          .then(function (buffer) {\r\n            var uint8array = new Uint8Array(buffer)\r\n            var bytesRead = uint8array.byteLength\r\n\r\n            position += bytesRead\r\n            v.set(uint8array)\r\n              controller.byobRequest.respond(bytesRead)\r\n\r\n            if(position >= blob.size)\r\n              controller.close()\r\n          })\r\n        }\r\n      })\r\n    }\r\n  } catch (e) {\r\n    try {\r\n      new ReadableStream({})\r\n      stream = function stream(blob){\r\n        var position = 0\r\n        var blob = this\r\n\r\n        return new ReadableStream({\r\n          pull: function (controller) {\r\n            var chunk = blob.slice(position, position + 524288)\r\n\r\n            return chunk.arrayBuffer().then(function (buffer) {\r\n              position += buffer.byteLength\r\n              var uint8array = new Uint8Array(buffer)\r\n              controller.enqueue(uint8array)\r\n\r\n              if (position == blob.size)\r\n                controller.close()\r\n            })\r\n          }\r\n        })\r\n      }\r\n    } catch (e) {\r\n      try {\r\n        new Response('').body.getReader().read()\r\n        stream = function stream() {\r\n          return (new Response(this)).body\r\n        }\r\n      } catch (e) {\r\n        stream = function stream() {\r\n          throw new Error('Include https://github.com/MattiasBuelens/web-streams-polyfill')\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  if (!blob.arrayBuffer) {\r\n    blob.arrayBuffer = function arrayBuffer() {\r\n      var fr = new FileReader()\r\n      fr.readAsArrayBuffer(this)\r\n      return promisify(fr)\r\n    }\r\n  }\r\n\r\n  if (!blob.text) {\r\n    blob.text = function text() {\r\n      var fr = new FileReader()\r\n      fr.readAsText(this)\r\n      return promisify(fr)\r\n    }\r\n  }\r\n\r\n  if (!blob.stream) {\r\n    blob.stream = stream\r\n  }\r\n})()\r\n","/* eslint-disable */\r\n/* canvas-toBlob.js\r\n * A canvas.toBlob() implementation.\r\n * 2016-05-26\r\n *\r\n * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr\r\n * License: MIT\r\n *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md\r\n */\r\n\r\n/*global self */\r\n/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\r\n  plusplus: true */\r\n\r\n/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */\r\n\r\n(function(view) {\r\n\"use strict\";\r\nvar\r\n\t  Uint8Array = view.Uint8Array\r\n\t, HTMLCanvasElement = view.HTMLCanvasElement\r\n\t, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype\r\n\t, is_base64_regex = /\\s*;\\s*base64\\s*(?:;|$)/i\r\n\t, to_data_url = \"toDataURL\"\r\n\t, base64_ranks\r\n\t, decode_base64 = function(base64) {\r\n\t\tvar\r\n\t\t\t  len = base64.length\r\n\t\t\t, buffer = new Uint8Array(len / 4 * 3 | 0)\r\n\t\t\t, i = 0\r\n\t\t\t, outptr = 0\r\n\t\t\t, last = [0, 0]\r\n\t\t\t, state = 0\r\n\t\t\t, save = 0\r\n\t\t\t, rank\r\n\t\t\t, code\r\n\t\t\t, undef\r\n\t\t;\r\n\t\twhile (len--) {\r\n\t\t\tcode = base64.charCodeAt(i++);\r\n\t\t\trank = base64_ranks[code-43];\r\n\t\t\tif (rank !== 255 && rank !== undef) {\r\n\t\t\t\tlast[1] = last[0];\r\n\t\t\t\tlast[0] = code;\r\n\t\t\t\tsave = (save << 6) | rank;\r\n\t\t\t\tstate++;\r\n\t\t\t\tif (state === 4) {\r\n\t\t\t\t\tbuffer[outptr++] = save >>> 16;\r\n\t\t\t\t\tif (last[1] !== 61 /* padding character */) {\r\n\t\t\t\t\t\tbuffer[outptr++] = save >>> 8;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (last[0] !== 61 /* padding character */) {\r\n\t\t\t\t\t\tbuffer[outptr++] = save;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 2/3 chance there's going to be some null bytes at the end, but that\r\n\t\t// doesn't really matter with most image formats.\r\n\t\t// If it somehow matters for you, truncate the buffer up outptr.\r\n\t\treturn buffer;\r\n\t}\r\n;\r\nif (Uint8Array) {\r\n\tbase64_ranks = new Uint8Array([\r\n\t\t  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1\r\n\t\t, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9\r\n\t\t, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25\r\n\t\t, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35\r\n\t\t, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51\r\n\t]);\r\n}\r\nif (HTMLCanvasElement && (!canvas_proto.toBlob || !canvas_proto.toBlobHD)) {\r\n\tif (!canvas_proto.toBlob)\r\n\tcanvas_proto.toBlob = function(callback, type /*, ...args*/) {\r\n\t\t  if (!type) {\r\n\t\t\ttype = \"image/png\";\r\n\t\t} if (this.mozGetAsFile) {\r\n\t\t\tcallback(this.mozGetAsFile(\"canvas\", type));\r\n\t\t\treturn;\r\n\t\t} if (this.msToBlob && /^\\s*image\\/png\\s*(?:$|;)/i.test(type)) {\r\n\t\t\tcallback(this.msToBlob());\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar\r\n\t\t\t  args = Array.prototype.slice.call(arguments, 1)\r\n\t\t\t, dataURI = this[to_data_url].apply(this, args)\r\n\t\t\t, header_end = dataURI.indexOf(\",\")\r\n\t\t\t, data = dataURI.substring(header_end + 1)\r\n\t\t\t, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))\r\n\t\t\t, blob\r\n\t\t;\r\n\t\tif (Blob.fake) {\r\n\t\t\t// no reason to decode a data: URI that's just going to become a data URI again\r\n\t\t\tblob = new Blob\r\n\t\t\tif (is_base64) {\r\n\t\t\t\tblob.encoding = \"base64\";\r\n\t\t\t} else {\r\n\t\t\t\tblob.encoding = \"URI\";\r\n\t\t\t}\r\n\t\t\tblob.data = data;\r\n\t\t\tblob.size = data.length;\r\n\t\t} else if (Uint8Array) {\r\n\t\t\tif (is_base64) {\r\n\t\t\t\tblob = new Blob([decode_base64(data)], {type: type});\r\n\t\t\t} else {\r\n\t\t\t\tblob = new Blob([decodeURIComponent(data)], {type: type});\r\n\t\t\t}\r\n\t\t}\r\n\t\tcallback(blob);\r\n\t};\r\n\r\n\tif (!canvas_proto.toBlobHD && canvas_proto.toDataURLHD) {\r\n\t\tcanvas_proto.toBlobHD = function() {\r\n\t\t\tto_data_url = \"toDataURLHD\";\r\n\t\t\tvar blob = this.toBlob();\r\n\t\t\tto_data_url = \"toDataURL\";\r\n\t\t\treturn blob;\r\n\t\t}\r\n\t} else {\r\n\t\tcanvas_proto.toBlobHD = canvas_proto.toBlob;\r\n\t}\r\n}\r\n}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this));\r\n","import range from 'lodash/range';\r\nimport get from 'lodash/get';\r\n\r\nimport memorize from '../../utils/memorize'\r\n\r\nconst baseFontSize = 16\r\nconst emToPx = (em) => `${em * baseFontSize}px`;\r\n\r\nexport const breakpoints = [22, 36, 48, 62, 90, 120].map(emToPx);\r\nexport const containerWidth = [22, 36, 46, 58, 86].map(emToPx);\r\nexport const responsiveIndex = [\r\n  [3, 'mobile'],\r\n  [4, 'tablet'],\r\n]\r\n\r\nconst responsiveMap = breakpoints.map((_, i) => {\r\n  const id = responsiveIndex.findIndex(([ri]) => ri > i)\r\n  return id >= 0 ? id : responsiveIndex.length\r\n})\r\n\r\nexport const responsive = memorize((...args) => {\r\n  const argsLen = args.length\r\n  if (argsLen <= 1) return args[0]\r\n  return breakpoints.map((_, i) => get(args, [responsiveMap[i]], null))\r\n});\r\n\r\nexport const mobileOrDesktop = responsive\r\n\r\nconst font = 'Arial, \"PingFang TC\", \"HeiTi TC\", \"Microsoft JhengHei\", sans-serif';\r\n\r\nconst white = '#fff';\r\nconst black = '#000';\r\nconst red = '#D6262F'\r\nconst gray = '#E1E1E1'\r\nconst blue = '#0E4E6E'\r\nconst primary = blue\r\n\r\nexport default {\r\n  colors: {\r\n    white,\r\n    black,\r\n    text: black,\r\n    primary,\r\n    gray,\r\n    red,\r\n    blue,\r\n  },\r\n  breakpoints,\r\n  containerWidth,\r\n  font,\r\n  fontSize: `${baseFontSize}px`,\r\n  headerHeight: '5em',\r\n  responsive,\r\n  zOrder: range(4).map((i) => 10 ** i),\r\n};\r\n","// memorization for performance; don't use this for mutable function\r\nexport default function(fun) {\r\n  const cache = {};\r\n\r\n  return function(...args){\r\n    const key = JSON.stringify(args);\r\n\r\n    // fetch\r\n    let hit = cache[key];\r\n    if (typeof hit !== 'undefined') {\r\n      return typeof hit === 'object' && hit !== null\r\n        ? JSON.parse(JSON.stringify(hit))\r\n        : hit\r\n    }\r\n\r\n    // put\r\n    let result = fun.apply(this, args);\r\n    cache[key] = result;\r\n    setTimeout(() => { delete cache[key]; }, 60 * 60 * 1000); // ttl is 1 hour\r\n\r\n    return typeof result === 'object' && result !== null\r\n      ? JSON.parse(JSON.stringify(result))\r\n      : result\r\n  }\r\n}\r\n","import { createGlobalStyle } from 'styled-components';\r\n\r\nimport theme from './theme';\r\n\r\nexport default createGlobalStyle`\r\n  body {\r\n    font-family: ${theme.font};\r\n    font-size: ${theme.fontSize};\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n  }\r\n`;\r\n","import React, { Fragment } from 'react';\r\nimport { ThemeProvider } from 'styled-components';\r\nimport 'sanitize.css';\r\n\r\nimport GlobalStyles from './global-styles';\r\n\r\nimport theme from './theme';\r\n\r\nexport default ({ children }) => (\r\n  <ThemeProvider theme={theme}>\r\n    <Fragment>\r\n      {children}\r\n      <GlobalStyles />\r\n    </Fragment>\r\n  </ThemeProvider>\r\n);\r\n","import { useEffect } from 'react'\r\nimport useLocalStorage from 'react-use-localstorage';\r\n\r\nexport default (name, initialVal, devOnly) => hook => {\r\n  if (devOnly && process.env.NODE_ENV !== 'development') {\r\n    return hook(initialVal)\r\n  }\r\n  const [item, setItem] = useLocalStorage(name, JSON.stringify(initialVal));\r\n  const [val, setVal] = hook(item && JSON.parse(item))\r\n\r\n  useEffect(() => {\r\n    setItem(JSON.stringify(val))\r\n  }, [val])\r\n\r\n  return [val, setVal]\r\n}\r\n","import merge from 'lodash/merge';\r\nimport { style } from 'styled-system';\r\n\r\nconst getConfig = (key, options) => merge({\r\n  prop: key,\r\n  cssProperty: key,\r\n}, options);\r\n\r\nconst injectProps = (key, options) => style(getConfig(key, options));\r\n\r\nexport default injectProps;\r\n","import React, { forwardRef } from 'react'\r\n\r\nexport default SubComp => forwardRef(({ is, ...props }, ref) => {\r\n  if (is) {\r\n    console.error('\"is\" is no longer supported, us \"as\" instead')\r\n  }\r\n  return <SubComp as={is} ref={ref} {...props} />\r\n})\r\n","import React, { forwardRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport shouldForwardProp from '@styled-system/should-forward-prop'\r\nimport {\r\n  space,\r\n  layout,\r\n  typography,\r\n  position,\r\n  color,\r\n  borderRadius,\r\n  zIndex,\r\n  border,\r\n  flex,\r\n  opacity,\r\n  style,\r\n} from 'styled-system';\r\n\r\nimport injectProps from './utils/injectProps';\r\nimport isToAs from './utils/isToAs'\r\n\r\nconst Box = isToAs(styled.div.withConfig({ shouldForwardProp })`\r\n  ${space}\r\n  ${layout}\r\n  ${position}\r\n  ${typography}\r\n  ${color}\r\n  ${position}\r\n  ${zIndex}\r\n  ${border}\r\n  ${flex}\r\n  ${borderRadius}\r\n  ${opacity}\r\n  ${injectProps('whiteSpace')}\r\n  ${injectProps('overflow')}\r\n  ${injectProps('transform')}\r\n  ${injectProps('transition')}\r\n  ${style({\r\n    prop: 'zOrder',\r\n    cssProperty: 'zIndex',\r\n    key: 'zOrder',\r\n  })}\r\n  ${({ onClick }) => onClick && 'cursor: pointer;'}\r\n`);\r\n\r\nBox.displayName = 'Box';\r\n\r\nBox.Inline = forwardRef((props, ref) => <Box ref={ref} as=\"span\" display=\"inline-block\" verticalAlign=\"middle\" {...props} />);\r\nBox.Absolute = forwardRef((props, ref) => <Box ref={ref} position=\"absolute\" {...props} />);\r\nBox.FullAbsolute = forwardRef((props, ref) => <Box.Absolute ref={ref} top=\"0\" left=\"0\" right=\"0\" bottom=\"0\" {...props} />);\r\nBox.Relative = forwardRef((props, ref) => <Box ref={ref} position=\"relative\" {...props} />);\r\n\r\nexport default Box;\r\n","import { flexbox } from 'styled-system';\r\nimport styled from 'styled-components';\r\n\r\nimport Box from './Box';\r\n\r\nimport asForward from './utils/asForward'\r\n\r\nconst Flex = styled(Box)`\r\n  ${flexbox}\r\n`;\r\n\r\nFlex.defaultProps = {\r\n  display: 'flex',\r\n};\r\n\r\nFlex.displayName = 'Flex';\r\n\r\nexport default asForward(Flex);\r\n","import React from 'react'\r\n\r\nexport default SubComp => ({ as, ...props }) => {\r\n  return <SubComp forwardedAs={as} {...props} />\r\n}\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport range from 'lodash/range';\r\nimport {\r\n  typography,\r\n  space,\r\n  color,\r\n  display,\r\n  position,\r\n} from 'styled-system';\r\nimport shouldForwardProp from '@styled-system/should-forward-prop'\r\n\r\nimport injectProps from './utils/injectProps';\r\nimport isToAs from './utils/isToAs'\r\n\r\nconst Text = isToAs(styled.p.withConfig({ shouldForwardProp })`\r\n  margin-top: 0;\r\n  margin-bottom: 0;\r\n  ${typography}\r\n  ${display}\r\n  ${space}\r\n  ${color}\r\n  ${position}\r\n  ${injectProps('textTransform')}\r\n`);\r\n\r\nText.defaultProps = {\r\n  fontSize: '1em',\r\n  // lineHeight: 1.5,\r\n};\r\n\r\nText.Inline = (props) => <Text as=\"span\" {...props} />;\r\nText.Bold = (props) => <Text fontWeight=\"bold\" {...props} />;\r\nText.Thin = (props) => <Text fontWeight=\"200\" {...props} />;\r\n\r\nrange(1, 7).forEach((key) => {\r\n  Text[`H${key}`] = (props) => (\r\n    <Text\r\n      as={`h${key}`}\r\n      fontSize={`${1 + ((6 - key) * 0.125)}em`}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n\r\nText.displayName = 'Text';\r\n\r\nexport default Text;\r\n","import React, { createElement } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport styled from 'styled-components';\r\nimport { textAlign } from 'styled-system';\r\nimport themeGet from '@styled-system/theme-get';\r\n\r\nimport Flex from './Flex';\r\nimport Box from './Box';\r\nimport Text from './Text';\r\n\r\nconst TextInput = styled.input`\r\n  font-family: inherit;\r\n  width: 100%;\r\n  padding: 0.25em;\r\n  border: 1px solid ${themeGet('colors.gray')};\r\n  border-radius: 0;\r\n  font-size: 1em;\r\n  ${textAlign}\r\n  &::placeholder {\r\n    color: ${themeGet('colors.gray')};\r\n  }\r\n`;\r\n\r\nconst Input = ({\r\n  label,\r\n  labelWidth,\r\n  name,\r\n  placeholder,\r\n  disabled,\r\n  value,\r\n  onChange,\r\n  onBlur,\r\n  onKeyUp,\r\n  error,\r\n  type,\r\n  min,\r\n  max,\r\n  textAlign,\r\n  step,\r\n  ...props\r\n}) => (\r\n  <Flex as=\"label\" alignItems=\"center\" {...props}>\r\n    {label && (\r\n      <Box mr=\"1em\" w={labelWidth}>\r\n        <Text fontWeight=\"bold\">{label}</Text>\r\n      </Box>\r\n    )}\r\n    <Box flex=\"1\">\r\n      {createElement(TextInput, {\r\n        name,\r\n        placeholder,\r\n        disabled,\r\n        value,\r\n        onChange,\r\n        onBlur,\r\n        onKeyUp,\r\n        type,\r\n        min,\r\n        max,\r\n        textAlign,\r\n        step,\r\n      })}\r\n      {error && (\r\n        <Text fontSize=\"0.8em\" align=\"left\" color=\"red\" mt=\"0.25rem\">{error}</Text>\r\n      )}\r\n    </Box>\r\n  </Flex>\r\n);\r\n\r\nInput.propTypes = {\r\n  label: PropTypes.string,\r\n  labelWidth: PropTypes.string,\r\n  name: PropTypes.string,\r\n  error: PropTypes.oneOfType([\r\n    PropTypes.bool,\r\n    PropTypes.string,\r\n  ]),\r\n  placeholder: PropTypes.string,\r\n  disabled: PropTypes.bool,\r\n  value: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.number,\r\n  ]),\r\n  onChange: PropTypes.func,\r\n  onKeyUp: PropTypes.func,\r\n  onBlur: PropTypes.func,\r\n};\r\n\r\nInput.displayName = 'Input';\r\n\r\nexport default Input;\r\n","import { createContext } from 'react'\r\n\r\nexport default createContext({})\r\n","import React, { useCallback, useState, useMemo } from 'react';\r\nimport * as Msal from 'msal'\r\nimport { useImmer } from 'use-immer'\r\n\r\nimport hookWithLocalStorage from '../../utils/hookWithLocalStorage'\r\nimport Input from '../../components/Input'\r\n\r\nimport context from './context'\r\n\r\n// Config object to be passed to Msal on creation.\r\n// For a full list of msal.js configuration parameters,\r\n// visit https://azuread.github.io/microsoft-authentication-library-for-js/docs/msal/modules/_authenticationparameters_.html\r\nconst msalConfig = {\r\n  auth: {\r\n    clientId: '5ed0f7c5-cd47-4779-bfd3-53f5b0445c94',\r\n    authority: 'https://login.microsoftonline.com/common',\r\n    redirectUri: process.env.NODE_ENV === 'development' ? 'http://localhost:3000/' : 'https://relabcc.github.io/winbond-excel-roadmap/',\r\n  },\r\n  cache: {\r\n    cacheLocation: 'sessionStorage', // This configures where your cache will be stored\r\n    storeAuthStateInCookie: false, // Set this to 'true' if you are having issues on IE11 or Edge\r\n  },\r\n};\r\n\r\nconst graphConfig = {\r\n  getReadSheetEndPoint: id => `https://graph.microsoft.com/v1.0/me/drive/items/${id}/workbook/worksheets`,\r\n  getReadSheetDataEndPoint: (id, sheetName) => `https://graph.microsoft.com/v1.0/me/drive/items/${id}/workbook/worksheets/${sheetName}/usedRange`,\r\n}\r\n\r\n// Add here scopes for id token to be used at MS Identity Platform endpoints.\r\nconst loginRequest = {\r\n  scopes: ['openid', 'profile', 'User.Read', 'Files.Read']\r\n};\r\n\r\nconst myMSALObj = new Msal.UserAgentApplication(msalConfig);\r\n\r\nfunction callMSGraph(endpoint, token) {\r\n  const headers = new Headers();\r\n  const bearer = `Bearer ${token}`;\r\n\r\n  headers.append(\"Authorization\", bearer);\r\n\r\n  const options = {\r\n      method: \"GET\",\r\n      headers: headers\r\n  };\r\n\r\n  console.log('request made to Graph API at: ' + new Date().toString());\r\n\r\n  return fetch(endpoint, options)\r\n    .then(response => response.json())\r\n    .catch(error => console.log(error))\r\n}\r\n\r\nfunction getTokenPopup(request) {\r\n  return myMSALObj.acquireTokenSilent(request)\r\n    .catch(error => {\r\n      console.log(error);\r\n      console.log(\"silent token acquisition fails. acquiring token using popup\");\r\n\r\n      // fallback to interaction when silent call fails\r\n        return myMSALObj.acquireTokenPopup(request)\r\n          .then(tokenResponse => {\r\n            return tokenResponse;\r\n          }).catch(error => {\r\n            console.log(error);\r\n          });\r\n    });\r\n}\r\n\r\n// https://onedrive.live.com/edit.aspx?cid=0c338d6b32e0967e&page=view&resid=C338D6B32E0967E!107&parId=C338D6B32E0967E!101&app=Excel\r\n\r\nconst Provider = ({ children }) => {\r\n  const [account, setAccount] = useState(myMSALObj.getAccount())\r\n  const [loading, setLoading] = useState()\r\n  const [workbookUrl, setWorkbookUrl] = hookWithLocalStorage('WORKBOOK_URL')(useState)\r\n  const [sheets, setSheets] = hookWithLocalStorage('WORKSHEETS')(useState)\r\n  const [sheetData, setSheetData] = hookWithLocalStorage('SHEET_DATA', {})(useImmer)\r\n  const workbookId = useMemo(() => {\r\n    try {\r\n      const url = new URL(workbookUrl);\r\n      const params = new URLSearchParams(url.search);\r\n      return params.get('resid')\r\n    } catch (e) {\r\n      return ''\r\n    }\r\n  }, [workbookUrl])\r\n  const signIn = useCallback(() => {\r\n    myMSALObj.loginPopup(loginRequest)\r\n      .then(loginResponse => {\r\n        console.log('id_token acquired at: ' + new Date().toString());\r\n        console.log(loginResponse);\r\n\r\n        if (myMSALObj.getAccount()) {\r\n          setAccount(myMSALObj.getAccount())\r\n        }\r\n      }).catch(error => {\r\n        console.log(error);\r\n      });\r\n  }, [setAccount])\r\n\r\n  const signOut = useCallback(() => {\r\n    if (account) {\r\n      myMSALObj.logout();\r\n      setAccount(null)\r\n    }\r\n  }, [setAccount, account])\r\n\r\n  const loadSheets = () => {\r\n    if (account && !loading && workbookId) {\r\n      console.log('start load sheet')\r\n      setLoading(true)\r\n      getTokenPopup(loginRequest)\r\n        .then(response => {\r\n          callMSGraph(graphConfig.getReadSheetEndPoint(workbookId), response.accessToken)\r\n            .then(data => {\r\n              if (data.value) {\r\n                setSheets(data.value)\r\n              }\r\n              setLoading(false)\r\n            });\r\n        }).catch(error => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const loadSheetData = useCallback((sheetName) => {\r\n    if (account && !loading && workbookId && !sheetData[sheetName]) {\r\n      console.log('start load sheet data')\r\n      setLoading(true)\r\n      getTokenPopup(loginRequest)\r\n        .then(response => {\r\n          callMSGraph(graphConfig.getReadSheetDataEndPoint(workbookId, sheetName), response.accessToken)\r\n            .then(data => {\r\n              console.log(data)\r\n              if (data) {\r\n                setSheetData(draft => {\r\n                  draft[sheetName] = data\r\n                })\r\n              }\r\n              setLoading(false)\r\n            });\r\n        }).catch(error => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }, [loading, account, sheetData, workbookId])\r\n\r\n  const WorkBookIdInput = useCallback((p) => (\r\n    <Input\r\n      label=\"貼上Excel連結\"\r\n      value={workbookUrl}\r\n      onChange={e => setWorkbookUrl(e.target.value)}\r\n      onKeyUp={e => e.keyCode === 13 && loadSheets()}\r\n      {...p}\r\n    />\r\n  ), [workbookUrl])\r\n\r\n  return (\r\n    <context.Provider\r\n      value={{\r\n        account,\r\n        signIn,\r\n        signOut,\r\n        loadSheets,\r\n        loadSheetData,\r\n        loading,\r\n        sheets,\r\n        sheetData,\r\n        WorkBookIdInput,\r\n      }}\r\n    >\r\n      {children}\r\n    </context.Provider>\r\n  );\r\n};\r\n\r\nexport default Provider;\r\n","import React from 'react';\r\n\r\nimport Box from './Box';\r\nimport { containerWidth } from './ThemeProvider/theme';\r\n\r\nconst Container = (props) => <Box {...props} />;\r\n\r\nContainer.defaultProps = {\r\n  mx: 'auto',\r\n  px: ['1em', null, '2em'],\r\n  width: 1,\r\n  maxWidth: containerWidth,\r\n};\r\n\r\nContainer.displayName = 'Container';\r\n\r\nexport default Container;\r\n","import { style } from 'styled-system';\r\n\r\nexport const customColor = (prop, cssProperty = 'color') => style ({\r\n  prop,\r\n  cssProperty,\r\n  key: 'colors',\r\n});\r\n","import React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport {\r\n  typography,\r\n  space,\r\n  color,\r\n  layout,\r\n  border,\r\n  borderRadius,\r\n  position,\r\n} from 'styled-system';\r\nimport themeGet from '@styled-system/theme-get';\r\nimport shouldForwardProp from '@styled-system/should-forward-prop'\r\n\r\nimport Box from './Box';\r\n\r\nimport { customColor } from './utils/getColor';\r\nimport isToAs from './utils/isToAs'\r\n\r\nconst active = css`\r\n  ${customColor('hoverColor')};\r\n  ${customColor('hoverBg', 'backgroundColor')};\r\n  ${customColor('hoverBorder', 'borderColor')};\r\n`;\r\n\r\nconst ButtonBase = styled.button.withConfig({ shouldForwardProp })`\r\n  padding: 0;\r\n  border: none;\r\n  font-family: inherit;\r\n  line-height: 1;\r\n  text-decoration: none;\r\n  ${typography}\r\n  ${layout}\r\n  ${position}\r\n  ${space}\r\n  ${color}\r\n  ${border}\r\n  ${borderRadius}\r\n  appearance: none;\r\n  transition: all ${themeGet('duration', 250)}ms;\r\n  cursor: pointer;\r\n  &:hover,\r\n  &:focus {\r\n    ${props => !props.disabled && active}\r\n    outline: none;\r\n  }\r\n  ${props => props.active && !props.disabled && active}\r\n  ${props =>\r\n    props.disabled &&\r\n    `\r\n    cursor: not-allowed;\r\n    opacity: 0.5;\r\n  `}\r\n`;\r\n\r\nconst InButtonSpan = props => <Box as=\"span\" {...props} />;\r\n\r\nconst Button = isToAs(({\r\n  leftIcon,\r\n  rightIcon,\r\n  iconSpacing,\r\n  iconsSize,\r\n  children,\r\n  verticalAlign,\r\n  ...props\r\n}) => (\r\n  <ButtonBase {...props}>\r\n    {leftIcon ? (\r\n      <Box as={leftIcon} mr={iconSpacing} verticalAlign={verticalAlign} fontSize={iconsSize} />\r\n    ) : null}\r\n    <InButtonSpan verticalAlign={verticalAlign}>{children}</InButtonSpan>\r\n    {rightIcon ? (\r\n      <Box as={rightIcon} ml={iconSpacing} verticalAlign={verticalAlign} fontSize={iconsSize} />\r\n    ) : null}\r\n  </ButtonBase>\r\n));\r\n\r\nButton.defaultProps = {\r\n  border: '2px solid',\r\n  borderColor: 'primary',\r\n  bg: 'primary',\r\n  color: 'white',\r\n  hoverColor: 'white',\r\n  hoverBg: 'primaryHover',\r\n  hoverBorder: 'primaryHover',\r\n  px: '1.5em',\r\n  py: '0.75em',\r\n  fontWeight: 'bold',\r\n  iconSpacing: '0.25em',\r\n  borderRadius: '0.25em',\r\n  display: 'inline-block',\r\n  verticalAlign: 'middle',\r\n  iconsSize: '1.25em',\r\n};\r\n\r\nButton.displayName = 'Button';\r\n\r\nButton.Danger = props => (\r\n  <Button\r\n    bg=\"danger\"\r\n    borderColor=\"danger\"\r\n    hoverBg=\"dangerHover\"\r\n    hoverBorder=\"dangerHover\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Secondary = props => (\r\n  <Button\r\n    bg=\"secondary\"\r\n    border=\"2px solid\"\r\n    borderColor=\"secondary\"\r\n    hoverBg=\"secondaryHover\"\r\n    hoverBorder=\"secondaryHover\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Outline = props => (\r\n  <Button\r\n    border=\"2px solid\"\r\n    borderColor=\"primary\"\r\n    bg=\"transparent\"\r\n    color=\"primary\"\r\n    hoverColor=\"white\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Outline.Danger = props => (\r\n  <Button.Danger\r\n    border=\"2px solid\"\r\n    borderColor=\"danger\"\r\n    bg=\"transparent\"\r\n    color=\"danger\"\r\n    hoverColor=\"white\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nButton.Transparent = props => (\r\n  <Button\r\n    border=\"1px solid transparent\"\r\n    bg=\"transparent\"\r\n    color=\"text\"\r\n    hoverBorder=\"primary\"\r\n    {...props}\r\n  />\r\n);\r\n\r\nexport default Button;\r\n","import React, { useMemo } from 'react';\r\n\r\nimport Select from 'react-select';\r\n\r\nimport Flex from './Flex'\r\nimport Box from './Box'\r\nimport Text from './Text'\r\n\r\nconst SingleSelect = ({ options, name, onChange, value, label, ...props }) => {\r\n  const formattedOptions = useMemo(() => {\r\n    if (!options || !options.length) return []\r\n    return options.map(opt => {\r\n      if (typeof opt === 'string') {\r\n        return { label: opt, value: opt }\r\n      }\r\n      return opt\r\n    })\r\n  }, [options])\r\n  return (\r\n    <Flex alignItems=\"center\" {...props}>\r\n      <Text mr=\"0.5em\">{label}</Text>\r\n      <Box width=\"12em\">\r\n        <Select\r\n          defaultValue={value}\r\n          isClearable\r\n          name={name}\r\n          options={formattedOptions}\r\n          onChange={onChange}\r\n        />\r\n      </Box>\r\n    </Flex>\r\n  )\r\n}\r\n\r\nexport default SingleSelect\r\n","import React, { useMemo, forwardRef, useRef, useEffect } from 'react';\nimport { useTable, useFilters, useRowSelect } from 'react-table'\nimport styled from 'styled-components'\nimport isObject from 'lodash/isObject'\n\nimport Box from '../components/Box'\n\nconst StyledTable = styled.table`\nwidth: max-content;\nth,\ntd {\n  white-space: pre-wrap;\n  padding: 0.5em;\n}\n`\n\nconst StyledInput = styled.input`\n  width: 100%;\n`\n\nconst IndeterminateCheckbox = forwardRef(\n  ({ indeterminate, ...rest }, ref) => {\n    const defaultRef = useRef()\n    const resolvedRef = ref || defaultRef\n\n    useEffect(() => {\n      resolvedRef.current.indeterminate = indeterminate\n    }, [resolvedRef, indeterminate])\n\n    return (\n      <>\n        <input type=\"checkbox\" ref={resolvedRef} {...rest} />\n      </>\n    )\n  }\n)\n\n// Define a default UI for filtering\nfunction DefaultColumnFilter({\n  column: { filterValue, preFilteredRows, setFilter },\n}) {\n  const count = preFilteredRows.length\n\n  return (\n    <StyledInput\n      value={filterValue || ''}\n      onChange={e => {\n        setFilter(e.target.value || undefined) // Set undefined to remove the filter entirely\n      }}\n      placeholder={`Search ${count} records...`}\n    />\n  )\n}\n\nconst defaultColumn = {\n  Filter: DefaultColumnFilter,\n  canFilter: false,\n}\n\nconst SheetDataTable = ({ data, headerRow, onSelectRow }) => {\n  const columns = useMemo(() => {\n    const cols = headerRow.map((Header, i) => {\n      const col = isObject(Header) ? Object.assign({}, Header) : { Header, accessor: d => d[i], id: i }\n      return col\n    })\n    return cols\n  }, [headerRow])\n  const tableInstance = useTable({\n    columns,\n    data,\n    defaultColumn,\n    // filterTypes,\n  },\n  useFilters,\n  useRowSelect,\n  hooks => {\n    hooks.visibleColumns.push(columns => [\n      // Let's make a column for selection\n      {\n        id: 'selection',\n        // The header can use the table's getToggleAllRowsSelectedProps method\n        // to render a checkbox\n        Header: ({ getToggleAllRowsSelectedProps }) => (\n          <div>\n            <IndeterminateCheckbox {...getToggleAllRowsSelectedProps()} />\n          </div>\n        ),\n        // The cell can use the individual row's getToggleRowSelectedProps method\n        // to the render a checkbox\n        Cell: ({ row }) => (\n          <div>\n            <IndeterminateCheckbox {...row.getToggleRowSelectedProps()} />\n          </div>\n        ),\n      },\n      ...columns,\n    ])\n  })\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state: { selectedRowIds },\n  } = tableInstance\n\n  useEffect(() => {\n    onSelectRow(selectedRowIds)\n  }, [selectedRowIds])\n\n  return (\n    <Box overflowX=\"auto\">\n      <StyledTable {...getTableProps()}>\n        <thead>\n          {// Loop over the header rows\n          headerGroups.map(headerGroup => (\n            // Apply the header row props\n            <tr {...headerGroup.getHeaderGroupProps()}>\n              {// Loop over the headers in each row\n              headerGroup.headers.map((column, i) => (\n                // Apply the header cell props\n                <th {...column.getHeaderProps()}>\n                  {// Render the header\n                  column.render('Header')}\n                  <div>{column.canFilter && i === 1 ? column.render('Filter') : null}</div>\n                </th>\n              ))}\n            </tr>\n          ))}\n        </thead>\n        {/* Apply the table body props */}\n        <tbody {...getTableBodyProps()}>\n          {// Loop over the table rows\n          rows.map(row => {\n            // Prepare the row for display\n            prepareRow(row)\n            return (\n              // Apply the row props\n              <tr {...row.getRowProps()}>\n                {// Loop over the rows cells\n                row.cells.map(cell => {\n                  // Apply the cell props\n                  return (\n                    <td {...cell.getCellProps()}>\n                      {// Render the cell contents\n                      cell.render('Cell')}\n                    </td>\n                  )\n                })}\n              </tr>\n            )\n          })}\n        </tbody>\n      </StyledTable>\n    </Box>\n  )\n};\n\nSheetDataTable.defaultProps = {\n  onSelectRow: () => {},\n}\n\nexport default SheetDataTable;\n","const PIXEL_RATIO = (function () {\r\n  const ctx = document.createElement('canvas').getContext('2d'),\r\n      dpr = window.devicePixelRatio || 1,\r\n      bsr = ctx.webkitBackingStorePixelRatio ||\r\n            ctx.mozBackingStorePixelRatio ||\r\n            ctx.msBackingStorePixelRatio ||\r\n            ctx.oBackingStorePixelRatio ||\r\n            ctx.backingStorePixelRatio || 1;\r\n\r\n  return dpr / bsr;\r\n})();\r\n\r\nconst setHiDPICanvas = function(canvas, w, h, ratio) {\r\n  if (!ratio) { ratio = PIXEL_RATIO; }\r\n  const can = canvas;\r\n  can.width = w * ratio;\r\n  can.height = h * ratio;\r\n  can.style.width = w + 'px';\r\n  can.style.height = h + 'px';\r\n  can.getContext('2d').setTransform(ratio, 0, 0, ratio, 0, 0);\r\n}\r\n\r\nfunction Dom2Canvas(dom, w, h, bg) {\r\n  this.dom = dom;\r\n  this.canvas = null;\r\n  this.ctx = null;\r\n  this.width = w\r\n  this.height = h;\r\n  this.data = null;\r\n  this.bg = bg;\r\n\r\n  this.init();\r\n}\r\n\r\n/**\r\n * 初始化实例变量.\r\n */\r\nDom2Canvas.prototype.init = function () {\r\n  if (!this.width) this.width = this.dom.clientWidth;\r\n  if (!this.height) this.height = this.dom.clientHeight;\r\n\r\n  // 初始化canvas\r\n  this.canvas = document.createElement('canvas');\r\n  setHiDPICanvas(this.canvas, this.width, this.height)\r\n  this.ctx = this.canvas.getContext('2d');\r\n  if (!this.backgroundColor) {\r\n    this.backgroundColor = this.dom.style.backgroundColor || '#ffffff';\r\n  }\r\n  // 添加一个默认的矩形, 防止导出时, canvas的透明的.\r\n  this._addBackgroundRect();\r\n\r\n  if (this.bg) {\r\n    this.ctx.drawImage(this.bg, 0, 0)\r\n  }\r\n\r\n  // 添加xmlns, 按照XHTML标准渲染，实现了SVG和XHTML的混合使用\r\n  this._addNamespace();\r\n\r\n  this.data = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.width}\" height=\"${this.height}\">\r\n      <foreignObject width=\"100%\" height=\"100%\">${this.dom.outerHTML}</foreignObject>\r\n    </svg>`;\r\n};\r\n\r\n/**\r\n * 设置了xmlns=\"http://www.w3.org/1999/xhtml\"命名空间，dom标签及其子标签都会\r\n * 按照XHTML标准渲染，实现了SVG和XHTML的混合使用。\r\n */\r\nDom2Canvas.prototype._addNamespace = function () {\r\n  this.dom.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');\r\n}\r\n\r\n/**\r\n * 添加一个默认的矩形, 防止导出时, canvas的透明的.\r\n */\r\nDom2Canvas.prototype._addBackgroundRect = function () {\r\n  this.ctx.save();\r\n  this.ctx.fillStyle = this.backgroundColor;\r\n  this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n  this.ctx.restore();\r\n};\r\n\r\n/**\r\n * 将dom转化为canvas\r\n */\r\nDom2Canvas.prototype.toCanvas = function (cb) {\r\n  // hack: instead of a blobURL, if we use a dataURL, chrome seems happy...\r\n  const url = 'data:image/svg+xml; charset=utf8, ' + encodeURIComponent(this.data);\r\n  const image = new Image();\r\n  const that = this;\r\n\r\n  image.onload = () => {\r\n    that.ctx.drawImage(image, 0, 0);\r\n    URL.revokeObjectURL(url);\r\n\r\n    cb && cb(that.canvas);\r\n  }\r\n\r\n  image.src = url;\r\n};\r\n\r\nexport default Dom2Canvas\r\n","import React, { useMemo, useRef, useEffect, useCallback } from 'react';\nimport { useTable } from 'react-table'\nimport styled from 'styled-components'\nimport last from 'lodash/last'\nimport isObject from 'lodash/isObject'\nimport findLastIndex from 'lodash/findLastIndex'\nimport { saveAs } from 'file-saver'\n\nimport '../vendor/Blob'\nimport '../vendor/canvas-toBlob'\n\nimport Box from '../components/Box'\nimport Button from '../components/Button'\n\nimport Dom2Canvas from '../utils/dom2canvas'\n\nimport bg from './bg.png'\n\nconst CanvasContainer = styled.div`\ncanvas {\n  width: 100%;\n  height: auto;\n}\n`\n\nconst WIDTH = 1920\nconst HEIGHT = 1080\nconst fontFamily = 'Arial'\n\nconst bgImg = new Image()\nbgImg.src = bg\n\nconst RenderTable = ({ data, headerRow, allData, updatedMark }) => {\n  const tableRef = useRef()\n  const container = useRef()\n  const columns = useMemo(() => {\n    const cols = headerRow.slice(1, headerRow.length - 2)\n      .concat(headerRow[0])\n      .map((Header, i) => isObject(Header) ? Object.assign({}, Header) : { Header, accessor: d => d[i], id: i })\n    return cols\n  }, [headerRow])\n\n  const notes = useMemo(() => data.reduce((all, row) => {\n    const note = last(row)\n    if (note) {\n      all.push(note)\n    }\n    return all\n  }, []), [data])\n\n  const tableInstance = useTable({\n    columns,\n    data,\n  })\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = tableInstance\n\n  const orginizedHeader = useMemo(() => {\n    const placeHolders = {}\n    return headerGroups.reduce((headers, headerGroup, i) => {\n      headers[i] = headerGroup.headers.map((header, j) => {\n        if (header.placeholderOf) {\n          placeHolders[header.placeholderOf.id] = [i, j]\n          return {}\n        } else if (placeHolders[header.id]) {\n          const [x, y] = placeHolders[header.id]\n          headers[x][y] = { rowSpan: i - x + 1, children: header.render('Header') }\n          return {}\n        } else {\n          return { colSpan: header.totalVisibleHeaderCount, children: header.render('Header') }\n        }\n      })\n      return headers\n    }, [])\n  }, [headerGroups])\n\n  const orginizedRows = useMemo(() => {\n    return rows.reduce((allRows, row, i) => {\n      prepareRow(row)\n      const thisRow = row.cells.map((cell, j) => {\n        if (cell.value) {\n          return { children: cell.render('Cell'), rowSpan: 1, updated: updatedMark && updatedMark[i][j] }\n        } else if (i === 0) {\n          const parentIndex = allData.findIndex(r => r[j + 1])\n          return { children: allData[parentIndex][j + 1], rowSpan: 1, updated: updatedMark && updatedMark[parentIndex][j + 1] }\n        } else {\n          const parentIndex = findLastIndex(allRows, r => r[j].rowSpan)\n          if (parentIndex > -1) allRows[parentIndex][j].rowSpan += 1\n          return {}\n        }\n      })\n      return allRows.concat([thisRow])\n    }, [])\n  }, [rows, prepareRow, allData, updatedMark])\n\n  const handleDownload = useCallback(() => {\n    container.current.querySelector('canvas').toBlob((blob) => {\n      saveAs(blob, 'image.png');\n    });\n  }, [container])\n\n  useEffect(() => {\n    const ins = new Dom2Canvas(tableRef.current, WIDTH, HEIGHT, bgImg)\n    container.current.innerHTML = ''\n    ins.toCanvas(canvas => {\n      // presentational style\n      canvas.style.width = '100%'\n      canvas.style.height = 'auto'\n      if (container.current) container.current.appendChild(canvas)\n    })\n  }, [data, updatedMark])\n\n  return (\n    <Box.Relative my=\"2em\">\n      <CanvasContainer ref={container} />\n      <Button my=\"0.5em\" onClick={handleDownload}>下載圖檔</Button>\n      <Box.Absolute\n        width={1}\n        height={1}\n        opacity={0}\n        overflow=\"hidden\"\n      >\n        <Box.Relative width={WIDTH} height={HEIGHT} ref={tableRef}>\n          <table\n            style={{\n              position: 'absolute',\n              top: 72 * 2,\n              left: 32 * 2,\n              right: 48 * 2,\n              bottom: 85 * 2,\n            }}\n            {...getTableProps()}\n          >\n            <thead>\n              {headerGroups.map((headerGroup, i) => (\n                <tr {...headerGroup.getHeaderGroupProps()}>\n                  {// Loop over the headers in each row\n                  headerGroup.headers.map((column, j) => {\n                    const { children, ...rest } = orginizedHeader[i][j]\n                    return children ? (\n                      <th\n                        {...column.getHeaderProps()}\n                        {...rest}\n                        style={{\n                          background: '#0E4E6E',\n                          color: 'white',\n                          padding: '0.25em',\n                          fontFamily,\n                          fontWeight: 'bold',\n                          fontSize: '22pt',\n                        }}>\n                        <span\n                          style={{\n                            writingMode: 'vertical-rl',\n                            textOrientation: 'mixed',\n                            transform: 'rotate(180deg)',\n                            whiteSpace: 'pre',\n                          }}\n                        >\n                          {children}\n                        </span>\n                      </th>\n                    ) : null\n                  })}\n                </tr>\n              ))}\n            </thead>\n            {/* Apply the table body props */}\n            <tbody {...getTableBodyProps()}>\n              {// Loop over the table rows\n              rows.map((row, i) => {\n                // Prepare the row for display\n                return (\n                  // Apply the row props\n                  <tr {...row.getRowProps()}>\n                    {// Loop over the rows cells\n                    row.cells.map((cell, j) => {\n                      // Apply the cell props\n                      const { children, updated, ...rest } = orginizedRows[i][j]\n                      return children ? (\n                        <td\n                          {...cell.getCellProps()}\n                          {...rest}\n                          style={{\n                            fontFamily,\n                            fontSize: '20pt',\n                            padding: '0.5em',\n                            whiteSpace: 'pre',\n                            textAlign: 'center',\n                            background: '#E1E1E1',\n                            color: updated ? '#D6262F' : 'black',\n                          }}\n                        >\n                          {children}\n                        </td>\n                      ) : null\n                    })}\n                  </tr>\n                )\n              })}\n            </tbody>\n          </table>\n          <div style={{\n            position: 'absolute',\n            left: '2em',\n            bottom: '1em',\n            fontSize: '14pt',\n            fontFamily,\n          }}>\n            <ol>\n              {notes.map((note, i) => <li key={i}>{note}</li>)}\n            </ol>\n          </div>\n        </Box.Relative>\n      </Box.Absolute>\n    </Box.Relative>\n  )\n};\n\nexport default RenderTable;\n","import React, { useState, useMemo } from 'react'\nimport size from 'lodash/size'\n\nimport Container from '../components/Container'\nimport Box from '../components/Box'\nimport Flex from '../components/Flex'\nimport Text from '../components/Text'\nimport Button from '../components/Button'\nimport Dropdown from '../components/Dropdown'\nimport { responsive } from '../components/ThemeProvider/theme';\n\nimport SheetDataTable from './SheetDataTable'\n\nimport useMsal from '../contexts/msal/useMsal'\nimport RenderTable from './RenderTable';\n\nconst HomePage = () => {\n  const {\n    account,\n    loadSheets,\n    loading,\n    sheets,\n    AuthButton,\n    loadSheetData,\n    sheetData,\n    WorkBookIdInput,\n  } = useMsal()\n  const [selectedSheet, setSheet] = useState()\n  const [compareSheet, setCompareSheet] = useState()\n  const [selectedRow, setSelectedRow] = useState({})\n  const data = sheetData[selectedSheet]\n  const compareSheetData = compareSheet && sheetData[compareSheet]\n  const doubleHeader = useMemo(() => data && data.text && data.text[0].some(h => !h), [data])\n  const headerRow = useMemo(() => {\n    if (!data || !data.text) return []\n    if (doubleHeader) {\n      const colLength = data.text[0].length\n      let groupMemo = []\n      // 空白代表要group ['a', 'b', '', 'c']\n      // b後面的空白要跟b group一起，所以先反轉陣列，從後面檢查回來，只要是空白，就等到下一個值出現然後把他們group起來\n      return data.text[0].slice(0).reverse().reduce((all, h, i) => {\n        // 檢查有沒有值\n        if (h) {\n          // 檢查有沒有之前先標記要變成group的\n          if (groupMemo.length) {\n            // if true 把現在這一格也加入group\n            groupMemo.push(i)\n            all.push({\n              Header: h,\n              columns: groupMemo.slice().reverse().map(j => ({\n                Header: data.text[1][colLength - j - 1],\n                accessor: d => d[colLength - j - 1],\n                id: `${i}-${j}`,\n              })),\n            })\n            // 清空group的標記\n            groupMemo = []\n          } else {\n            // if false 就是一般的header\n            all.push({ Header: h, accessor: d => d[colLength - i - 1], id: i })\n          }\n        } else {\n          // 沒有值，之後要跟別人group，先暫存起來\n          groupMemo.push(i)\n        }\n        return all\n      }, []).reverse() // 最後記得再反轉回來\n    }\n    return data.text[0]\n  }, [data, doubleHeader])\n  const tableData = useMemo(() => (data && data.text) ? data.text.slice(doubleHeader ? 2 : 1) : [], [data, doubleHeader])\n  const compareData = useMemo(() => (compareSheetData && compareSheetData.text) ? compareSheetData.text.slice(doubleHeader ? 2 : 1) : [], [compareSheetData, doubleHeader])\n  const indexedData = useMemo(() => (data && data.text) ? data.text.reduce((all, d, i) => {\n    const offset = doubleHeader ? 2 : 1\n    if (i >= offset) all[i - offset] = d\n    return all\n  }, {}) : {}, [data, doubleHeader])\n\n  const renderValues = useMemo(() => {\n    if (!size(selectedRow)) return []\n    return Object.entries(selectedRow).map(([i, selected]) => selected ? indexedData[i] : null).filter(Boolean)\n  }, [selectedRow, indexedData])\n\n  const updatedMark = useMemo(() => {\n    if (!size(compareData)) return null\n    const compareMark = compareData.reduce((all, row) => {\n      all[row[0]] = row\n      return all\n    }, {})\n    return renderValues.map((row) => {\n      const toCompare = compareMark[row[0]]\n      if (toCompare) {\n        return row.map((r, i) => r !== toCompare[i])\n      } else {\n        return row.fill(true)\n      }\n    })\n\n  }, [renderValues, compareData])\n\n  return (\n    <Container py={responsive(0, '2em')}>\n      {account ? (\n        <Box>\n          <Flex>\n            <WorkBookIdInput flex=\"1\" />\n            <Box ml=\"1em\">\n              <Button disabled={loading} my=\"1em\" onClick={loadSheets}>載入資料表</Button>\n            </Box>\n          </Flex>\n          {sheets && (\n            <>\n              <Dropdown\n                label=\"選擇資料表\"\n                onChange={(selected) => {\n                  if (selected) {\n                    setSheet(selected.value)\n                    loadSheetData(selected.value)\n                  } else {\n                    setSheet()\n                  }\n                }}\n                options={sheets.map(sheet => sheet.name)}\n              />\n              {data && (\n                <>\n                  <SheetDataTable\n                    data={tableData}\n                    headerRow={headerRow}\n                    onSelectRow={setSelectedRow}\n                  />\n                  <Dropdown\n                    my=\"1em\"\n                    label=\"對比資料表\"\n                    onChange={(selected) => {\n                      if (selected) {\n                        setCompareSheet(selected.value)\n                        loadSheetData(selected.value)\n                      } else {\n                        setCompareSheet()\n                      }\n                    }}\n                    options={sheets.map(sheet => sheet.name).filter(name => name !== selectedSheet)}\n                  />\n                  {renderValues.length ? (\n                    <RenderTable\n                      allData={tableData}\n                      data={renderValues}\n                      headerRow={headerRow.slice(0, headerRow.length - 2)}\n                      updatedMark={updatedMark}\n                    />\n                  ) : null}\n                </>\n              )}\n            </>\n          )}\n        </Box>\n      ) : (\n        <>\n          <Text>請先登入</Text>\n          <AuthButton />\n        </>\n      )}\n    </Container>\n  )\n}\n\nexport default HomePage\n","import React, { useContext, useCallback } from 'react'\r\n\r\nimport Button from '../../components/Button'\r\n\r\nimport context from './context'\r\n\r\nexport default () => {\r\n  const { account, signIn, signOut, ...rest } = useContext(context)\r\n  const AuthButton = useCallback(() => (\r\n    <Button onClick={account ? signOut : signIn}>{account ? 'Logout' : 'Login'}</Button>\r\n  ), [account])\r\n  return {\r\n    AuthButton,\r\n    account,\r\n    signIn,\r\n    signOut,\r\n    ...rest,\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nimport HomePage from './containers/HomePage'\r\n\r\nfunction App() {\r\n  return (\r\n    <HomePage />\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ThemeProvider from './components/ThemeProvider'\n// import MediaProvider from './contexts/mediaQuery/MediaProvider'\nimport MsalProvider from './contexts/msal/Provider'\n\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <ThemeProvider>\n    {/* <MediaProvider> */}\n      <MsalProvider>\n        <App />\n      </MsalProvider>\n    {/* </MediaProvider> */}\n  </ThemeProvider>\n, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}