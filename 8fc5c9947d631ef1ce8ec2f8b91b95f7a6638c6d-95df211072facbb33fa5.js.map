{"version":3,"file":"8fc5c9947d631ef1ce8ec2f8b91b95f7a6638c6d-95df211072facbb33fa5.js","mappings":"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","sources":["webpack://styled-gatsby-starter/./src/containers/DramDataTable.js","webpack://styled-gatsby-starter/./src/containers/DramDownloader.js","webpack://styled-gatsby-starter/./src/containers/DramPage.js","webpack://styled-gatsby-starter/./node_modules/lodash/_baseFlatten.js","webpack://styled-gatsby-starter/./node_modules/lodash/_baseSet.js","webpack://styled-gatsby-starter/./node_modules/lodash/_createRound.js","webpack://styled-gatsby-starter/./node_modules/lodash/_isFlattenable.js","webpack://styled-gatsby-starter/./node_modules/lodash/compact.js","webpack://styled-gatsby-starter/./node_modules/lodash/concat.js","webpack://styled-gatsby-starter/./node_modules/lodash/floor.js","webpack://styled-gatsby-starter/./node_modules/lodash/isNumber.js","webpack://styled-gatsby-starter/./node_modules/lodash/set.js"],"sourcesContent":["import React, { useMemo, useRef, useEffect, useState, useCallback } from 'react';\r\nimport styled from 'styled-components'\r\nimport isObject from 'lodash/isObject'\r\nimport set from 'lodash/set';\r\nimport isNumber from 'lodash/isNumber';\r\nimport compact from 'lodash/compact';\r\nimport concat from 'lodash/concat';\r\nimport floor from 'lodash/floor';\r\nimport range from 'lodash/range';\r\n\r\nimport Box from '../components/Box'\r\nimport Flex from '../components/Flex'\r\nimport Text from '../components/Text';\r\nimport parseDate from 'utils/parseDate';\r\nimport PageTitle from './PageTitle';\r\nimport DramTimeline from './DramTimeline';\r\n\r\nconst listStyle = [\r\n  'disc',\r\n  'circle',\r\n  'square',\r\n]\r\n\r\nconst StyledTable = styled.table`\r\n  table-layout: fixed;\r\n  width: 100%;\r\n  th,\r\n  td {\r\n    white-space: pre;\r\n    padding: 0.5rem;\r\n    border: 3px solid white;\r\n    line-height: 1.25;\r\n  }\r\n`\r\nlet group = []\r\nconst replaceSup = (t) => String(t)\r\n  .replace(/\\{([^{]+)\\}/g, (...d) => `<sup>${d[1]}</sup>`)\r\n  .replace(/\\{\\{([^}]+)\\}\\}/g, (m, g) => `<span style=\"color: #D6262F\">${g}</span>`)\r\n\r\nconst noteBg = { mp: '#A4CCDB', cs: '#4D9185', es: '#DC888A', sample: '#2F6EBA' }\r\n// const bodybg = ['#B1B1B2', '#CACACA', '#E8E8E8']\r\nconst noteFunc = (noteArr, depth = 0) => {\r\n  const groups = noteArr.reduce((g, n) => {\r\n    if (n.startsWith('-')) {\r\n      let lastGroup = g[g.length - 1]\r\n      if (!lastGroup) {\r\n        g.push([''])\r\n        lastGroup = g[g.length - 1]\r\n      }\r\n      lastGroup[1] = lastGroup[1] || []\r\n      lastGroup[1].push(n.substring(1))\r\n    } else {\r\n      g.push([n])\r\n    }\r\n    return g\r\n  }, [])\r\n  return (\r\n    <Box as=\"ul\" pl=\"1em\" style={{ listStyleType: listStyle[depth % 3] }}>\r\n      {groups.map((g, i) => (\r\n        <li key={i}>\r\n          <span dangerouslySetInnerHTML={{ __html: replaceSup(g[0]) }} />\r\n          {g[1] && noteFunc(g[1], depth + 1)}\r\n        </li>\r\n      ))}\r\n    </Box>\r\n  )\r\n}\r\n\r\nconst DramDataTable = ({\r\n  allData,\r\n  data,\r\n  notes,\r\n  quater,\r\n  year,\r\n  type,\r\n  headerKeys,\r\n  name,\r\n  scale,\r\n  doubleHeader,\r\n  compareMark,\r\n  compareKeyIndex,\r\n}) => {\r\n  const [nmGroup, setNmGroup] = useState([]);\r\n  const tableRef = useRef()\r\n  const timelineData = useMemo(() => {\r\n    const dateGetter = notes.map(key => headerKeys.find(d => d.Header === key))\r\n    if (dateGetter.some(d => !d)) return []\r\n    const timeline = data.map(d => dateGetter.map(({ columns }) => columns.map(({ accessor }, i) => {\r\n      const dStr = accessor(d)\r\n      return parseDate(dStr, i)\r\n    })))\r\n    return timeline\r\n  }, [data, headerKeys, notes])\r\n  const timeIsInRange = useMemo(() => {\r\n    if (!Number.isNaN(type)) {\r\n      const dateStart = year + (quater - 1) / 4\r\n      const dateEnd = year + type * 1 + (quater - 1) / 4\r\n      const inRange = (d, isEnd) => {\r\n        if (!d) return true\r\n        if (typeof d == 'string') return false\r\n        const y = d.year + d.month / 12\r\n        return isEnd ? y >= dateStart : y <= dateEnd\r\n      }\r\n      return timelineData.map(d => d.some(([s, e]) => inRange(s) && inRange(e, true)))\r\n    }\r\n    // const dateEnd = new Date(year, (quater - 1) * 3, 1)\r\n  }, [timelineData, quater, year, type])\r\n  const okTimeline = useMemo(() => timelineData.filter((d, i) => timeIsInRange[i]), [timelineData, timeIsInRange])\r\n  const yearRow = useMemo(() => range(type * (type < 7 ? 4 : 2)).map((n) => {\r\n    if (!n) {\r\n      return year\r\n    }\r\n    if (((type < 7 ? quater : 1) + n) % (type < 7 ? 4 : 2) === 1) {\r\n      return year + floor(((type < 7 ? quater : 1) + n) / (type < 7 ? 4 : 2))\r\n    } else {\r\n      return ''\r\n    }\r\n  }), [type, quater, year])\r\n  const getIndex = useCallback(pttn => allData?.[0]?.findIndex(d => pttn.test(d)), [allData])\r\n  const roadmapheaderRow = useMemo(() => allData && isNumber(type) && name === 'mcp' ? (\r\n    [\r\n      allData[0][getIndex(/Package\\s|\\nBall/i)],\r\n      allData[0][getIndex(/Product/i)],\r\n      allData[0][getIndex(/SLC\\s|\\nNAND/i)],\r\n      '',\r\n      allData[0][getIndex(/LPDDR2/i)],\r\n      '',\r\n      ...yearRow\r\n    ]\r\n  ) : (\r\n    concat(\r\n      name === 'flash' ? compact([\r\n        data?.[0][getIndex(/flash/i)] && allData[0][getIndex(/flash/i)],\r\n        data?.[0][getIndex(/S-NOR/i)] && allData[0][getIndex(/S-NOR/i)],\r\n        data?.[0][getIndex(/S-NAND/i)] && allData[0][getIndex(/S-NAND/i)],\r\n        data?.[0][getIndex(/^Density/i)] && allData[0][getIndex(/^Density/i)],\r\n      ]) : [allData?.[0][getIndex(/^Density/i)]], [allData?.[0][getIndex(/product/i)]],\r\n      name === 'flash' ? (data?.[0][getIndex(/Description/i)] ? 'Description' : []) : 'Description',\r\n      [...yearRow]\r\n    )\r\n  )\r\n    , [allData, type, data, name, yearRow, getIndex])\r\n  const headerRow = useMemo(() => {\r\n    if (doubleHeader) {\r\n      let groupMemo = []\r\n      // 空白代表要group ['a', 'b', '', 'c']\r\n      // b後面的空白要跟b group一起，所以先反轉陣列，從後面檢查回來，只要是空白，就等到下一個值出現然後把他們group起來\r\n      return roadmapheaderRow.slice(0).reverse().reduce((all, h, i) => {\r\n        // 檢查有沒有值\r\n        if (h) {\r\n          // 如果年份只有一季，但還是要有第二列\r\n          if (isNumber(h) && !groupMemo.length) {\r\n            all.push({\r\n              Header: h,\r\n              columns: [{\r\n                Header: type < 7 ? (i ? 'Q4' : 'Q1') : (i ? 'H2' : 'H1'),\r\n                id: `${h}-${1}`,\r\n              }],\r\n            })\r\n            return all\r\n          }\r\n          // 檢查有沒有之前先標記要變成group的\r\n          if (groupMemo.length) {\r\n            // if true 把現在這一格也加入group\r\n            if (isNumber(h)) {\r\n              groupMemo.push(i)\r\n              all.push({\r\n                Header: h,\r\n                columns: groupMemo.slice().map((j, key, { length }) => ({\r\n                  Header: type < 7 ? `Q${i < 4 ? key + 1 : (4 - length + key + 1)}` : `H${key + 1}`,\r\n                  // accessor: d => d[colLength - j - 1],\r\n                  id: `${h}-${key + 1}`,\r\n                })),\r\n              })\r\n            }\r\n            if (!isNumber(h) && name === 'mcp') {\r\n              groupMemo.push(i)\r\n              all.push({\r\n                Header: h,\r\n                columns: groupMemo.map((j, i) => ({\r\n                  Header: i ? 'I/O' : 'Density',\r\n                  // accessor: d => d[colLength - j - 1],\r\n                  id: `${h}-${i + 1}`,\r\n                })),\r\n              })\r\n            }\r\n            // 清空group的標記\r\n            groupMemo = []\r\n          } else {\r\n            // if false 就是一般的header\r\n            all.push({ Header: h, id: i })\r\n          }\r\n        } else {\r\n          // 沒有值，之後要跟別人group，先暫存起來\r\n          groupMemo.push(i)\r\n        }\r\n        return all\r\n      }, [])\r\n        .reverse() // 最後記得再反轉回來\r\n    }\r\n    return []\r\n  }, [doubleHeader, type, roadmapheaderRow, name])\r\n  const numberIndex = useMemo(() => headerRow.reduce((res, d, i) => {\r\n    if (!res && isNumber(d.Header)) {\r\n      res = i\r\n    }\r\n    return res\r\n  }, 0), [headerRow])\r\n  const productIndex = useMemo(() => headerRow.findIndex(d => /product/i.test(d.Header)), [headerRow])\r\n  const headerWidth = useMemo(() => name === 'mcp' ? ['7rem', '12rem', '12rem', '12rem'] : numberIndex > 3 ? ['6.9rem', '6.9rem', '10.4rem', '13.8rem'] : numberIndex > 2 ? ['9rem', '12.75rem', '16.25rem'] : ['15rem', '23rem'], [numberIndex, name])\r\n  const noteText = useMemo(() => {\r\n    if (!allData) return []\r\n    const noteIndex = allData[0].findIndex(d => (type > 3 && name == 'dram') ? /7yrs\\s|\\nNote/i.test(d) : /^note/i.test(d))\r\n    if (noteIndex < 0) return []\r\n    if (!data) return []\r\n    return (data?.[0][noteIndex].split('\\n') || '')\r\n  }, [allData, type, name, data])\r\n  const feature = useMemo(() => {\r\n    if (!allData) return []\r\n    const featureIndex = allData[0].findIndex(d => /feature/i.test(d))\r\n    const feature7yrIndex = allData[0].findIndex(d => /^7feature/i.test(d))\r\n    if (featureIndex < 0 || (name === 'dram' && type > 3 && feature7yrIndex < 0)) return []\r\n    if (!data) return []\r\n    return (data?.[0][(name === 'dram' && type > 3) ? feature7yrIndex : featureIndex].split('\\n') || '')\r\n  }, [allData, data])\r\n  // console.log(data)\r\n  const bodyData = useMemo(() => {\r\n    if (!allData) return []\r\n      const mapped = data?.map((d, i) => {\r\n      const dataToCompare = compareMark?.[d[compareKeyIndex]]\r\n      const getDataByHeaderPttn = (pttn, key = 0) => {\r\n        const index = +getIndex(pttn) + key\r\n        const v = d[index]\r\n        const isDiff = dataToCompare && dataToCompare[index] !== v\r\n        return isDiff ? `{{${v}}}` : v\r\n      }\r\n      if (name === 'mcp') {\r\n        // console.log(getDataByHeaderPttn(/Technology/i))\r\n        return [\r\n          getDataByHeaderPttn(/Package\\s|\\nBall/i),\r\n          getDataByHeaderPttn(/Product/i),\r\n          getDataByHeaderPttn(/SLC\\s|\\nNAND/i),\r\n          getDataByHeaderPttn(/SLC\\s|\\nNAND/i, 1),\r\n          getDataByHeaderPttn(/LPDDR2/i),\r\n          getDataByHeaderPttn(/LPDDR2/i, 1),\r\n          { text: '', col: type > 3 ? 14 : 12, nm: getDataByHeaderPttn(/Technology/i), }\r\n        ]\r\n      }\r\n      return (concat((name === 'flash' ? concat(\r\n        data[0][getIndex(/flash/i)] ? getDataByHeaderPttn(/flash/i) : [],\r\n        data[0][getIndex(/S-NOR/i)] ? getDataByHeaderPttn(/S-NOR/i) : [],\r\n        data[0][getIndex(/S-NAND/i)] ? getDataByHeaderPttn(/S-NAND/i) : [],\r\n        data[0][getIndex(/^Density/i)] ? getDataByHeaderPttn(/^Density/i) : []\r\n      ) : [getDataByHeaderPttn(/^Density/i)]), [\r\n        getDataByHeaderPttn(/Product/i),\r\n        (name !== 'flash' ? `${getDataByHeaderPttn(/I\\/O\\s|\\nWidth/i) + ' ' + getDataByHeaderPttn(/Voltage/i) + `\\n` + getDataByHeaderPttn(/Speed/i)}` : (\r\n          getDataByHeaderPttn(/Description/i)\r\n        )),\r\n        {\r\n          text: name !== 'flash' ? [\r\n            getDataByHeaderPttn(/^Technology\\s|\\nNode/i).replace(' ', ''),\r\n            getDataByHeaderPttn(/^Process\\s|\\nNode/i),\r\n            getDataByHeaderPttn(/Package/i)\r\n          ].filter(Boolean).join(', ') : '',\r\n          col: type > 3 ? 14 : 12,\r\n          nrnd: getDataByHeaderPttn(/NRND/i) === 'TRUE',\r\n          nm: name === 'flash' && getDataByHeaderPttn(/Technology/i),\r\n        },\r\n      ]))\r\n    }, [])\r\n    // return mapped\r\n    let removedInitial\r\n\r\n    return mapped.reduce((res, d, i) => {\r\n      if (!timeIsInRange[i]) {\r\n        if (d[0]) removedInitial = d[0]\r\n        return res\r\n      }\r\n      if (!d[0] && removedInitial) {\r\n        d[0] = removedInitial\r\n        removedInitial = undefined\r\n      }\r\n      res.push(d)\r\n      return res\r\n    }, [])\r\n  }, [allData, type, data, name, getIndex, compareMark, compareKeyIndex, year, quater])\r\n  const columnIndex = useMemo(() => headerRow.reduce((res, d, i) => {\r\n    if (!res && d.columns) {\r\n      res = i\r\n    }\r\n    return res\r\n  }, 0), [headerRow])\r\n  const columnCount = useMemo(() => headerRow.reduce((res, d, i) => {\r\n    if (d.columns && i < numberIndex) {\r\n      res = res + d.columns.length\r\n    }\r\n    return res\r\n  }, 0), [headerRow, numberIndex])\r\n  const bodybg = useMemo(() => range(Boolean(numberIndex - columnIndex) ? (numberIndex - columnIndex + columnCount) : numberIndex).map(num => num == productIndex ? '#CACACA' : num < productIndex ? '#B1B1B2' : '#E8E8E8'), [productIndex, numberIndex, columnIndex])\r\n\r\n  const rowSpansfuc = (key) => bodyData?.map(d => d[key]).reverse().reduce((res, h, i, { length }) => {\r\n    if (h) {\r\n      if (group.length) {\r\n        set(res, [length - i - 1], group.length + 1)\r\n        group = []\r\n      } else {\r\n        set(res, [length - i - 1], 1)\r\n      }\r\n    } else {\r\n      group.push(i)\r\n    }\r\n    return res\r\n  }, {})\r\n  useEffect(() => {\r\n    if (tableRef.current) {\r\n      const masterBox = tableRef.current.getBoundingClientRect()\r\n      const cells = tableRef.current.querySelectorAll('.timeline-cell[data-nm')\r\n      const cellGroup = []\r\n      cells.forEach(cell => {\r\n        const nm = cell.dataset.nm\r\n        const boundBox = cell.getBoundingClientRect()\r\n        const boxCenter = (boundBox.top + boundBox.height / 2 - masterBox.top) / scale\r\n        let currentGroup = cellGroup[cellGroup.length - 1]\r\n        if (nm !== currentGroup?.nm) {\r\n          currentGroup = { nm, left: (boundBox.right - masterBox.left) / scale }\r\n          cellGroup.push(currentGroup)\r\n        }\r\n        currentGroup.top = Math.min(currentGroup.top || boxCenter, boxCenter)\r\n        currentGroup.bottom = Math.max(currentGroup.bottom || boxCenter, boxCenter)\r\n      })\r\n      setNmGroup(cellGroup)\r\n\r\n    }\r\n  }, [bodyData])\r\n  return (\r\n    <Box position=\"relative\" pl=\"3.75em\" pr=\"1em\" width=\"1920px\" height=\"1080px\" ref={tableRef}>\r\n      {nmGroup.length > 0 && (\r\n        <Box.FullAbsolute>\r\n          {nmGroup.map(({ nm, top, bottom, left }, i) => {\r\n            const lines = nm.split('|')\r\n            return (\r\n              (\r\n                <Flex\r\n                  key={nm + i}\r\n                  position=\"absolute\"\r\n                  style={{ top, height: bottom - top, left }}\r\n                  border=\"1px solid\"\r\n                  borderLeft=\"none\"\r\n                  alignItems=\"center\"\r\n                >\r\n                  <Box\r\n                    style={{\r\n                      writingMode: 'vertical-rl',\r\n                      textRrientation: 'mixed',\r\n                    }}\r\n                    transform={`translateX(${lines.length + 0.8}em)`}\r\n                    textAlign=\"center\"\r\n                    lineHeight=\"0\"\r\n                    width=\"1.125em\"\r\n                  >\r\n                    {lines.map((d, i) => (\r\n                      <Text key={i}>{d}</Text>\r\n                    ))}\r\n                  </Box>\r\n                </Flex>\r\n              )\r\n            )\r\n          })}\r\n        </Box.FullAbsolute>\r\n      )}\r\n      <PageTitle>{data[0][0]}</PageTitle>\r\n      <Flex pt=\"7em\">\r\n        <StyledTable flex={1} style={{ position: \"relative\", background: 'linear-gradient(0deg, rgba(227,227,227,0.85), rgba(238,238,238,0.3))' }}>\r\n          <thead style={{ fontSize: '1.25rem', fontWeight: '900' }}>\r\n            <tr>\r\n              {headerRow.map(({ Header, columns }, i) => (\r\n                <Box\r\n                  as=\"th\"\r\n                  style={{ borderRight: i == (numberIndex - 1) && '10px solid' }}\r\n                  height=\"44px\"\r\n                  width={headerWidth[i]}\r\n                  fontSize={name == 'mcp' && !i && '14px'}\r\n                  color=\"white\"\r\n                  bg={isNumber(Header) ? '#C63B38' : '#234B69'}\r\n                  rowSpan={!columns && 2}\r\n                  colSpan={columns?.length || 1} key={i}>{Header}\r\n                </Box>\r\n              ))}\r\n            </tr>\r\n            <tr>\r\n              {headerRow.map(({ columns }, k) => columns?.map(({ Header }, i, { length }) => (\r\n                <Box\r\n                  as=\"th\"\r\n                  fontWeight=\"bold\"\r\n                  style={{\r\n                    borderRight: i !== (length - 1) ? '3px solid white' : (k === headerRow.length - 1 && i === (length - 1) ? '3px solid white' : ((numberIndex - columnIndex) && k === (numberIndex - 1) && i === (length - 1)) && '10px solid white'),\r\n                    whiteSpace: name === 'mcp' && 'nowrap',\r\n                  }}\r\n                  height=\"44px\"\r\n                  bg=\"#CACACA\"\r\n                  width=\"68px\"\r\n                  key={i}\r\n                >{Header}</Box>\r\n              )))}\r\n            </tr>\r\n          </thead>\r\n          {/* Apply the table body props */}\r\n          <tbody style={{ fontSize: '19px', height: '23em' }}>\r\n            {bodyData.map((body, i, {length}) => (\r\n              <Box as=\"tr\" key={i}>\r\n                {body.map((d, k) => d && (isObject(d) ? (\r\n                  <Box\r\n                    as=\"td\"\r\n                    colSpan={d.col}\r\n                    // style={{ background: 'linear-gradient(0deg, rgba(227,227,227,0.85), rgba(238,238,238,0.3))' }}\r\n                    key={k}\r\n                    position=\"relative\"\r\n                    overflow=\"visible\"\r\n                    className=\"timeline-cell\"\r\n                    data-nm={typeof d.nm === 'string' && d.nm.trim() ? d.nm.replace(/\\n/g, '|') : undefined}\r\n                    style={rowSpansfuc(0)[i] ? { borderBottom: 'none', borderLeft: '10px solid white' } : { borderTop: 'none', borderBottom: i === (length - 1) ? '3px solid white' : 'none', borderLeft: '10px solid white' }}\r\n                  >\r\n                    <DramTimeline\r\n                      data={okTimeline[i]}\r\n                      startYear={year}\r\n                      startQuarter={type === 3 ? quater : 1}\r\n                      yearSpan={type}\r\n                      colors={notes.map(n => noteBg[n.toLocaleLowerCase()])}\r\n                    />\r\n                    <Box position=\"relative\" pl=\"8em\">\r\n                      <span\r\n                        dangerouslySetInnerHTML={{ __html: replaceSup(d.text) }}\r\n                      />\r\n                      {d.nrnd && <Text.Inline fontWeight=\"bold\" color=\"#234b69\" pl=\"1em\">*NRND</Text.Inline>}\r\n                    </Box>\r\n                  </Box>\r\n                ) : (\r\n                  <Box\r\n                    as=\"td\"\r\n                    fontWeight={!k && 'bold'}\r\n                    bg={bodybg[k]}\r\n                    rowSpan={rowSpansfuc(k)[i]}\r\n                    style={{\r\n                      whiteSpace: name === 'mcp' && k > 0 && 'nowrap',\r\n                    }}\r\n                    // style={{ borderRight: (k - (headerRow.length - body.length)) == (numberIndex - 1) && '10px solid white'}}\r\n                    key={k}\r\n                  >\r\n                    <Flex\r\n                      minHeight=\"2.25rem\"\r\n                      alignItems=\"center\"\r\n                      justifyContent={k === headerRow.findIndex(d => /description/i.test(d.Header)) ? 'flex-start' : 'center'}\r\n                      textAlign={k === headerRow.findIndex(d => /description/i.test(d.Header)) ? 'flex-start' : 'center'}\r\n                      px={name === 'mcp' ? '0' : \"1em\"}\r\n                    >\r\n                      <Box dangerouslySetInnerHTML={{ __html: replaceSup(d) }} />\r\n                    </Flex>\r\n                  </Box>\r\n                )))}\r\n              </Box>\r\n            ))}\r\n          </tbody>\r\n        </StyledTable>\r\n        <Flex flexDirection=\"column\" ml={\"3.5em\"} width=\"22.375em\">\r\n          <Box border=\"1.5px solid transparent\" bg=\"transparent\" p=\"0.5rem\">　</Box>\r\n          <Flex mb=\"1em\">\r\n            {notes.map((d, i) => (\r\n              <Box fontSize=\"1.25rem\" width=\"100%\" fontWeight=\"bold\" textAlign=\"center\" bg={noteBg[d.toLocaleLowerCase()]} color=\"white\" p=\"0.375rem 0.5rem\" key={i}>{d}</Box>\r\n            ))}\r\n          </Flex>\r\n          {feature[0] && (\r\n            <>\r\n              <Box bg=\"#9FA0A0\" fontSize=\"1.125rem\" textAlign=\"center\" color=\"white\" p=\"0.5rem\" fontWeight=\"bold\">FEATURE</Box>\r\n              <Box p=\"0.5rem\" style={{ background: 'linear-gradient(0deg, rgba(227,227,227,0.85), rgba(238,238,238,0.3))' }}>\r\n                {feature[0] && noteFunc(feature)}\r\n              </Box>\r\n            </>\r\n          )}\r\n          <Box bg=\"#9FA0A0\" fontSize=\"1.125rem\" textAlign=\"center\" color=\"white\" p=\"0.5rem\" fontWeight=\"bold\">NOTE</Box>\r\n          <Box flex={1} p=\"0.5rem\" style={{ background: 'linear-gradient(0deg, rgba(227,227,227,0.85), rgba(238,238,238,0.3))' }}>\r\n            {noteText[0] && noteFunc(noteText)}\r\n          </Box>\r\n        </Flex>\r\n      </Flex>\r\n    </Box>\r\n  )\r\n};\r\n\r\nexport default DramDataTable;\r\n","import React, { useEffect, useRef, useState } from 'react'\nimport Box from 'components/Box'\nimport DramDataTable from './DramDataTable'\nimport PageSimulator from './PageSimulator'\n\nconst DramDownloader = ({\n  headerKeys,\n  allData,\n  pages,\n  doubleHeader,\n  quater,\n  year,\n  type,\n  notes,\n  name,\n  onDownloaded,\n  compareMark,\n  compareKeyIndex,\n  downloading,\n}) => {\n  const [page, setPage] = useState(0)\n  const downloadRef = useRef()\n  useEffect(() => {\n    if (downloadRef.current) {\n      downloadRef.current().then(() => {\n        if (page === pages.length - 1) {\n          onDownloaded()\n        } else {\n          setPage(page + 1)\n        }\n      })\n    }\n  }, [page])\n  return (\n    <Box overflow=\"hidden\" width=\"0\" height=\"0\">\n      <Box width=\"1920px\">\n        <PageSimulator downloading={downloading} noBg key={page} name={`${name}-${type}y-${page + 1}`} downloadRef={downloadRef}>\n          <DramDataTable\n            headerKeys={headerKeys}\n            allData={allData}\n            data={pages[page]}\n            doubleHeader={doubleHeader}\n            quater={quater}\n            year={year}\n            type={type}\n            notes={notes}\n            name={name}\n            compareMark={compareMark}\n            compareKeyIndex={compareKeyIndex}\n          />\n        </PageSimulator>\n      </Box>\n    </Box>\n  )\n}\n\nexport default DramDownloader\n","import React, { useState, useMemo, useCallback, cloneElement } from 'react'\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport 'react-tabs/style/react-tabs.css';\n// import { compact, concat, floor, isArray, isNumber, map, range, set, size } from 'lodash'\nimport { Link as GatsbyLink } from 'gatsby'\nimport useCompareData from 'hooks/useCompareData';\nimport useYearControl from 'hooks/useYearControl';\n\nimport Container from '../components/Container'\nimport Box from '../components/Box'\nimport Flex from '../components/Flex'\nimport Link from '../components/Link'\nimport Button from '../components/Button'\nimport Pagination from '../components/Pagination'\n\nimport DramDataTable from './DramDataTable'\nimport PortfolioPage from './PortfolioPage'\nimport SheetLoader from './SheetLoader'\n\n// import CompareSummary from './CompareSummary';\nimport useTableHeader from 'hooks/useTableHeader';\nimport PageSimulator from './PageSimulator';\nimport DramDownloader from './DramDownloader';\nimport CompareSummary from './CompareSummary';\n\n// const colorKeys = [{}, {}]\n// const getColor = (name, i = 0) => {\n//   const keys = colorKeys[i]\n//   if (typeof keys[name] !== 'number') {\n//     keys[name] = (max(Object.values(keys)) || 0) + 1\n//   }\n//   return keys[name]\n// }\n\n// const switchHeader = (d) => d.map((d, i) => ({\n\n// }))\n\n// const noteArr = (notes) => {\n//   const fuc = (d) => d.reduce((res, note, i) => {\n//     if(note[0] == '-') {\n//       if(isArray(res[res.length - 1])) {\n//         res[res.length - 1].push(note.substring(1))\n//       } else {\n//         res.push([note.substring(1)])\n//       }\n//       return res\n//     }\n//     res.push(note)\n//     return res\n//   }, [])\n//   const mapfuc = (data) => data.map((note) => {\n//     if(isArray(note) && note.some(d => d[0] === '-')) {\n//       return mapfuc(fuc(note))\n//     } else {\n//       return note\n//     }\n//   })\n//   const list = (note) => (\n//     <ul>\n//       {note.map((d, i) => isArray(d) ? (list(d)) : (\n//         <li key={i}>{d}</li>\n//       ))}\n//     </ul>\n//   )\n//   const transform = list(mapfuc(fuc(notes)))\n//   return transform\n// }\n\nconst shouldFollow = /^Density$/i\n\nconst SheetData = ({ selectedSheet, data: rawData, compareSheetData, name }) => {\n  const types = useMemo(() => [\n    { title: '3年', value: 3 },\n    { title: '7年', value: 7 },\n  ].concat(name === 'flash' ? [\n    { title: '總表', value: 'portfolio' },\n    { title: '大總表', value: 'compact' },\n  ] : [\n    { title: '3年總表', value: 'portfolio' },\n    { title: '7年總表', value: 'portfolio-7' },\n  ]), [name])\n\n  const notes = useMemo(() => {\n    if (name === 'flash' || name === 'mcp') return ['Sample', 'MP']\n    return ['ES', 'CS', 'MP']\n  }, [name])\n  const [type, setType] = useState(3)\n  const [downloading, setDownloading] = useState()\n  const { startYear, yearControl, startQuarter, quaterControl } = useYearControl()\n  const [page, setPage] = useState(0)\n  // const year = getYear(new Date())\n  // const quater = getQuarter(new Date())\n  const handleData = useCallback(srcData => {\n    if (!srcData) return null\n    let sd = srcData\n    if (!sd[0][0]) sd = srcData.slice(1)\n\n    const appearInSeven = sd[0].findIndex(d => d === '7yrs')\n    const appearInPortfolio = sd[1].findIndex(d => type === 'portfolio' ? d === '3yrs' : d === '7yrs')\n    if (type === 7) return sd.filter(d => d[appearInSeven] !== 'FALSE')\n    if (type === 'portfolio' || type === 'portfolio-7') {\n      const shouldFollowPrev = sd[0].map(t => shouldFollow.test(t))\n      if (shouldFollowPrev.some(d => d)) {\n        sd = sd.reduce((all, d, i) => {\n          if (i === 0) return [d]\n          return [\n            ...all,\n            d.map((t, j) => {\n              if (!t && shouldFollowPrev[j]) {\n                return all[i - 1][j]\n              }\n              return t\n            })\n          ]\n        }, [])\n      }\n      return sd.filter(d => d[appearInPortfolio] !== 'FALSE')\n    }\n    return sd\n  }, [type])\n  const data = handleData(rawData)\n  const headerRow = useTableHeader(data)\n  const doubleHeader = useMemo(() => data && data[0].some(h => !h), [data])\n  const tableData = useMemo(() => data ? data.slice(doubleHeader ? 2 : 1) : [], [data, doubleHeader])\n  const pages = useMemo(() => {\n    return tableData.reduce((all, row) => {\n      let i = all.length - 1\n      if (row[0]) {\n        i = all.push([]) - 1\n      }\n      all[i]?.push(row)\n      return all\n    }, [])\n  }, [tableData])\n  // console.log(tableData)\n  const headerKeys = useTableHeader(data)\n  const compareData = useMemo(() => compareSheetData ? handleData(compareSheetData).slice(doubleHeader ? 2 : 1) : [], [handleData, compareSheetData, doubleHeader])\n  const compareKeyIndex = useMemo(() => data?.[0].findIndex(h => /^product/i.test(h)), [data])\n  const [compareMark, comparePages] = useCompareData(compareData, compareKeyIndex)\n  return (\n    <Tabs style={{ marginTop: '2em' }}>\n      <TabList>\n        <Tab>簡報產生器</Tab>\n        <Tab disabled={!compareData.length}>更新對照表</Tab>\n      </TabList>\n      <TabPanel>\n        <Flex my=\"1em\" alignItems=\"center\">\n          {yearControl}\n          {quaterControl}\n          {selectedSheet && types.map((t, i) => name !== 'mcp' && (\n            <Button.Outline\n              active={type === t.value}\n              mx=\"0.25em\"\n              onClick={() => setType(t.value)}\n              key={i}\n            >{t.title}</Button.Outline>\n          ))}\n        </Flex>\n        {typeof type === 'number' && pages && pages[page] && (\n          <>\n            <Pagination\n              pageCount={pages.length}\n              pageRangeDisplayed={5}\n              marginPagesDisplayed={2}\n              onPageChange={({ selected }) => setPage(selected)}\n            />\n            <PageSimulator noBg name={`${name}-${type}y-${page + 1}`}>\n              <DramDataTable\n                headerKeys={headerKeys}\n                allData={data}\n                compareMark={compareMark}\n                compareKeyIndex={compareKeyIndex}\n                data={pages[page]}\n                doubleHeader={doubleHeader}\n                quater={startQuarter}\n                year={startYear}\n                type={type}\n                notes={notes}\n                name={name}\n              />\n            </PageSimulator>\n            <Box>\n              <Button onClick={() => setDownloading(true)} disabled={downloading}>\n                批次下載{downloading ? '中...' : ` (${pages.length}頁)`}\n              </Button>\n              {downloading && (\n                <DramDownloader\n                  headerKeys={headerKeys}\n                  allData={data}\n                  compareMark={compareMark}\n                  compareKeyIndex={compareKeyIndex}\n                  pages={pages}\n                  doubleHeader={doubleHeader}\n                  quater={startQuarter}\n                  year={startYear}\n                  type={type}\n                  notes={notes}\n                  name={name}\n                  downloading={downloading}\n                  onDownloaded={() => setDownloading(false)}\n                />\n              )}\n            </Box>\n            {/* <PageControl\n              key={selectedSheet}\n              allData={tableData}\n              headerRow={headerRow}\n              page={page}\n              data={pages[page]}\n              compareMark={compareMark}\n              sheetName={selectedSheet}\n              startYear={year}\n            /> */}\n          </>\n        )}\n        {/^portfolio/.test(type) && data && (\n          <PortfolioPage\n            data={data}\n            name={name}\n            headerKeys={headerKeys}\n            filterKey={`Portfolio.${name === 'flash' ? 'Sub' : (type === 'portfolio-7' ? '7yrs' : '3yrs')}`}\n          />\n        )}\n        {type === 'compact' && data && (\n          <PortfolioPage data={data} name={name} headerKeys={headerKeys} filterKey=\"Portfolio.All\" variant=\"compact\" />\n        )}\n      </TabPanel>\n      <TabPanel>\n        <CompareSummary\n          keyIndex={compareKeyIndex}\n          name={name}\n          data={pages}\n          headerRow={headerRow}\n          compareMark={compareMark}\n          sheetName={selectedSheet}\n          comparePages={comparePages}\n        />\n      </TabPanel>\n    </Tabs>\n  )\n}\n\nconst specialName = {\n  mcp: 'flash',\n}\n\nconst DramPage = ({ name = 'dram' }) => {\n  return (\n    <Container>\n      <Link as={GatsbyLink} to={`/${specialName[name] || name}`}>\n        {`< Home`}\n      </Link>\n      <SheetLoader name={name}>\n        <SheetData />\n      </SheetLoader>\n    </Container>\n  )\n}\n\nexport default DramPage\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var assignValue = require('./_assignValue'),\n    castPath = require('./_castPath'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.set`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @param {Function} [customizer] The function to customize path creation.\n * @returns {Object} Returns `object`.\n */\nfunction baseSet(object, path, value, customizer) {\n  if (!isObject(object)) {\n    return object;\n  }\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      lastIndex = length - 1,\n      nested = object;\n\n  while (nested != null && ++index < length) {\n    var key = toKey(path[index]),\n        newValue = value;\n\n    if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n      return object;\n    }\n\n    if (index != lastIndex) {\n      var objValue = nested[key];\n      newValue = customizer ? customizer(objValue, key, nested) : undefined;\n      if (newValue === undefined) {\n        newValue = isObject(objValue)\n          ? objValue\n          : (isIndex(path[index + 1]) ? [] : {});\n      }\n    }\n    assignValue(nested, key, newValue);\n    nested = nested[key];\n  }\n  return object;\n}\n\nmodule.exports = baseSet;\n","var root = require('./_root'),\n    toInteger = require('./toInteger'),\n    toNumber = require('./toNumber'),\n    toString = require('./toString');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite,\n    nativeMin = Math.min;\n\n/**\n * Creates a function like `_.round`.\n *\n * @private\n * @param {string} methodName The name of the `Math` method to use when rounding.\n * @returns {Function} Returns the new round function.\n */\nfunction createRound(methodName) {\n  var func = Math[methodName];\n  return function(number, precision) {\n    number = toNumber(number);\n    precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n    if (precision && nativeIsFinite(number)) {\n      // Shift with exponential notation to avoid floating-point issues.\n      // See [MDN](https://mdn.io/round#Examples) for more details.\n      var pair = (toString(number) + 'e').split('e'),\n          value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n      pair = (toString(value) + 'e').split('e');\n      return +(pair[0] + 'e' + (+pair[1] - precision));\n    }\n    return func(number);\n  };\n}\n\nmodule.exports = createRound;\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","/**\n * Creates an array with all falsey values removed. The values `false`, `null`,\n * `0`, `\"\"`, `undefined`, and `NaN` are falsey.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to compact.\n * @returns {Array} Returns the new array of filtered values.\n * @example\n *\n * _.compact([0, 1, false, 2, '', 3]);\n * // => [1, 2, 3]\n */\nfunction compact(array) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (value) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = compact;\n","var arrayPush = require('./_arrayPush'),\n    baseFlatten = require('./_baseFlatten'),\n    copyArray = require('./_copyArray'),\n    isArray = require('./isArray');\n\n/**\n * Creates a new array concatenating `array` with any additional arrays\n * and/or values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to concatenate.\n * @param {...*} [values] The values to concatenate.\n * @returns {Array} Returns the new concatenated array.\n * @example\n *\n * var array = [1];\n * var other = _.concat(array, 2, [3], [[4]]);\n *\n * console.log(other);\n * // => [1, 2, 3, [4]]\n *\n * console.log(array);\n * // => [1]\n */\nfunction concat() {\n  var length = arguments.length;\n  if (!length) {\n    return [];\n  }\n  var args = Array(length - 1),\n      array = arguments[0],\n      index = length;\n\n  while (index--) {\n    args[index - 1] = arguments[index];\n  }\n  return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n}\n\nmodule.exports = concat;\n","var createRound = require('./_createRound');\n\n/**\n * Computes `number` rounded down to `precision`.\n *\n * @static\n * @memberOf _\n * @since 3.10.0\n * @category Math\n * @param {number} number The number to round down.\n * @param {number} [precision=0] The precision to round down to.\n * @returns {number} Returns the rounded down number.\n * @example\n *\n * _.floor(4.006);\n * // => 4\n *\n * _.floor(0.046, 2);\n * // => 0.04\n *\n * _.floor(4060, -2);\n * // => 4000\n */\nvar floor = createRound('floor');\n\nmodule.exports = floor;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","var baseSet = require('./_baseSet');\n\n/**\n * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n * it's created. Arrays are created for missing index properties while objects\n * are created for all other missing properties. Use `_.setWith` to customize\n * `path` creation.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.set(object, 'a[0].b.c', 4);\n * console.log(object.a[0].b.c);\n * // => 4\n *\n * _.set(object, ['x', '0', 'y', 'z'], 5);\n * console.log(object.x[0].y.z);\n * // => 5\n */\nfunction set(object, path, value) {\n  return object == null ? object : baseSet(object, path, value);\n}\n\nmodule.exports = set;\n"],"names":["listStyle","StyledTable","styled","group","replaceSup","t","String","replace","m","g","noteBg","mp","cs","es","sample","noteFunc","noteArr","depth","groups","reduce","n","startsWith","lastGroup","length","push","substring","Box","as","pl","style","listStyleType","map","i","key","dangerouslySetInnerHTML","__html","allData","data","notes","quater","year","type","headerKeys","name","scale","doubleHeader","compareMark","compareKeyIndex","useState","nmGroup","setNmGroup","tableRef","useRef","timelineData","useMemo","dateGetter","find","d","Header","some","columns","dStr","accessor","parseDate","timeIsInRange","Number","isNaN","dateStart","dateEnd","inRange","isEnd","y","month","s","e","okTimeline","filter","yearRow","range","floor","getIndex","useCallback","pttn","findIndex","test","roadmapheaderRow","isNumber","concat","compact","headerRow","groupMemo","slice","reverse","all","h","id","j","numberIndex","res","productIndex","headerWidth","noteText","noteIndex","split","feature","featureIndex","feature7yrIndex","bodyData","dataToCompare","getDataByHeaderPttn","index","v","text","col","nm","Boolean","join","nrnd","removedInitial","undefined","columnIndex","columnCount","bodybg","num","rowSpansfuc","set","useEffect","current","masterBox","getBoundingClientRect","cells","querySelectorAll","cellGroup","forEach","cell","dataset","boundBox","boxCenter","top","height","currentGroup","left","right","Math","min","bottom","max","position","pr","width","ref","lines","Flex","border","borderLeft","alignItems","writingMode","textRrientation","transform","textAlign","lineHeight","Text","PageTitle","pt","flex","background","fontSize","fontWeight","borderRight","color","bg","rowSpan","colSpan","k","whiteSpace","body","isObject","overflow","className","trim","borderBottom","borderTop","DramTimeline","startYear","startQuarter","yearSpan","colors","toLocaleLowerCase","minHeight","justifyContent","px","flexDirection","ml","p","mb","pages","onDownloaded","downloading","page","setPage","downloadRef","then","PageSimulator","noBg","shouldFollow","SheetData","selectedSheet","rawData","compareSheetData","types","title","value","setType","setDownloading","useYearControl","yearControl","quaterControl","handleData","srcData","sd","appearInSeven","appearInPortfolio","shouldFollowPrev","useTableHeader","tableData","row","compareData","useCompareData","comparePages","marginTop","disabled","my","Button","active","mx","onClick","Pagination","pageCount","pageRangeDisplayed","marginPagesDisplayed","onPageChange","selected","PortfolioPage","filterKey","variant","CompareSummary","keyIndex","sheetName","specialName","mcp","Container","Link","GatsbyLink","to","SheetLoader","arrayPush","isFlattenable","module","exports","baseFlatten","array","predicate","isStrict","result","assignValue","castPath","isIndex","toKey","object","path","customizer","lastIndex","nested","newValue","objValue","root","toInteger","toNumber","toString","nativeIsFinite","isFinite","nativeMin","methodName","func","number","precision","pair","Symbol","isArguments","isArray","spreadableSymbol","isConcatSpreadable","resIndex","copyArray","arguments","args","Array","createRound","baseGetTag","isObjectLike","baseSet"],"sourceRoot":""}